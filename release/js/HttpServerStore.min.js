/*@preserve Copyright (C) 2018 Crawford Currie http://c-dot.co.uk license MIT*/
function HttpServerStore(params){"use strict";var self=this;if(self.url=global.URLPARAMS.url,!self.url)throw"No http_url defined, cannot start HttpServerStore";AbstractStore.call(self,params)}global.CLOUD_STORE=HttpServerStore,HttpServerStore.prototype=Object.create(AbstractStore.prototype),HttpServerStore.prototype.options=function(){"use strict";return $.extend(AbstractStore.prototype.options(),{identifier:"HTTP Server Store",needs_path:!0})},HttpServerStore.prototype.read=function(path,ok,fail){"use strict";var self=this,xhr=new XMLHttpRequest;xhr.withCredentials=!0,xhr.timeout=5e3,xhr.responseType="arraybuffer",xhr.open("GET",self.url+"/"+path+"?_="+Date.now()),xhr.onreadystatechange=function(e){4===xhr.readyState&&200!==xhr.status&&fail.call(self,e)},xhr.onload=function(){ok.call(self,xhr.response)},xhr.send()},HttpServerStore.prototype.write=function(path,data,ok,fail){"use strict";var self=this,xhr=new XMLHttpRequest;xhr.withCredentials=!0,xhr.timeout=5e3,xhr.open("PUT",self.url+"/"+path+"?_="+Date.now()),xhr.ontimeout=function(e){fail.call(self,e)},xhr.onreadystatechange=function(e){4===xhr.readyState&&200!==xhr.status&&fail.call(self,e)},xhr.onload=function(){ok.call(self)},xhr.send(data)},"undefined"!=typeof module&&(module.exports=HttpServerStore);