/*@preserve Copyright (C) 2018 Crawford Currie http://c-dot.co.uk license MIT*/
function HttpServerStore(t){"use strict";var e=this;if(e.url=global.URLPARAMS.url,!e.url)throw"No http_url defined, cannot start HttpServerStore";AbstractStore.call(e,t)}global.CLOUD_STORE=HttpServerStore,HttpServerStore.prototype=Object.create(AbstractStore.prototype),HttpServerStore.prototype.options=function(){"use strict";return $.extend(AbstractStore.prototype.options(),{identifier:"HTTP Server Store",needs_path:!0})},HttpServerStore.prototype.read=function(t,e,r){"use strict";var o=this;$.ajax({url:o.url+"/"+t+"?t="+Date.now(),cache:!1,processData:!1,success:function(t,a,n){var p=n.getResponseHeader("Content-Type");if("application/octet-stream"===p){var l=new Blob([t],{type:p}),i=new FileReader;i.onload=function(t){e.call(o,t.target.result)},i.readAsArrayBuffer(l)}else"application/json"===p?e.call(o,Utils.StringToArrayBuffer(JSON.stringify(t))):r.call(o,"Unsupported content type "+p)}}).fail(function(t){r.call(o,t)})},HttpServerStore.prototype.write=function(t,e,r,o){"use strict";var a=this;$.ajax({url:a.url+"/"+t,data:e,processData:!1,type:"POST"}).done(function(t){r.call(a,t)}).fail(function(t){o.call(a,t)})},"undefined"!=typeof module&&(module.exports=HttpServerStore);