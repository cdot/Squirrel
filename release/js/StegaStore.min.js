/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function StegaStore(t){"use strict";LayeredStore.call(this,t)}StegaStore.prototype=Object.create(LayeredStore.prototype),StegaStore.prototype.options=function(){"use strict";return $.extend(LayeredStore.prototype.options.call(this),{needs_image:!0})},StegaStore.prototype.read=function(t,e,r){"use strict";var a=this,o=function(){var t,o=new Steganographer($("#stegamage")[0]);try{t=o.extract()}catch(t){return void r.call(a,t)}e.call(a,t)};this.engine.read(t,function(t){var e="data:image/png;base64,"+Utils.ArrayBufferToBase64(t);e!==$("#stegamage").attr("src")?$("#stegamage").attr("src",e).on("load",function(){$(this).off("load"),o()}):o()},r)},StegaStore.prototype.write=function(t,e,r,a){"use strict";var o=this,n=document.getElementById("stegamage");if(!n)throw"no #stegamage";var i,s=new Steganographer(n);try{var c=s.inject(e,!0).toDataURL().split(",",2)[1];i=Utils.Base64ToArrayBuffer(c)}catch(t){return void a.call(this,t)}o.engine.write(t,i,function(){r.call(o)},a)};