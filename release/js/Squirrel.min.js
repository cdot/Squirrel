/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
/*@preserve  AES implementation in JavaScript                     (c) Chris Veness 2005-2014 / MIT Licence */
"use strict";function RGBA(e,t,o,r){function n(e,t){if(/%\s*$/.test(e)){return parseFloat(e)*t/100}return parseFloat(e)}if(1!==arguments.length)return this.r=e,this.g=t,this.b=o,void(this.a=r);{if("string"==typeof e){if("string"==typeof e){var a=CSSColours[e.toLowerCase()];if(void 0!==a&&(e=a),"#"==e.charAt(0))return this.r=parseInt(e.substr(1,2),16)/255,this.g=parseInt(e.substr(3,2),16)/255,void(this.b=parseInt(e.substr(5,2),16)/255);if(/^hsla?\(.*\)$/.test(e)){r=e.replace(/(hsla?\(|\))/g,"").split(/[,\s]+/);var i=RGBA.fromHSL(n(r[0],360),n(r[1],1),n(r[2],1),r.length>3?n(r[3],1):void 0);return this.r=i.r,this.g=i.g,this.b=i.b,void(this.a=i.a)}if(/^rgba?\(.*\)$/.test(e))return r=e.replace(/(rgba?\(|\))/g,"").split(","),this.r=Math.floor(n(r[0],255))/255,this.g=Math.floor(n(r[1],255))/255,this.b=Math.floor(n(r[2],255))/255,void(r.length>3&&(this.a=n(r[3],1)))}throw"object"==typeof e&&"RGBA"===e.constructor.name&&jQuery.extend(this,e),"Cannot construct from "+typeof e}if("Array"===e.constructor.name)this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3];else{if("number"!=typeof e.r||"number"!=typeof e.g||"number"!=typeof e.b)throw"Don't know how to make an RGBA from this";this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}}}function AbstractStore(e){e.ok.call(this)}function LayeredStore(e){var t=this,o=e.ok;e.ok=function(){t.engine=this,o.call(t)},e.understore(e)}function LocalStorageStore(e){if(e.user)this.user(e.user);else{for(var t,o=0,r=null;null!=(t=localStorage.key(o));){var n=/^Squirrel\.(.*)$/.exec(t);if(n){if(r){r=null;break}r=n[1]}o++}r&&(global.DEBUG&&console.debug("LocalStorageStore: Identified possible user "+r),this.user(r))}AbstractStore.call(this,e)}function EncryptedStore(e){LayeredStore.call(this,e)}function Hoard(e,t){if(this.name=e,t){if("object"!=typeof t&&(t=JSON.parse(t)),this.last_sync=t.last_sync,this.actions=t.actions,this.cache=t.cache,this.options=t.options,this.version=t.version||VERSION,this.version>VERSION)throw e+" hoard error: cannot read a version "+t.version+" hoard with "+VERSION+" code"}else this.last_sync=null,this.clear_actions(),this.cache=null,this.version=VERSION;void 0===this.options&&(this.options={store_path:null})}!function(e){e.fn.edit_in_place=function(t){function o(){l.remove(),r.show(),s()}var r=e(this),n=t.height||r.height()||"1em",a=t.width||r.width()||"1em",i=t.changed||function(){return r.text()},s=t.closed||function(){},l=e(document.createElement("input")),c=t.text||r.text();r.hide(),l.insertBefore(r).addClass("in_place_editor").val(c).css("height",n).css("width",a).on("change",function(){var t=e(this).val();o(),t!==c&&(c=i.call(r,t))}).on("keydown",function(t){return 27!==t.keyCode&&(13!==t.keyCode||e(this).val()!==c)||(o(),!1)}).blur(o).select()}}(jQuery),/*@preserve Copyright (C) 2018 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.fn.simulated_password=function(){e(this).each(function(){function t(e){e.data("skip_pass_change",e.data("skip_pass_change")+1)}var o=e(this);this.type="text";var r=e('<input type="checkbox" class="TX_title"/>');o.after(r),o.data("skip_pass_change",0),o.data("pass_hidden",!0),o.data("hidden_pass",""),r.on("click",function(){o.data("pass_hidden")?(o.val(o.data("hidden_pass")),t(o),o.data("pass_hidden",!1)):(o.data("hidden_pass",o.val()),t(o),o.val(o.val().replace(/./g,"•")),o.data("pass_hidden",!0))}).prop("checked",!1),o.on("input",function(){var e=o.val();if(o.data("pass_hidden")){var r=o.data("hidden_pass");if(e.length>r.length){var n=e.substring(e.length-1);o.data("hidden_pass",r+n),t(o),o.val(e.substring(0,e.length-1)+"•")}else o.data("hidden_pass",r.substring(0,r.length-(r.length-e.length)));return!1}o.data("hidden_pass",e)}),o.on("change",function(){return o.data("skip_pass_change")>0?(o.data("skip_pass_change",o.data("skip_pass_change")-1),!1):(o.val(o.data("hidden_pass")),!0)})})}}(jQuery),/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.fn.scroll_into_view=function(){return this.each(function(){var t=e(this).offset().top,o=e(this).height(),r=e(window),n=r.scrollTop(),a=r.innerHeight();if(t<n||t+o>n+a){var i=t-a/2;return i<0&&(i=0),console.log("Scrolling to "+i),e("html,body").animate({scrollTop:i},500),!1}return!0})}}(jQuery),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.widget("squirrel.iconbutton",e.ui.button,{_create:function(){this.options.icon=this.options.icon||this.element.data("icon"),this.options.icon&&!/^ui-icon-/.test(this.options.icon)&&(this.options.icons={primary:this.options.icon},this.options.classes={"ui-button-icon":"squirrel-icon"},delete this.options.icon),this.options.text=!1,this._super()},_setOption:function(e,t){"icon"!==e||/^ui-icon-/.test(t)||(e="icons",t={primary:t}),this._super(e,t)}})}(jQuery),/*@preserve Copyright (C) 2015-2018 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.widget("squirrel.squirrelDialog",e.ui.dialog,{control:function(e){return this.element.find("[data-id='"+e+"']")},open:function(t){var o=this.element;return o.hasClass("dlg-initialised")||(o.addClass("dlg-initialised"),this.control("cancel").on(e.getTapEvent(),function(){return o.squirrelDialog("close"),!1}),o.trigger("dlg-initialise")),t&&t.$node&&o.data("node",t.$node),o.trigger("dlg-open",t),e.isTouchCapable()&&!this.options.position&&(this.options.position={my:"left top",at:"left top",of:e("body")}),this.options.modal=!0,this.options.width="auto",this.options.closeOnEscape=!1,this._super()}})}(jQuery);/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
const CSSColours={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};RGBA.prototype.inverse=function(){return new RGBA(1-this.r,1-this.g,1-this.b,this.a)},RGBA.prototype.complement=function(){var e=this.toHSV();return RGBA.fromHSV((e[0]+180)%360,e[1],e[2],this.a)},RGBA.prototype.luma=function(){return.2126*this.r+.7152*this.g+.0722*this.b},RGBA.prototype.toString=function(){var e=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)];if(void 0!==this.a)return e.push(this.a),"rgba("+e.join(",")+")";for(var t="#",o=0;o<3;o++){var r=e[o].toString(16);t+=1==r.length?"0"+r:r}return t.toUpperCase()},RGBA.prototype.toHSV=function(){var e=Math.max(this.r,this.g,this.b),t=Math.min(this.r,this.g,this.b),o=e-t,r=e,n=0==r?0:o/r,a=0;0!=o&&(a=this.r===e?(this.g-this.b)/o%6*60:this.g===e?60*((this.b-this.r)/o+2):60*((this.r-this.g)/o+4))<0&&(a+=360);var i=[a,n,r];return void 0!==this.a&&i.push(this.a),i},RGBA.prototype.toHSL=function(){var e,t,o,r=Math.max(this.r,this.g,this.b),n=Math.min(this.r,this.g,this.b),a=r-n;0==a?(e=t=0,o=r):(o=(r+n)/2,t=a/(o>.5?2-r-n:r+n)),0!=a&&(e=this.r===r?(this.g-this.b)/a%6*60:this.g===r?60*((this.b-this.r)/a+2):60*((this.r-this.g)/a+4))<0&&(e+=360);var i=[e,t,o];return void 0!==this.a&&i.push(this.a),i},RGBA.fromHSV=function(e,t,o,r){var n,a,i;if(1===arguments.length&&(r=e[3],o=e[2],t=e[1],e=e[0]),0==t)n=a=i=o;else{e/=60;var s=Math.floor(e),l=e-s,c=o*(1-t),u=o*(1-t*l),d=o*(1-t*(1-l));switch(s){case 0:n=o,a=d,i=c;break;case 1:n=u,a=o,i=c;break;case 2:n=c,a=o,i=d;break;case 3:n=c,a=u,i=o;break;case 4:n=d,a=c,i=o;break;default:n=o,a=c,i=u}}return new RGBA(n,a,i,r)},RGBA.fromHSL=function(e,t,o,r){function n(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+(t-e)*(2/3-o)*6:e}var a,i,s;if(1===arguments.length&&(r=e[3],o=e[2],t=e[1],e=e[0]),0==t)a=i=s=o;else{e/=360;var l=o<.5?o*(1+t):o+t-o*t,c=2*o-l;a=n(c,l,e+1/3),i=n(c,l,e),s=n(c,l,e-1/3)}return new RGBA(a,i,s,r)},"undefined"!=typeof module&&(module.exports=RGBA),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.reset_styling=function(){var t,o=e("body"),r=o.css("background-color");t=!(!r||"transparent"===r||"inherit"===r||"initial"===r)&&new RGBA(r).luma()<.65;var n=e(document.createElement("div")).addClass("ui-widget").addClass("ui-widget-content").hide();o.append(n),r=n.css("background-color");var a="body {";for(var i in{font:0,color:0,"background-color":0}){a+=i+": "+n.css(i)+";\n"}a+="}",n.remove();var s;if(s=r&&"transparent"!==r&&"initial"!==r&&"inherit"!==r?new RGBA(r).luma()<.65:t,t&&!s||!t&&s)for(var l=0;l<document.styleSheets.length;l++){var c=document.styleSheets[l];if(c){var u;try{u=c.rules||c.cssRules}catch(e){}if(u)for(var d=0;d<u.length;d++){var g=u[d];if(/\.[-:a-z0-9]*$/i.test(g.selectorText)){var h,f="";if(g.style.color)try{h=new RGBA(g.style.color),f+="color: "+h.inverse().toString()+";\n"}catch(e){global.DEBUG&&console.log(e)}if(g.style.backgroundColor)try{h=new RGBA(g.style.backgroundColor),f+="background-color: "+h.inverse().toString()+";\n"}catch(e){global.DEBUG&&console.log(e+":"+g.style.backgroundColor)}f.length>0&&(a+=g.selectorText+"{"+f+"}\n")}}}}e("#computed-styles").remove();var p=e(document.createElement("style")).attr("id","computed-styles").text(a);o.append(p)}}(jQuery);var Aes={};if(Aes.cipher=function(e,t){for(var o=t.length/4-1,r=[[],[],[],[]],n=0;n<16;n++)r[n%4][Math.floor(n/4)]=e[n];r=Aes.addRoundKey(r,t,0,4);for(var a=1;a<o;a++)r=Aes.subBytes(r,4),r=Aes.shiftRows(r,4),r=Aes.mixColumns(r,4),r=Aes.addRoundKey(r,t,a,4);r=Aes.subBytes(r,4),r=Aes.shiftRows(r,4),r=Aes.addRoundKey(r,t,o,4);for(var i=new Array(16),n=0;n<16;n++)i[n]=r[n%4][Math.floor(n/4)];return i},Aes.keyExpansion=function(e){for(var t=e.length/4,o=t+6,r=new Array(4*(o+1)),n=new Array(4),a=0;a<t;a++){var i=[e[4*a],e[4*a+1],e[4*a+2],e[4*a+3]];r[a]=i}for(var a=t;a<4*(o+1);a++){r[a]=new Array(4);for(var s=0;s<4;s++)n[s]=r[a-1][s];if(a%t==0){n=Aes.subWord(Aes.rotWord(n));for(var s=0;s<4;s++)n[s]^=Aes.rCon[a/t][s]}else t>6&&a%t==4&&(n=Aes.subWord(n));for(var s=0;s<4;s++)r[a][s]=r[a-t][s]^n[s]}return r},Aes.subBytes=function(e,t){for(var o=0;o<4;o++)for(var r=0;r<t;r++)e[o][r]=Aes.sBox[e[o][r]];return e},Aes.shiftRows=function(e,t){for(var o=new Array(4),r=1;r<4;r++){for(var n=0;n<4;n++)o[n]=e[r][(n+r)%t];for(var n=0;n<4;n++)e[r][n]=o[n]}return e},Aes.mixColumns=function(e,t){for(var o=0;o<4;o++){for(var r=new Array(4),n=new Array(4),a=0;a<4;a++)r[a]=e[a][o],n[a]=128&e[a][o]?e[a][o]<<1^283:e[a][o]<<1;e[0][o]=n[0]^r[1]^n[1]^r[2]^r[3],e[1][o]=r[0]^n[1]^r[2]^n[2]^r[3],e[2][o]=r[0]^r[1]^n[2]^r[3]^n[3],e[3][o]=r[0]^n[0]^r[1]^r[2]^n[3]}return e},Aes.addRoundKey=function(e,t,o,r){for(var n=0;n<4;n++)for(var a=0;a<r;a++)e[n][a]^=t[4*o+a][n];return e},Aes.subWord=function(e){for(var t=0;t<4;t++)e[t]=Aes.sBox[e[t]];return e},Aes.rotWord=function(e){for(var t=e[0],o=0;o<3;o++)e[o]=e[o+1];return e[3]=t,e},Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],"undefined"!=typeof module&&module.exports&&(module.exports=Aes),"function"==typeof define&&define.amd&&define([],function(){return Aes}),void 0===global)var global={};global.DEBUG=!1;var Utils={waiting_for_sometime:{},sometime_timeout:!0,last_yield:Date.now(),IMMEDIATE:1,SOON:100,SOMETIME:250,MSPERDAY:864e5,TIMEUNITS:{y:{days:360,ms:314496e5,format:"$1 year$?($1!=1,s,)"},m:{days:30,ms:2592e6,format:"$1 month$?($1!=1,s,)"},d:{days:1,ms:864e5,format:"$1 day$?($1!=1,s,)"}}};Utils.setUpAjax=function(e,t,o){if(window.FormData&&(e.dataType&&"binary"===e.dataType||e.data&&(window.ArrayBuffer&&e.data instanceof ArrayBuffer||window.Blob&&e.data instanceof Blob)))return{send:function(t,o){var r=new XMLHttpRequest,n=e.url,a=e.type,i=e.async||!0,s=e.responseType||"blob",l=e.data||null,c=e.username||null,u=e.password||null;r.addEventListener("load",function(){var t={};t[e.dataType]=r.response,o(r.status,r.statusText,t,r.getAllResponseHeaders())}),r.open(a,n,i,c,u);for(var d in t)r.setRequestHeader(d,t[d]);r.responseType=s,r.send(l)},abort:function(){o.abort()}}},"undefined"!=typeof jQuery&&jQuery.ajaxTransport("+binary",Utils.setUpAjax),Utils.generate_password=function(e){var t,o;void 0===e.length&&(e.length=24),void 0===e.charset&&(e.charset="A-Za-z0-9");for(var r=e.charset,n=[];r.length>0;)if(r.length>=3&&"-"===r.charAt(1))for(t=r.charCodeAt(0),o=r.charCodeAt(2),r=r.substring(3);t<=o;)n.push(String.fromCharCode(t++));else n.push(r.charAt(0)),r=r.substring(1);var a=new Uint8Array(e.length);window.crypto.getRandomValues(a);for(var i="",s=0;s<e.length;s++)i+=n[a[s]%n.length];return i},Utils.sometime=function(e){Utils.waiting_for_sometime[e]||(Utils.waiting_for_sometime[e]=!0,null===Utils.sometime_timeout&&(Utils.sometime_timeout=window.setTimeout(Utils.sometime_is_now,Utils.SOMETIME)))},Utils.sometime_is_now=function(){Utils.sometime_timeout=null,Utils.last_yield=Date.now();for(var e in Utils.waiting_for_sometime)$(document).triggerHandler(e),delete Utils.waiting_for_sometime[e]},Utils.soon=function(e){Date.now()-Utils.last_yield>Utils.SOON?window.setTimeout(function(){Utils.last_yield=Date.now(),e()},Utils.IMMEDIATE):e()},Utils.execute_queue=function(e){function t(){r=!0}function o(e){if(e.length>0&&r){var n=e.shift();r=!1,n(t)}window?window.setTimeout(function(){Utils.last_yield=Date.now(),o(e)},Utils.IMMEDIATE):o(e)}var r=!0;o(e)},Utils.load=function(e,t,o){function r(e){delete a[e],0===Object.keys(a).length&&(Object.keys(i).length>0?"function"==typeof o&&o(i):"function"==typeof t&&t())}function n(e,t){i[e]=t,r(e)}var a={},i={};if(0===e.length)return void t();for(var s=0;s<e.length;s++)!function(e){a[e]=!0,/\.js$/.test(e)?$.getScript(e).done(function(){r(e)}).fail(function(t,o,r){n(e,r)}):/\.css$/.test(e)?($("link").appendTo("head").attr({type:"text/css",rel:"stylesheet"}).attr("href",e),r(e)):/\.html$/.test(e)&&$.get(e).done(function(t){$(t).appendTo("body"),r(e)}).fail(function(t,o,r){n(e,r)})}(e[s])},Utils.read_file=function(e,t,o,r){var n=new FileReader;if(n.onload=function(){t(n.result)},n.onerror=function(){o(e.name+" read failed")},n.onabort=n.onerror,void 0===r||"text"===r)n.readAsText(e);else if("arraybuffer"===r)n.readAsArrayBuffer(e);else if("binarystring"===r)n.readAsBinaryString(e);else{if("datauri"!==r)throw"Unrecognised mode "+r;n.readAsDataURL(e)}},Utils.ArrayBufferToString=function(e){if(global.DEBUG&&e.byteLength%2!=0)throw"Internal error";for(var t=new Uint8Array(e),o="",r=0;r<t.length;r+=2)o+=String.fromCharCode(t[r+1]<<8||t[r]);return o},Utils.StringToArrayBuffer=function(e){for(var t=new Uint16Array(e.length),o=0,r=e.length;o<r;o++)t[o]=e.charCodeAt(o);return t.buffer},Utils.ArrayBufferToPackedString=function(e){for(var t=new Uint8Array(e),o=0!=(1&t.length)?256:0,r=!0,n="",a=t.length,i=0;i<a;i++)r?(n+=String.fromCharCode(o|t[i]),r=!1):(o=t[i]<<8,r=!0);return r&&(n+=String.fromCharCode(o)),n},Utils.PackedStringToArrayBuffer=function(e){var t=2*e.length-1;0==(256&e.charCodeAt(0))&&t--;for(var o=!0,r=new Uint8Array(t),n=0,a=0;a<t;)o?(r[a++]|=255&e.charCodeAt(n++),o=!1):(r[a++]=e.charCodeAt(n)>>8&255,o=!0);return r.buffer},Utils.ArrayBufferToBase64=function(e){for(var t=new Uint8Array(e),o=2,r="",n=t.length,a=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},i=0,s=0;s<n;s++)o=s%3,i|=t[s]<<(16>>>o&24),2!==o&&n-s!=1||(r+=String.fromCharCode(a(i>>>18&63),a(i>>>12&63),a(i>>>6&63),a(63&i)),i=0);return r.substr(0,r.length-2+o)+(2===o?"":1===o?"=":"==")},Utils.Base64ToArrayBuffer=function(e){for(var t,o,r=e.replace(/[^A-Za-z0-9+\/]/g,""),n=r.length,a=3*n+1>>2,i=new Uint8Array(a),s=0,l=0,c=0;c<n;c++)if(o=3&c,s|=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0}(r.charCodeAt(c))<<6*(3-o),3===o||n-c==1){for(t=0;t<3&&l<a;t++,l++)i[l]=s>>>(16>>>t&24)&255;s=0}return i.buffer},Utils.parse_query_params=function(){for(var e=window.location.search.substring(1).split(/[&;]+/),t={},o=0;o<e.length;o++)if(""!==e[o]){var r=e[o].split("=");if(void 0===t[r[0]])t[r[0]]=decodeURIComponent(r[1]);else if("string"==typeof t[r[0]]){var n=[t[r[0]],decodeURIComponent(r[1])];t[r[0]]=n}else t[r[0]].push(decodeURIComponent(r[1]))}return t},Utils.deltaTimeString=function(e){e=new Date(e.getTime()-Date.now());var t=[],o=e.getUTCFullYear()-1970;return o>0&&t.push(TX.tx(Utils.TIMEUNITS.y.format,o)),e.setUTCFullYear(1970),o=e.getUTCMonth(),o>0&&t.push(TX.tx(Utils.TIMEUNITS.m.format,o)),e.setUTCMonth(0),o=e.getUTCDate(),(o>0||0===t.length)&&t.push(TX.tx(Utils.TIMEUNITS.d.format,o)),t.join(" ")},Utils.expandTemplate=function(){var tmpl=arguments[0],args=arguments;return tmpl=tmpl.replace(/\$(\d+)/g,function(e,t){var o=parseInt(t);return args[o]}),tmpl=tmpl.replace(/\$\?\((.*?),(.*?),(.*?)\)/g,function(m,test,pass,fail){var result=!1;return eval("result=("+test+")"),result?pass:fail})},"undefined"!=typeof module&&(module.exports=Utils);/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
var TX={lingo:void 0,originals:void 0,language:function(e){var t=TX.lingo;return void 0!==e?(TX.lingo=e,Cookies.set("ui_lang",e,{expires:365})):t||(TX.lingo=Cookies.get("ui_lang")||window.navigator.userLanguage||window.navigator.language||"en"),t},translations:null,clean:function(e){return e.replace(/\s+/g," ").replace(/^ /,"").replace(/ $/,"")},init:function(e,t){if(TX.lingo||TX.language(),/^en(\b|$)/i.test(TX.lingo))return global.DEBUG&&console.debug("Using language 'en'"),TX.originals&&($("body").each(function(){TX.translateDOM(this,function(e){return e})}),TX.originals=void 0),void(e&&e());TX.originals=new WeakMap,$.ajax("locale/"+TX.lingo+".json",{success:function(t){TX.translations=t,$("body").each(function(){TX.translateDOM(this,function(e){var t=TX.translations[TX.clean(e)];return void 0!==t?t.s:e})}),global.DEBUG&&console.debug("Using language '"+TX.lingo+"'"),e&&e()},error:function(o,r,n){var a=/^(.+)-.+/.exec(TX.lingo);global.DEBUG&&console.debug("Failed to load locale/"+TX.lingo+".json: "+n.message),t&&t("Failed to load locale/"+TX.lingo+".json: "+n.message),TX.lingo=a?a[1]:"en",TX.init(e)}})},translateDOM:function(e,t,o){function r(e,t){return(" "+e.className+" ").replace(/\s+/g," ").indexOf(" "+t+" ")>=0}var n,a;if(TX.originals||(TX.originals=new WeakMap),TX.originals.has(e)?a=TX.originals.get(e):TX.originals.set(e,a={}),3==e.nodeType)o&&/\S/.test(e.nodeValue)&&(n=a.text,void 0===n&&(a.text=n=e.nodeValue),n&&(n=t(n))&&(e.nodeValue=n));else if((o||r(e,"TX_title"))&&(n=a.title,void 0===n&&(a.title=n=e.title),n&&void 0!==(n=t(n))&&(e.title=n)),r(e,"TX_html"))n=a.html,void 0===n&&(a.html=n=e.innerHTML),n&&(n=t(n))&&(e.innerHTML=n);else{r(e,"TX_text")&&(o=!0);for(var i=0,s=e.childNodes.length;i<s;++i)TX.translateDOM(e.childNodes[i],t,o)}},tx:function(){var e;return null!==TX.translations&&void 0!==(e=TX.translations[TX.clean(arguments[0])])&&(arguments[0]=e.s),/\$/.test(arguments[0])?Utils.expandTemplate.apply(null,arguments):arguments[0]}};/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
if("undefined"!=typeof module&&(module.exports=TX),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e.widget("squirrel.twisted",{_create:function(){function t(){r.hasClass("twisted-shut")?o.open():o.close()}var o=this,r=o.element,n=e(document.createElement("button")).addClass("twisted-button twisted-title").iconbutton({icon:"ui-icon-info",showLabel:!1});0===r.children(".twisted-title").first().detach().insertBefore(r).prepend(n).on("click",t).length&&n.insertBefore(r).on("click",t),r.data("twisted-button",n),o.close()},open:function(){var e=this.element.data("close")||"ui-icon-circle-minus";this.element.removeClass("twisted-shut").show().data("twisted-button").iconbutton("option","icon",e)},close:function(){var e=this.element.data("open")||"ui-icon-circle-plus";this.element.addClass("twisted-shut").hide().data("twisted-button").iconbutton("option","icon",e)}})}(jQuery),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
"undefined"!=typeof module&&(Utils=require("./Utils")),function(e){e.widget("squirrel.template",{_create:function(){this.element.hasClass("pick-one")&&this.element.children().hide().first().show()},pick:function(e){this.element.children().hide();var t=this.element.children("[data-id='"+e+"']");return t.show(),t},expand:function(){var e=this.element.data("raw-template");e||this.element.data("raw-template",e=this.element.html());for(var t=[e],o=0;o<arguments.length;o++)t.push(arguments[o]);e=Utils.expandTemplate.apply(null,t),this.element.html(e)}})}(jQuery),"undefined"!=typeof module)var Utils=require("./Utils");/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
if(AbstractStore.NODATA="not found",AbstractStore.prototype.options=function(){return{identifier:"Unknown"}},AbstractStore.prototype.user=function(e){return void 0!==e&&(this.suser=e),this.suser},AbstractStore.prototype.pass=function(e){return 1===arguments.length&&void 0!==e&&(this.spass=e),this.spass},AbstractStore.prototype.write=function(e,t,o,r){r.call(this,"Store has no write method")},AbstractStore.prototype.writes=function(e,t,o,r){this.write(e,Utils.StringToArrayBuffer(t),o,r)},AbstractStore.prototype.read=function(e,t,o){o.call(this,"Store has no read method")},AbstractStore.prototype.reads=function(e,t,o){var r=this;this.read(e,function(e){var n;try{n=Utils.ArrayBufferToString(e)}catch(e){return global.DEBUG&&console.debug("Caught "+e),void o.call(r,e)}t.call(r,n)},o)},"undefined"!=typeof module&&(module.exports=AbstractStore),"undefined"!=typeof module)var AbstractStore=require("./AbstractStore");/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
if(LayeredStore.prototype=Object.create(AbstractStore.prototype),LayeredStore.prototype.options=function(){return this.engine.options()},LayeredStore.prototype.user=function(e){return this.engine.user(e)},LayeredStore.prototype.pass=function(e){return this.engine.pass(e)},"undefined"!=typeof module&&(module.exports=LayeredStore),"undefined"!=typeof module)var AbstractStore=require("./AbstractStore");global.CLOUD_STORE=LocalStorageStore,LocalStorageStore.prototype=Object.create(AbstractStore.prototype),LocalStorageStore.prototype.options=function(){return $.extend(AbstractStore.prototype.options(),{needs_path:!0,identifier:"browser"})},LocalStorageStore.prototype.read=function(e,t,o){var r;global.DEBUG&&console.debug("LocalStorageStore: Reading "+e);try{r=localStorage.getItem(e)}catch(e){return global.DEBUG&&console.debug("Caught "+e),void o.call(this,e)}if(null===r)o.call(this,AbstractStore.NODATA);else{var n=Utils.PackedStringToArrayBuffer(r);t.call(this,n)}},LocalStorageStore.prototype.write=function(e,t,o,r){global.DEBUG&&console.debug("LocalStorageStore: Writing "+e);try{var n=Utils.ArrayBufferToPackedString(t);localStorage.setItem(e,n)}catch(e){return global.DEBUG&&console.debug("Caught "+e),void r.call(this,e)}o.call(this)},"undefined"!=typeof module&&(module.exports=LocalStorageStore),/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
"undefined"!=typeof module&&(Aes=require("../libs/aes"));var AES={};/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
if(AES.encrypt=function(e,t,o){for(var r=new Uint8Array(e),n=o/8,a=new Array(n),i=0;i<n;i++)i<t.length?a[i]=255&t.charCodeAt(i):a[i]=0;var s=Aes.cipher(a,Aes.keyExpansion(a));s=s.concat(s.slice(0,n-16));var l=new Uint8Array(8),c=8,u=Date.now(),d=u%1e3,g=u/1e3>>0,h=65535*Math.random()>>0;for(i=0;i<2;i++)l[i]=d>>>8*i&255;for(i=0;i<2;i++)l[i+2]=h>>>8*i&255;for(i=0;i<4;i++)l[i+4]=g>>>8*i&255;for(var f=Aes.keyExpansion(s),p=Math.ceil(r.length/16),m=new Array(p),v=0;v<p;v++){for(var y=0;y<4;y++)l[15-y]=v>>>8*y&255;for(y=0;y<4;y++)l[15-y-4]=v/4294967296>>>8*y;var b=Aes.cipher(l,f),D=v<p-1?16:(r.length-1)%16+1,_=new Uint8Array(D);for(c+=D,i=0;i<D;i++)b[i],_[i]=b[i]^r[16*v+i];m[v]=_}var E=new Uint8Array(c);E.set(l);var q=l.length;for(v=0;v<p;v++)E.set(m[v],q),q+=m[v].length;return E},AES.decrypt=function(e,t,o){for(var r=new Uint8Array(e),n=o/8,a=new Uint8Array(n),i=0;i<n;i++)i<t.length?a[i]=255&t.charCodeAt(i):a[i]=0;var s=Aes.cipher(a,Aes.keyExpansion(a));s=s.concat(s.slice(0,n-16));var l=new Uint8Array(8);for(i=0;i<8;i++)l[i]=r[i];for(var c=Aes.keyExpansion(s),u=Math.ceil((r.length-8)/16),d=new Array(u),g=8,h=0;h<u;h++)d[h]=r.subarray(g,g+16),g+=16;var f=new Array(u),p=0;for(h=0;h<u;h++){for(var m=0;m<4;m++)l[15-m]=h>>>8*m&255;for(m=0;m<4;m++)l[15-m-4]=(h+1)/4294967296-1>>>8*m&255;var v=Aes.cipher(l,c),y=d[h].length,b=new Uint8Array(y);for(i=0;i<y;i++)b[i]=v[i]^d[h][i];f[h]=b,p+=y}var D=new Uint8Array(p);for(g=0,h=0;h<u;h++)D.set(f[h],g),g+=f[h].length;return D.buffer},"undefined"!=typeof module&&(module.exports=AES),"undefined"!=typeof module)var LayeredStore=require("./LayeredStore");EncryptedStore.prototype=Object.create(LayeredStore.prototype),EncryptedStore.prototype.options=function(){return $.extend(LayeredStore.prototype.options.call(this),{needs_pass:!0})},EncryptedStore.prototype.read=function(e,t,o){var r=this;global.DEBUG&&console.debug("EncryptedStore: reading "+e+" with password "+r.engine.pass()),this.engine.read(e,function(e){var n;try{global.DEBUG&&console.debug("EncryptedStore: decrypting using password "+r.engine.pass()),n=AES.decrypt(e,r.engine.pass(),256)}catch(e){return global.DEBUG&&console.debug("Caught "+e),void o.call(r,e)}t.call(r,n)},o)},EncryptedStore.prototype.write=function(e,t,o,r){var n=this;global.DEBUG&&console.debug("EncryptedStore: writing "+e+" with password "+n.engine.pass());var a;try{a=AES.encrypt(t,this.engine.pass(),256)}catch(e){return global.DEBUG&&console.debug("Caught "+e),void r.call(this,e)}this.engine.write(e,a.buffer,function(){o.call(n)},r)},"undefined"!=typeof module&&(module.exports=EncryptedStore);/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
const VERSION=2;"undefined"!=typeof module&&(TX=require("./Translation")),Hoard.stringify_action=function(e){return e.type+":"+e.path.join("↘")+(void 0!==e.data?" '"+e.data+"'":"")+" @"+new Date(e.time).toLocaleString()},global.DEBUG&&(Hoard.prototype.dump=function(){for(var e=this.JSON()+"\n",t=0;t<this.actions.length;t++)e=e+Hoard.stringify_action(this.actions[t])+"\n";return e}),Hoard.prototype.clear_actions=function(){this.actions=[]},Hoard.new_action=function(){var e,t,o,r;if("string"==typeof arguments[0])e=arguments[0],t=arguments[1],r=arguments[2],o=arguments[3];else{var n=arguments[0];e=n.type,t=n.path,r=n.time,o=n.data}var a={type:e,path:t.slice(),time:r||Date.now()};return void 0!==o&&(a.data=o),a},Hoard.prototype.push_action=function(){var e=Hoard.new_action.apply(this,arguments);return this.actions.push(e),e},Hoard.prototype.pop_action=function(){if(global.DEBUG&&0===this.actions.length)throw this.name+" hoard error: Cannot pop from empty actions stream";return this.actions.pop()},Hoard.prototype.locate_node=function(e,t){var o=this.cache;t=t||0;for(var r=0;r<e.length-t;r++){var n=e[r];if(o&&"string"==typeof o.data)throw this.name+" hoard error: Cannot recurse into leaf node";if(!o||!o.data[n])return;o=o.data[n]}return o},Hoard.prototype.play_action=function(e,t){function o(e,t){return{conflict:e,message:TX.tx("Cannot ")+{A:TX.tx("add reminder to"),C:TX.tx("cancel reminder"),D:TX.tx("delete"),E:TX.tx("change value of"),M:TX.tx("move"),N:TX.tx("create"),R:TX.tx("rename"),X:TX.tx("constrain")}[e.type]+" '"+e.path.join("↘")+"': "+t}}if(e.time||(e.time=Date.now()),0===e.path.length)return o(e,"Zero length path");this.cache||(this.cache={data:{}});var r=this.locate_node(e.path,1);if(!r)return o(e,TX.tx("Parent folder not found"));var n=e.path[e.path.length-1],a=r.data[n];if("N"===e.type){if(a)return o(e,TX.tx("It already exists")+" @"+new Date(a.time));r.time=e.time,r.data[n]={time:e.time,data:"string"==typeof e.data?e.data:{}}}else{if(!a)return o(e,TX.tx("It does not exist"));switch(e.type){case"M":var i=this.locate_node(e.data);if(!i)return o(TX.tx("New folder '$1' does not exist",e.data.join("↘")));i.time=r.time=e.time,delete r.data[n],i.data[n]=a;break;case"D":delete r.data[n],r.time=e.time;break;case"R":if(r.data[e.data])return o(e," '"+e.data+"': "+TX.tx("It already exists"));r.data[e.data]=a,delete r.data[n],r.time=e.time;break;case"E":a.data=e.data,a.time=e.time;break;case"A":e.data?a.alarm=e.data:delete a.alarm,a.time=e.time;break;case"C":if(!a)return o(e,TX.tx("It does not exist"));delete a.alarm,a.time=e.time;break;case"X":if(!a)return o(e,TX.tx("It does not exist"));e.data?a.constraints=e.data:delete a.constraints,a.time=e.time;break;default:global.DEBUG}}return t&&t.call(this,e),null},Hoard.prototype.merge_actions=function(e){var t=0,o=0;e.sort(function(e,t){return e.time<t.time?-1:e.time>t.time?1:0});for(var r=0;r<e.length;r++){var n=e[r];if(r>0&&n.time<e[r-1].time)throw this.name+" hoard; merged action stream is out of order";for(;t<this.actions.length&&this.actions[t].time<n.time;)t++;if(t<this.actions.length){var a=this.actions[t];if(n.time==a.time&&n.type==a.type&&n.path.join("/")==a.path.join("/")&&n.data==a.data)continue}this.actions.splice(t,0,Hoard.new_action(n)),o++}return o},Hoard.prototype._reconstruct_actions=function(e,t,o,r,n){function a(e,t,r){if(0===t.length)return void r();var n=void 0!==e.time?e.time:Date.now(),a=Hoard.new_action("N",t,n);"string"==typeof e.data?a.data=e.data:global.DEBUG&&e.data,o.call(c,a,function(){e.alarm&&o.call(c,Hoard.new_action("A",t,n,e.alarm)),e.constraints&&o.call(c,Hoard.new_action("X",t,n,e.constraints)),r()})}function i(e,t,o){var n,c;if(e.push(function(e){a(t,o,e),r&&r(Math.floor(100*l++/s))}),"object"==typeof t.data)for(n in t.data)c=o.slice(),c.push(n),i(e,t.data[n],c)}var s,l,c=this,u=[];i(u,e,t.slice()),s=u.length,l=0,n&&u.push(function(e){n(),e()}),Utils.execute_queue(u)},Hoard.prototype.actions_from_hierarchy=function(e,t,o,r){this._reconstruct_actions(e,[],t,o,r)},Hoard.prototype.reconstruct_actions=function(e,t,o){this.cache?this._reconstruct_actions(this.cache,[],e,t,o):o()},Hoard.prototype.play_actions=function(e,t,o){var r,n,a=[],i=e.length;for(global.DEBUG&&console.log("Playing new actions since "+new Date(this.last_sync).toLocaleString()),r=0;r<i;r++)e[r].time>this.last_sync?(global.DEBUG&&console.log("Play "+Hoard.stringify_action(e[r])),(n=this.play_action(e[r],t))&&(global.DEBUG&&console.log("Conflict: "+n.message),a.push(n))):global.DEBUG&&console.log("Skip old "+Hoard.stringify_action(e[r])),o&&o(Math.floor(100*r/i));return this.last_sync=Date.now(),a},Hoard.prototype.get_node=function(e){var t,o=this.cache;for(t=0;t<e.length;t++){if("string"==typeof o.data)return null;o=o.data[e[t]]}return o},Hoard.prototype.each_alarm=function(){for(var e=this,t=function(){e.each_alarm()};this.check&&this.check.queue.length>0;){var o,r=this.check.queue.pop(),n=r.node;if("object"==typeof n.data)for(o in n.data){var a=n.data[o];this.check.queue.push({node:a,path:r.path.slice().concat([o])})}if(void 0!==n.alarm&&Date.now()-n.time>=n.alarm*Utils.MSPERDAY)return void this.check.alarm(r.path,new Date(n.time+n.alarm*Utils.MSPERDAY),t)}delete this.check},Hoard.prototype.check_alarms=function(e){this.cache&&(this.check={queue:[{path:[],node:this.cache}],alarm:e},this.each_alarm())},Hoard.prototype.JSON=function(){var e="";return this.cache&&(e=JSON.stringify(this.cache.data,null,"\t")),e},"undefined"!=typeof module&&(module.exports=Hoard),/*@preserve Copyright (C) 2015-2018 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){e(function(){function t(t){var o=t.data("node"),r=o.data("constraints");r=void 0!==r?r.split(/;/,2):[i,s];var n=t.squirrelDialog("control","len").val(),a=t.squirrelDialog("control","chs").val();n!=r[0]||a!=r[1]?t.squirrelDialog("control","remember").show():t.squirrelDialog("control","remember").hide(),n!==i||a!==s?t.squirrelDialog("control","reset").show():t.squirrelDialog("control","reset").hide(),t.squirrelDialog("control","again").trigger(e.getTapEvent())}function o(e){e.squirrelDialog("control","len").val(i),e.squirrelDialog("control","chs").val(s),t(e)}function r(e){var t=e.squirrelDialog("control","number").val();t*=Utils.TIMEUNITS[e.squirrelDialog("control","units").val()].days;var o=new Date(Date.now()+t*Utils.MSPERDAY);e.squirrelDialog("control","nextmod").template("expand",Utils.deltaTimeString(o),o.toLocaleDateString())}function n(t){var o=function(e){t.squirrelDialog("control","message").template("pick","cui").template("expand",e)},r=t.squirrelDialog("control","file")[0].files[0];Utils.read_file(r,function(n){(n="data:"+r.type+";base64,"+Utils.ArrayBufferToBase64(n))!==t.squirrelDialog("control","steg_image").attr("src",n)&&t.squirrelDialog("control","steg_image").attr("src",n).off("load").on("load",function(){e(this).off("load");var r=new Steganographer(this);try{r.inject("tada")}catch(e){return global.DEBUG&&console.debug("Caught "+e),void o(e)}t.squirrelDialog("control","ok").iconbutton("enable");var n=this.naturalHeight,a=this.naturalWidth;this.height=100,t.squirrelDialog("control","message").template("pick","xbyy").template("expand",a,n),Squirrel.getClient().status===Squirrel.IS_LOADED&&(Squirrel.getClient().status=Squirrel.NEW_SETTINGS),Squirrel.getCloud().status===Squirrel.IS_LOADED&&(Squirrel.getCloud().status=Squirrel.NEW_SETTINGS),Utils.sometime("update_save")})},o,"arraybuffer")}function a(t){var o=t.squirrelDialog("control","key"),r=o.val(),n=!0;if(/\S/.test(r)){t.data("parent").find("ul").first().children(".tree-node").each(function(){if(0==Squirrel.compare(e(this).data("key"),r))return n=!1,!1})}else n=!1;n?(t.squirrelDialog("control","ok").iconbutton("enable"),o.removeClass("dlg-disabled").attr("title",TX.tx("Enter new name"))):(t.squirrelDialog("control","ok").iconbutton("disable"),o.addClass("dlg-disabled").attr("title",TX.tx("Name is already in use")))}e("#login_dlg").on("dlg-open",function(t,o){var r=e(this);r.squirrelDialog("control","uReq").toggle(o.user_required),r.squirrelDialog("control","pReq").toggle(o.pass_required);var n=r.squirrelDialog("control","user"),a=r.squirrelDialog("control","pass"),i=r.squirrelDialog("control","signin"),s=function(){return r.squirrelDialog("close"),i.off(e.getTapEvent()),n.off("change"),a.off("change"),o.on_signin.call(o.store,n.val(),a.data("hidden_pass")),!0};i.off(e.getTapEvent()).on(e.getTapEvent(),s),n.off("change").val(o.store.user()),a.off("change").val(o.store.pass()),o.user_required&&(n.attr("autofocus","autofocus"),o.pass_required?n.off("change").on("change",function(){a.focus()}):n.off("change").on("change",s),n.focus()),o.pass_required&&(r.squirrelDialog("control","foruser").toggle(null!==o.store.user()).text(o.store.user()||""),a.attr("autofocus","autofocus"),o.user_required?a.on("change",function(){i.focus()}):(a.focus(),a.on("change",function(){return s()})))}),e("#delete_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","ok").on(e.getTapEvent(),function(){return t.squirrelDialog("close"),Squirrel.playAction(Hoard.new_action("D",t.data("node").tree("getPath"),Date.now())),!0}),t.squirrelDialog("control","cancel").on(e.getTapEvent(),function(){return t.squirrelDialog("close"),!1})}).on("dlg-open",function(){var t=e(this);t.squirrelDialog("control","path").text(t.data("node").tree("getPath").join("↘")),t.squirrelDialog("control","coll").toggle(!t.data("node").hasClass("tree-leaf"))}),e("#pick_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","clear").on(e.getTapEvent(),function(){t.find(".dlg-picked").removeClass("dlg-picked")})}).on("dlg-open",function(){var t,o,r=e(this),n=r.data("node"),a=n.data("value"),i=r.squirrelDialog("control","which"),s=r.squirrelDialog("control","from");r.find(".dlg-pick-cell").remove();var l=function(){var t=e(this).data("i");r.find("td.i"+t).addClass("dlg-picked")};for(t=0;t<a.length;t++)o=s.children("td.i"+t),0===o.length&&(e(document.createElement("td")).data("i",t).addClass("dlg-pick-cell i"+t).text(t+1).on(e.getTapEvent(),l).appendTo(i),o=e(document.createElement("td")).data("i",t).addClass("dlg-pick-cell i"+t).on(e.getTapEvent(),l).appendTo(s)),o.text(a.charAt(t));for(;t<s.children("td").length;)s.children("td").last().remove(),t++;r.find(".dlg-picked").removeClass("dlg-picked")});const i=30,s="A-Za-z0-9!%^&*_$+-=;:@#~,./?";e("#randomise_dlg").on("dlg-initialise",function(){var r=e(this);r.squirrelDialog("control","again").on(e.getTapEvent(),function(){return r.squirrelDialog("control","idea").text(Utils.generate_password({length:r.squirrelDialog("control","len").val(),charset:r.squirrelDialog("control","chs").val()})),!1}),r.squirrelDialog("control","use").on(e.getTapEvent(),function(){return r.squirrelDialog("close"),Squirrel.playAction(Hoard.new_action("E",r.data("node").tree("getPath"),Date.now(),r.squirrelDialog("control","idea").text())),!0}),r.squirrelDialog("control","len").on("change",function(){t(r)}),r.squirrelDialog("control","chs").on("change",function(){t(r)}),r.squirrelDialog("control","remember").on(e.getTapEvent(),function(){Squirrel.playAction(Hoard.new_action("X",r.data("node").tree("getPath"),Date.now(),r.squirrelDialog("control","len").val()+";"+r.squirrelDialog("control","chs").val())),t(r)}),r.squirrelDialog("control","reset").on(e.getTapEvent(),function(){o(r)})}),e("#randomise_dlg").on("dlg-open",function(){var o=e(this),r=o.data("node"),n=r.data("key"),a=r.data("constraints");a&&(a=a.split(";",2),o.squirrelDialog("control","len").val(a[0]),o.squirrelDialog("control","chs").val(a[1]));var i=r.tree("getPath");o.squirrelDialog("control","path").text(i.join("↘")),o.squirrelDialog("control","key").text(n),o.squirrelDialog("control","again").trigger(e.getTapEvent()),o.squirrelDialog("control","remember").hide(),t(o)}),e("#search_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","ok").on(e.getTapEvent(),function(){t.squirrelDialog("close"),Squirrel.search(t.squirrelDialog("control","string").val())}),t.squirrelDialog("control","string").on("change",function(){t.squirrelDialog("control","ok").trigger(e.getTapEvent())})}),e("#alarm_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","units").on("change",function(){r(t)}),t.squirrelDialog("control","number").on("change",function(){r(t)}),t.squirrelDialog("control","remind").on(e.getTapEvent(),function(){t.squirrelDialog("close");var e=t.squirrelDialog("control","number").val()*Utils.TIMEUNITS[t.squirrelDialog("control","units").val()].days;return Squirrel.playAction(Hoard.new_action("A",t.data("node").tree("getPath"),Date.now(),e)),!1}),t.squirrelDialog("control","clear").on(e.getTapEvent(),function(){return t.squirrelDialog("close"),Squirrel.playAction(Hoard.new_action("C",t.data("node").tree("getPath"),Date.now())),!1})}),e("#alarm_dlg").on("dlg-open",function(){var t=e(this),o=t.data("node");t.squirrelDialog("control","path").text(o.tree("getPath").join("↘")),t.data("node",o);var n=o.data("last-time-changed");if(t.squirrelDialog("control","lastmod").template("expand",new Date(n).toLocaleString()),void 0!==o.data("alarm")){var a=new Date(n+o.data("alarm")*Utils.MSPERDAY);t.squirrelDialog("control","current").template("expand",Utils.deltaTimeString(a),a.toLocaleDateString()).show(),t.squirrelDialog("control","clear").show()}else t.squirrelDialog("control","current").hide(),t.squirrelDialog("control","clear").hide();r(this)}),e("#store_settings_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","file").hide().on(e.getTapEvent(),function(){n(t)}),t.squirrelDialog("control","image").on(e.getTapEvent(),function(e){t.squirrelDialog("control","file").trigger("change",e)}),t.squirrelDialog("control","storepath").on("keyup",function(){return""===t.squirrelDialog("control","storepath").val()?(t.squirrelDialog("control","message").template("pick","mnbe"),!1):(Squirrel.getClient().hoard.options.store_path!==t.squirrelDialog("control","storepath").val()&&(Squirrel.getClient().hoard.options.store_path=t.squirrelDialog("control","storepath").val(),Squirrel.getClient().status===Squirrel.IS_LOADED&&(Squirrel.getClient().status=Squirrel.NEW_SETTINGS),Utils.sometime("update_save")),!0)}).on("change",function(){t.squirrelDialog("control","ok").trigger(e.getTapEvent())}),t.squirrelDialog("control","ok").on(e.getTapEvent(),function(){if(""===t.squirrelDialog("control","storepath").val())return t.squirrelDialog("control","message").template("pick","mnbe"),!1;t.squirrelDialog("close")})}),e("#store_settings_dlg").on("dlg-open",function(){var t=e(this);t.squirrelDialog("control","message").hide(),t.squirrelDialog("control","storepath").focus().val(Squirrel.getClient().hoard.options.store_path)}),e("#chpw_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","show").on("change",function(){t.squirrelDialog("control","show").prop("checked")?(t.squirrelDialog("control","pass").attr("type","text"),t.squirrelDialog("control","conf").attr("type","text")):(t.squirrelDialog("control","pass").attr("type","password"),t.squirrelDialog("control","conf").attr("type","password"))}),t.data("validate",function(){var e=t.squirrelDialog("control","pass").val(),o=t.squirrelDialog("control","conf").val();return t.squirrelDialog("control","nomatch").toggle(e!==o),e===o}),t.squirrelDialog("control","conf").on("change",function(){t.data("validate").call()}),t.squirrelDialog("control","set").on(e.getTapEvent(),function(){if(!t.data("validate").call())return!1;t.squirrelDialog("close");var e=t.squirrelDialog("control","pass").val();return Squirrel.getClient().store.pass(e),Squirrel.getClient().status=Squirrel.NEW_SETTINGS,Squirrel.getCloud().store.pass(e),Squirrel.getCloud().status=Squirrel.NEW_SETTINGS,Utils.sometime("update_save"),!0})}),e("#chpw_dlg").on("dlg-open",function(){e(this).data("validate").call()}),e("#json_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","text").on("input",function(){t.squirrelDialog("control","ok").iconbutton("enable")}),t.squirrelDialog("control","ok").on(e.getTapEvent(),function(){t.squirrelDialog("close");var e;try{e=JSON.parse(t.squirrelDialog("control","text").val())}catch(e){return Squirrel.alert({title:TX.tx("JSON could not be parsed"),severity:"error",message:e}),!1}return t.squirrelDialog("control","ok").iconbutton("disable"),global.DEBUG&&console.debug("Importing..."),Squirrel.insert_data([],e),!0})}),e("#json_dlg").on("dlg-open",function(){var t=e(this),o=Squirrel.getClient().hoard.JSON();t.squirrelDialog("control","text").text(o).select(),t.squirrelDialog("control","ok").iconbutton("disable")}),e("#extras_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","theme").on("selectmenuchange",function(){Squirrel.theme(e(this).val())}).selectmenu(),t.squirrelDialog("control","autosave").on("change",function(){Squirrel.autosave(e(this).prop("checked"))}),t.squirrelDialog("control","hidevalues").on("change",function(){e("#sites-node").tree("hide_values",e(this).prop("checked"))}),t.squirrelDialog("control","chpw").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#chpw_dlg").squirrelDialog("open")}),t.squirrelDialog("control","chss").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#store_settings_dlg").squirrelDialog("open")}),t.squirrelDialog("control","theme").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#theme_dlg").squirrelDialog("open")}),t.squirrelDialog("control","json").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#json_dlg").squirrelDialog("open")}),t.squirrelDialog("control","optimise").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#optimise_dlg").squirrelDialog("open")}),t.squirrelDialog("control","bigger").on("click",function(){Squirrel.zoom(1.25)}),t.squirrelDialog("control","smaller").on("click",function(){Squirrel.zoom(.8)}),t.squirrelDialog("control","about").on(e.getTapEvent(),function(){t.squirrelDialog("close"),e("#about_dlg").squirrelDialog("open")}),t.squirrelDialog("control","language").on("change",function(){var e=t.squirrelDialog("control","language").val();e!==TX.language(e)&&TX.init()})}),e("#extras_dlg").on("dlg-open",function(){var t=e(this);Squirrel.USE_STEGANOGRAPHY||Squirrel.getCloud().store&&Squirrel.getCloud().store.options().needs_path||t.squirrelDialog("control","chss").hide(),t.squirrelDialog("control","autosave").prop("checked",Squirrel.autosave()),t.squirrelDialog("control","hidevalues").prop("checked",e("#sites-node").tree("hide_values")),t.squirrelDialog("control","theme").find("option:selected").prop("selected",!1),t.squirrelDialog("control","theme").find("option[value='"+Squirrel.theme()+"']").prop("selected",!0),t.squirrelDialog("control","language").val(TX.language())}),e("#insert_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","key").on("input",function(){a(t)}),t.squirrelDialog("control","ok").on(e.getTapEvent(),function(){t.squirrelDialog("close"),Squirrel.add_child_node(t.data("parent"),t.squirrelDialog("control","key").val(),t.data("data"))})}),e("#insert_dlg").on("dlg-open",function(t,o){var r=e(this);global.DEBUG&&console.debug("Pasting");var n=o.$node;r.data("parent",n),r.data("data",o.data);var a=TX.tx("A copy"),i=new RegExp("^"+a+" ?(\\d*)$"),s=-1;n.find("ul").first().children(".tree-node").each(function(){var t=i.exec(e(this).data("key"));t&&(s=Math.max(s,t[1]?parseInt(t[1]):0))}),r.squirrelDialog("control","key").val(a+(s>=0?" "+(s+1):""))}),e("#add_dlg").on("dlg-initialise",function(){function t(){o.squirrelDialog("close");var e=o.data("parent");return Squirrel.add_child_node(e,o.squirrelDialog("control","key").val(),o.data("adding_value")?o.squirrelDialog("control","value").val():void 0),!1}var o=e(this);o.squirrelDialog("control","key").on("input",function(){a(o)}).on("change",t).autocomplete({source:[TX.tx("User"),TX.tx("Pass")]}),o.squirrelDialog("control","ok").on(e.getTapEvent(),t)}),e("#add_dlg").on("dlg-open",function(t,o){var r=e(this),n=o.$node,i=o.is_value;r.data("parent",n),r.data("adding_value",i),r.squirrelDialog("control","path").text(n.tree("getPath").join("↘")+"↘"),i?(r.squirrelDialog("control","value_help").show(),r.squirrelDialog("control","folder_help").hide(),r.squirrelDialog("control","value_parts").show(),r.squirrelDialog("control","key").autocomplete("enable").select(),r.squirrelDialog("control","value").val("")):(r.squirrelDialog("control","value_help").hide(),r.squirrelDialog("control","folder_help").show(),r.squirrelDialog("control","value_parts").hide(),r.squirrelDialog("control","key").autocomplete("disable").select()),a(r)}),e("#optimise_dlg").on("dlg-initialise",function(){var t=e(this);t.squirrelDialog("control","optimise").on(e.getTapEvent(),function(){return Squirrel.getClient().hoard.clear_actions(),Squirrel.construct_new_cloud(function(){t.squirrelDialog("close")}),!1})}),e("#optimise_dlg").on("dlg-open",function(){var t=e(this);t.squirrelDialog("control","existing").template("expand",Squirrel.getCloud().hoard.actions.length),t.squirrelDialog("control","study").hide(),t.squirrelDialog("control","pointless").hide(),t.squirrelDialog("control","optimise").iconbutton("disable"),t.squirrelDialog("control","calculating").show().toggle("pulsate",101);var o=Squirrel.getClient().hoard,r={N:0,A:0,X:0};o.actions_from_hierarchy(o.cache,function(e,t){r[e.type]++,t&&t()},null,function(){t.squirrelDialog("control","calculating").hide(),t.squirrelDialog("control","study").template("expand",r.N,r.A,r.X,r.N+r.A+r.X).show(),r.N+r.A+r.X<Squirrel.getCloud().hoard.actions.length?t.squirrelDialog("control","optimise").iconbutton("enable"):t.squirrelDialog("control","pointless").show()})})})}(jQuery),/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(e){function t(e){return"on"==Cookies.get("ui_hidevalues")?e.replace(/./g,"※"):e}function o(o){if(void 0!==o){var r="on"==Cookies.get("ui_hidevalues");Cookies.set("ui_hidevalues",o?"on":"off",{expires:365}),o!==r&&e(".tree-value:not(:hover)").each(function(){var o=e(this).closest(".tree-node").data("value");e(this).text(t(o))})}return"on"==Cookies.get("ui_hidevalues")}function r(t){function o(o){var r=e(".tree-collection").not(".ui-draggable-dragging").filter(function(){if(e(this).is(t.parent().closest(".tree-node")))return!1;var r=e(this).offset();return!(o.pageX<r.left||o.pageY<r.top)&&!(o.pageX>r.left+e(this).outerWidth(!0)||o.pageY>r.top+e(this).outerHeight(!0))});e(".drop-target").removeClass("drop-target"),r.length>0&&(r=r.last(),r.addClass("drop-target"))}function r(){var o=e(".drop-target");o.length,o.each(function(){var o=e(this);o.removeClass("drop-target");var r=t.tree("getPath"),n=o.tree("getPath");Squirrel.playAction({type:"M",path:r,data:n})})}var n=e(document.createElement("div")).addClass("tree-draghandle").iconbutton({icon:"ui-icon-arrow-2-n-s"}).hide();t.children(".tree-title").append(n),t.draggable({handle:".tree-draghandle",axis:"y",containment:".tree-collection",cursor:"pointer",revert:!0,revertDuration:1,drag:o,stop:r})}function n(t){t.data("alarm")&&t.find(".tree-key").first().before(function(){var o=e(document.createElement("button")).addClass("tree-alarm");return o.iconbutton({icon:"squirrel-icon-alarm"}).on("click",function(){return e("#alarm_dlg").squirrelDialog("open",{$node:t}),!1}),o})}function a(a){function i(){return Squirrel.contextMenu("close"),e("body").find("input.in_place_editor").length>0||(e(".tree-hover").removeClass("tree-hover"),o()&&a.hasClass("tree-leaf")&&e(this).find(".tree-value").each(function(){e(this).text(a.data("value"))}),e(this).addClass("tree-hover").find(".tree-draghandle").first().show(),!1)}function s(){if(Squirrel.contextMenu("isOpen")||e("body").find("input.in_place_editor").length>0)return!0;o()&&a.hasClass("tree-leaf")&&e(this).find(".tree-value").each(function(){e(this).text(t(a.data("value")))}),e(this).removeClass("tree-hover").find(".tree-draghandle").first().hide()}var l=e(document.createElement("div")).addClass("tree-title").hover(i,s).on("paste",function(){}).prependTo(a);if(!a.hasClass("tree-leaf")){var c=e(document.createElement("button")).addClass("tree-node-is-open-close");c.appendTo(l),c.iconbutton({icon:"squirrel-icon-folder-closed"}).on(e.getTapEvent(),function(){return a.tree("toggle"),!1})}var u=e(document.createElement("div")).addClass("tree-info").appendTo(l);e(document.createElement("span")).appendTo(u).addClass("tree-key").text(a.data("key")).on(e.isTouchCapable&&e.isTouchCapable()?"doubletap":"dblclick",function(t){global.DEBUG&&console.debug("Double-click 1"),t.preventDefault(),e(t.target).closest(".tree-node").tree("editKey")}),a.hasClass("tree-leaf")&&(e(document.createElement("span")).text(" : ").addClass("tree-separator").appendTo(u),e(document.createElement("span")).appendTo(u).addClass("tree-value").text(t(a.data("value"))).on(e.isTouchCapable&&e.isTouchCapable()?"doubletap":"dblclick",function(t){global.DEBUG&&console.debug("Double-click 2"),t.preventDefault(),e(t.target).closest(".tree-node").tree("editValue")})),r(a),n(a)}var i={};const s=String.fromCharCode(1);var l,c={};c.hide_values=o,c._create=function(){var t=this.element;this.options.compare&&(l=this.options.compare);var o,r,n=this.options,a=!1,s=!n.path,c="";if(t.addClass("tree-node"),t.addClass("tree-never-opened"),s?(i[""]=t,t.addClass("tree-root"),t.data("path",[])):(o=n.path.slice(),c=o.pop(),r=this.getNodeFromPath(o),t.data("key",c),void 0!==n.value&&null!==n.value&&(t.data("value",n.value).data("is_leaf",!0).addClass("tree-leaf"),a=!0)),!a){var u=e(document.createElement("ul")).addClass("sortable tree-subnodes").hide();t.addClass("tree-collection").append(u)}r&&this._insertInto(r),void 0!==n.time&&this.setModified(n.time),n.on_create&&n.on_create.call(t)},c.edit=function(t,o,r){var n=this.element,a=n.closest(".tree-root").width();a-=t.position().left,t.parents().each(function(){a-=e(this).position().left}),Squirrel.contextMenu("disable");var i=this.getPath();t.edit_in_place({width:a,text:o,changed:function(e){return Squirrel.playAction({type:r,path:i,data:e}),e},closed:function(){Squirrel.contextMenu("enable")}})},c.editKey=function(){var e=this.element;this.edit(e.find(".tree-key").first(),e.data("key"),"R")},c.editValue=function(){var e=this.element;this.edit(e.find(".tree-value").first(),e.data("value"),"E")},c.ringAlarm=function(){this.element.find(".tree-alarm").addClass("tree-expired").find(".squirrel-icon-alarm").removeClass("squirrel-icon-alarm").addClass("squirrel-icon-rang")},c.getPath=function(){var e=this.element;if(e.hasClass("tree-root"))return[];e.hasClass("tree-node");var t=e.data("path");return t||(this._addToCaches(),(t=e.data("path"))||(t=[])),t},c._insertInto=function(t){var o=this.element;this._removeFromCaches(),o.detach();var r=o.data("key"),n=!1,a=t.find("ul").first();a.children(".tree-node").each(function(){if(l(e(this).data("key"),r)>0)return o.insertBefore(e(this)),n=!0,!1}),n||a.append(o),this._addToCaches()},c.setModified=function(e){return this.element.addClass("tree-modified").data("last-time-changed",e)},c.open=function(t){var o=this.element;return t&&t.decorate&&a(o),o.hasClass("tree-node-is-open")?o:(o.hasClass("tree-never-opened")&&(o.removeClass("tree-never-opened"),o.children(".tree-subnodes").children().each(function(){a(e(this))})),o.hasClass("tree-root")||o.find(".tree-node-is-open-close").first().iconbutton("option","icon","squirrel-icon-folder-open"),o.addClass("tree-node-is-open").children(".tree-subnodes").show())},c.close=function(){var e=this.element;return e.hasClass("tree-node-is-open")?(e.find(".tree-node-is-open-close").first().iconbutton("option","icon","squirrel-icon-folder-closed"),e.removeClass("tree-node-is-open").children(".tree-subnodes").hide()):e},c.toggle=function(){return this.element.hasClass("tree-node-is-open")?this.close():this.open()},c.action_E=function(e,o){var r=this.element;o&&o("E",this.getPath(),e.time,r.data("value")),r.data("value",e.data).find(".tree-value").first().text(t(e.data)),this.setModified(e.time)},c.action_D=function(e,t){var o=this.element;t&&t("N",this.getPath(),e.time,o.data("value")),this._removeFromCaches(),o.parent().closest(".tree-node").tree("setModified",e.time),o.remove()},c.action_A=function(t,o){var r=this.element,a=r.data("alarm");a!==t.data&&(r.data("alarm",t.data),void 0===a?(n(r),r.parents(".tree-node").each(function(){var t=e(this).data("alarm-count")||0;e(this).data("alarm-count",t+1),e(this).addClass("tree-has-alarms")}),o&&o("C",this.getPath(),t.time)):o&&o("A",this.getPath(),t.time,a),this.setModified(t.time))},c.action_C=function(t,o){var r=this.element,n=r.data("alarm");n&&(o&&o("A",this.getPath(),t.time,n),r.parents(".tree-node").each(function(){var t=e(this).data("alarm-count")||0;t-=1,e(this).data("alarm-count",t),0===t&&e(this).removeClass("tree-has-alarms")}),e(".tree-alarm").first().remove(),r.removeData("alarm"),this.setModified(t.time))},c.action_X=function(e,t){var o=this.element.data("constraints");o!==e.data&&(t&&t("X",this.getPath(),e.time,o),this.element.data("constraints",e.data),this.setModified(e.time))},c.action_M=function(e,t){var o=this.element,r=this.getPath(),n=e.data.slice(),a=this.getNodeFromPath(n);this._insertInto(a),o.scroll_into_view(),this.setModified(e.time),n.push(r.pop()),t&&t("M",n,e.time,r)},c.action_R=function(e,t){var o=this.element,r=e.path[e.path.length-1];o.data("key",e.data).find(".tree-key").first().text(e.data),this.setModified(e.time),this._insertInto(o.parent().closest(".tree-collection")),o.scroll_into_view(),t&&t("R",o.tree("getPath"),e.time,r)},c.action=function(t,o,r){if("N"===t.type)e(document.createElement("li")).tree({path:t.path,value:t.data,time:t.time,on_create:function(){o&&o("D",this.tree("getPath"),t.time),void 0!==r&&r(this)}});else{var n=this.getNodeFromPath(t.path);n.tree("action_"+t.type,t,o),void 0!==r&&r(n)}},c._addToCaches=function(){function t(o,r){var n=r.concat(o.data("key"));if(global.DEBUG){if(!r)throw"recache outside tree";if(i[n.join(s)])throw"Remapping path -> node";if(o.data("path"))throw"Remapping node -> path"}o.data("path",n),i[n.join(s)]=o,o.find("ul").first().children(".tree-node").each(function(){t(e(this),n)})}var o=this.element,r=o.parent();!r||r.length,!(r=r.closest(".tree-node"))||r.length,t(o,r.tree("getPath"))},c._removeFromCaches=function(){var t=this.element;t.hasClass("tree-node")||(t=t.closest(".tree-node")),t.data("path")&&delete i[t.data("path").join(s)],t.removeData("path").find(".tree-node").each(function(){var t=e(this);delete i[t.data("path").join(s)],t.removeData("path")})},c.getNodeFromPath=function(e){var t=i[e.join(s)];return global.DEBUG&&t&&t.length,t},e.widget("squirrel.tree",c)}(jQuery);/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
var Squirrel={NEW_SETTINGS:"has new settings",IS_LOADED:"is loaded",IS_CORRUPT:"is corrupt",IS_EMPTY:"is empty"};!function(e,t){function o(){X.hoard.check_alarms(function(o,r,n){C.getNodeFromPath(o).tree("ringAlarm"),t.alert({severity:"warning",message:"<div class='ui-icon squirrel-icon-rang'></div>"+TX.tx("Reminder on '$1' was due on $2",o.join("↘"),r.toLocaleDateString()),after_close:n}).on("dialogclose",function(t){e(t.target).off("dialogclose")})})}function r(o){var r=[];if(e(".tree-modified").each(function(){global.DEBUG&&!e(this).tree("getPath")&&e(this).hasClass("tree-root");var t=e(this).data("path")||[];r.push(TX.tx("$1 has changed",t.join("↘")))}),r.length>o){var n=r.length;r=r.slice(0,o),r.push(TX.tx("... and $1 more change$?($1!=1,s,)",n-5))}return G.status!==t.IS_LOADED&&r.unshift(TX.tx("The $1 hoard $2",G.store?G.store.options().identifier:TX.tx("Cloud"),TX.tx(G.status))),X.status!==t.IS_LOADED&&r.unshift(TX.tx("The $1 hoard $2",X.store.options().identifier,TX.tx(X.status))),0===r.length?null:r.join("\n")}function n(){global.DEBUG&&console.debug("...save finished"),Utils.sometime("update_save"),M&&N?"on"===Cookies.get("ui_autosave")?t.alert():t.alert({severity:"notice",message:TX.tx("Save complete")}):(t.alert({severity:"error",message:TX.tx("Save encountered errors")}),Cookies.set("ui_autosave","off",{expires:365}))}function a(){X.store.writes("S."+X.store.user(),JSON.stringify(X.hoard),function(){global.DEBUG&&console.debug("...client save OK"),e(".tree-modified").removeClass("tree-modified"),X.status=t.IS_LOADED,t.alert({severity:"notice",message:TX.tx("Saved in $1",this.options().identifier)}),n()},function(e){global.DEBUG&&console.debug("...client save failed "+e),t.alert({severity:"error",message:TX.tx("Failed to save in $1: $2",this.options().identifier,e)}),M=!1,n()})}function i(){if(global.DEBUG&&console.debug("...save to client"),X.status===t.IS_LOADED&&0===e(".tree-modified").length)return void n();X.status=t.PENDING_SAVE,t.alert({severity:"notice",transitory:!0,message:TX.tx("Saving in $1",X.store.options().identifier)}),Utils.soon(a)}function s(){G.store.writes(X.hoard.options.store_path,JSON.stringify(G.hoard),function(){global.DEBUG&&console.debug("...cloud save OK"),X.hoard.actions=[],X.hoard.last_sync=Date.now(),F=[],t.alert({severity:"notice",message:TX.tx("Saved in $1",this.options().identifier)}),G.status=t.IS_LOADED,i()},function(e){global.DEBUG&&console.debug("...cloud save failed "+e),t.alert({severity:"error",message:TX.tx("Failed to save in $1: $2",this.options().identifier,e)}),N=!1,i()})}function l(e){G.hoard.merge_actions(X.hoard.actions),G.store?(global.DEBUG&&console.debug("...save to cloud"),t.alert({severity:"notice",transitory:!0,message:TX.tx("Saving in $1",G.store.options().identifier)}),G.status=t.PENDING_SAVE,Utils.soon(function(){s()})):(global.DEBUG&&console.debug("...no cloud store"),e&&e())}function c(o){global.DEBUG&&console.debug("...cloud read OK ");try{G.hoard=new Hoard("reloaded Cloud",o),G.status=t.IS_LOADED}catch(e){return global.DEBUG&&console.debug("Cloud hoard JSON parse failed: "+e),t.alert({severity:"error",message:TX.tx("$1 hoard can't be read for update",this.options().identifier)}),G.status=t.IS_CORRUPT,N=!1,void t.construct_new_cloud()}G.status===t.IS_LOADED&&(global.DEBUG&&console.debug("...merge cloud "),X.hoard.play_actions(G.hoard.actions,function(e){C.action(e)},function(t){e("#merge_progress").text(t+"%")})),G.status!==t.IS_LOADED||0!==X.hoard.actions.length?(global.DEBUG&&console.debug("...update from cloud: "+G.status),l(i)):Utils.soon(i)}function u(e){global.DEBUG&&console.debug("...cloud read failed "+e),e===AbstractStore.NODATA?(global.DEBUG&&console.debug(this.options().identifier+" contains NODATA"),G.status=t.IS_EMPTY,t.construct_new_cloud()):(t.alert({severity:"error",message:TX.tx("Failed to refresh from $1: $2",this.options().identifier,e)}),N=!1,Utils.soon(i))}function d(){t.alert({title:TX.tx("Saving")}),M=!0,N=!0,global.DEBUG&&console.debug("Saving; client "+X.status+"; cloud "+G.status),G.status===t.NEW_SETTINGS||G.status===t.IS_EMPTY?(global.DEBUG&&console.debug("...constructing new cloud because settings"),t.construct_new_cloud()):(global.DEBUG&&console.debug("...reloading cloud"),G.store.reads(X.hoard.options.store_path,c,u))}function g(){e("#undo_button").toggle(t.can_undo());var o=r(3),n=e("#save_button");null!==o?"on"===Cookies.get("ui_autosave")?d():(n.attr("title",TX.tx("Save is required because")+": "+o),n.show()):n.hide()}function h(){global.DEBUG&&console.debug("step_8_authenticated"),e("#whoami").text(X.store.user()),e("#unauthenticated").hide(),e("#authenticated").show(),e("#sites-node").tree("open"),Utils.sometime_is_now()}function f(){global.DEBUG&&console.debug("step_7_hoards_loaded"),e(window).on("beforeunload",function(){var e=r(10);if(null!==e)return e=TX.tx("You have unsaved changes")+"\n"+e+"\n"+TX.tx("Are you really sure?")}),Utils.sometime("update_save"),Utils.sometime("check_alarms"),h()}function p(o){global.DEBUG&&console.debug("step_6a_merge_from_cloud");var r=X.hoard.play_actions(G.hoard.actions,function(e){C.action(e)},function(t){e("#merge_progress").text(t+"%")});r.length>0&&(t.alert({title:TX.tx("Warning"),severity:"warning",message:TX.tx("Conflicts were detected while merging actions from the Cloud.")+" "+TX.tx("Please review these rejected actions, and make sure the data displayed is correct before saving.")}),e.each(r,function(e,o){var r=o.conflict;t.alert({severity:"warning",message:Hoard.stringify_action(r)+": "+o.message})})),G.status=t.IS_LOADED,o()}function m(){global.DEBUG&&console.debug("step_6_load_cloud_hoard"),G.store?(e("#stage").text(TX.tx("Reading from cloud")),G.store.reads(X.hoard.options.store_path,function(e){global.DEBUG&&console.debug(this.options().identifier+" is ready");try{G.hoard=new Hoard("Cloud",e),global.DEBUG&&k&&console.debug(JSON.stringify(G.hoard))}catch(e){return global.DEBUG&&console.debug("Cloud hoard JSON parse failed: "+e),t.alert({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 hoard exists, but can't be read.",this.options().identifier)+" "+TX.tx("Check that you have the correct password.")}),G.status=t.IS_CORRUPT,void Utils.soon(f)}p(f)},function(e){e===AbstractStore.NODATA?(global.DEBUG&&console.debug(this.options().identifier+" contains NODATA"),G.status=t.IS_EMPTY):(global.DEBUG&&console.debug(this.options().identifier+" has NODATA: "+e),t.alert({title:TX.tx("Error"),severity:"error",message:TX.tx("Could not load cloud store")}),t.alert({severity:"notice",message:TX.tx("Check that the cloud store exists and you have the correct password.")})),Utils.soon(f)})):f()}function v(){global.DEBUG&&console.debug("step_5_init_client_hoard"),X.hoard=new Hoard("Client"),X.status=t.IS_EMPTY,G.store&&G.store.options().needs_path?e("#store_settings_dlg").squirrelDialog("option","close",function(){m()}).squirrelDialog("open"):m()}function y(){function o(){e("#stage").text(TX.tx("Building UI")),X.hoard.reconstruct_actions(function(e,t){C.action(e,null,t)},function(t){e("#load_progress").text(t+"%")},function(){e(".tree-modified").removeClass("tree-modified");var t,o,r,n=X.hoard.actions;for(t=0;t<n.length;t++)for(o=n[t].path.slice();o.length>0;){if(r=C.getNodeFromPath(o)){r.addClass("tree-modified");break}o.pop()}Utils.soon(m)})}global.DEBUG&&console.debug("step_4_load_client_hoard"),e("#stage").text(TX.tx("Reading from client")),X.store.reads("S."+X.store.user(),function(r){try{X.hoard=new Hoard("Client",r),X.status=t.IS_LOADED}catch(e){return global.DEBUG&&console.debug("Caught "+e),t.alert({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 hoard exists, but can't be read.",this.options().identifier),after_close:function(){Utils.sometime("init_application")}}),void t.alert({severity:"notice",message:TX.tx("Check that you have the correct password.")})}(X.store&&X.store.options().needs_path||G.store&&G.store.options().needs_path)&&!X.hoard.options.store_path?e("#store_settings_dlg").squirrelDialog("open",o):o()},function(e){e===AbstractStore.NODATA?(global.DEBUG&&console.debug(this.options().identifier+" contains NODATA"),Utils.soon(v)):t.alert({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 store error: $2",this.options().identifier,e),after_close:function(){Utils.sometime("init_application")}})})}function b(){var t=!0,o=!0;global.DEBUG&&console.debug("step_3_identify_user"),e("#stage").text(TX.tx("Authentication")),G.store&&void 0!==G.store.user()?(global.DEBUG&&console.debug("Cloud user is preferred: "+G.store.user()),X.store.user(G.store.user()),t=!1):X.store&&void 0!==X.store.user()&&(global.DEBUG&&console.debug("Client user is available: "+X.store.user()),G.store&&G.store.user(X.store.user()),t=!1),G.store&&void 0!==G.store.pass()?(global.DEBUG&&console.debug("Cloud pass is preferred"),X.store&&X.store.pass(G.store.pass()),o=!1):X.store&&void 0!==X.store.pass()&&(global.DEBUG&&console.debug("Client pass is available"),G.store&&G.store.pass(X.store.pass()),o=!1),t||o?e("#login_dlg").squirrelDialog("open",{store:X.store,on_signin:function(e,t){global.DEBUG&&console.debug("Login prompt said user was "+e),X.store.user(e),X.store.pass(t),G.store&&(G.store.user(e),G.store.pass(t)),y()},user_required:t,pass_required:o}):y()}function D(){global.DEBUG&&console.debug("step_2_init_client_store");var e={understore:function(e){return new LocalStorageStore(e)},ok:function(){global.DEBUG&&console.debug(this.options().identifier+" store is ready"),X.store=this,Utils.soon(b)},fail:function(e){t.alert({title:TX.tx("Error"),severity:"error",message:TX.tx("Encryption error: $1",e)})}};void 0!==global.URLPARAMS.plaintext?e.understore(e):new EncryptedStore(e)}function _(){global.DEBUG&&console.debug("step_1_init_cloud_store");var e={ok:function(){G.store=this,Utils.soon(D)},fail:function(e){t.alert({title:TX.tx("Warning"),severity:"warning",message:TX.tx("Could not open cloud store: $1",e),after_close:function(){D()}}),t.alert({severity:"warning",message:TX.tx("If you continue, only the client store will be available")})},understore:function(e){return U?(e.understore=function(e){return new global.CLOUD_STORE(e)},new StegaStore(e)):new global.CLOUD_STORE(e)}};return void 0!==global.URLPARAMS.plaintext?e.understore(e):new EncryptedStore(e)}function E(t,o){if(B>0)return!1;var r=o.target.is(".tree-node")?o.target:o.target.closest(".tree-node"),n=void 0!==r.data("alarm"),a=r.hasClass("tree-leaf"),i=o.target.closest(".tree-node").hasClass("tree-root"),s=r.hasClass("tree-node-is-open"),l=e("body");global.DEBUG&&console.debug("beforeOpen contextmenu on "+r.data("key")+" "+a),l.contextmenu("showEntry","add_alarm",!n&&!i).contextmenu("showEntry","add_subtree",s&&!a).contextmenu("showEntry","add_value",s&&!a&&!i).contextmenu("showEntry","copy_value",a).contextmenu("showEntry","delete",!i).contextmenu("showEntry","edit",a).contextmenu("showEntry","insert_copy",!a&&void 0!==A).contextmenu("showEntry","make_copy",!i&&!a).contextmenu("showEntry","pick_from",a).contextmenu("showEntry","randomise",a).contextmenu("showEntry","rename",!i),x=r}function q(t,o){var r=x;if(!r)return void(global.DEBUG&&console.debug("No node for contextmenu>"+o.cmd));switch(o.cmd){case"copy_value":A=r.data("value");break;case"make_copy":var n=r.tree("getPath"),a=X.hoard.get_node(n);A=JSON.stringify(a);break;case"insert_copy":if(A)try{var i=JSON.parse(A);e("#insert_dlg").squirrelDialog("open",{$node:r,data:i})}catch(t){global.DEBUG}break;case"rename":r.tree("editKey");break;case"edit":r.tree("editValue");break;case"add_value":e("#add_dlg").squirrelDialog("open",{$node:r,is_value:!0});break;case"add_subtree":e("#add_dlg").squirrelDialog("open",{$node:r,is_value:!1});break;case"randomise":e("#randomise_dlg").squirrelDialog("open",{$node:r});break;case"add_alarm":e("#alarm_dlg").squirrelDialog("open",{$node:r});break;case"delete":e("#delete_dlg").squirrelDialog("open",{$node:r});break;case"pick_from":e("#pick_dlg").squirrelDialog("open",{$node:r});break;default:global.DEBUG}}function w(){var o={delegate:".tree-title",menu:[{title:TX.tx("Copy value"),cmd:"copy_value",uiIcon:"squirrel-icon-copy squirrel-icon"},{title:TX.tx("Pick characters"),cmd:"pick_from",uiIcon:"squirrel-icon-pick squirrel-icon"},{title:TX.tx("Rename"),cmd:"rename",uiIcon:"squirrel-icon-edit squirrel-icon"},{title:TX.tx("Edit value"),cmd:"edit",uiIcon:"squirrel-icon-edit squirrel-icon"},{title:TX.tx("Add reminder"),cmd:"add_alarm",uiIcon:"squirrel-icon-alarm squirrel-icon"},{title:TX.tx("Generate new random value"),cmd:"randomise",uiIcon:"squirrel-icon-key squirrel-icon"},{title:TX.tx("Add new value"),cmd:"add_value",uiIcon:"squirrel-icon-add-value squirrel-icon"},{title:TX.tx("Add new folder"),cmd:"add_subtree",uiIcon:"squirrel-icon-add-folder squirrel-icon"},{title:TX.tx("Copy folder"),cmd:"make_copy",uiIcon:"squirrel-icon-copy squirrel-icon"},{title:TX.tx("Insert copy of folder"),cmd:"insert_copy",uiIcon:"squirrel-icon-paste squirrel-icon"},{title:TX.tx("Delete"),cmd:"delete",uiIcon:"squirrel-icon-delete squirrel-icon"}],preventContextMenuForPopup:!0,preventSelect:!0,beforeOpen:E,select:q};e("body").contextmenu(o),t.valueCopyClipboard=new ClipboardJS(".ui-contextmenu li[data-command='copy_value']",{text:function(){var e=x;return global.DEBUG&&console.debug("clip val from: "+e.data("key")),e.data("value")}}),t.treeCopyClipboard=new ClipboardJS(".ui-contextmenu li[data-command='make_copy']",{text:function(){var e=x;global.DEBUG&&console.debug("clip json from: "+e.data("key"));var t=e.tree("getPath"),o=X.hoard.get_node(t);return JSON.stringify(o)}})}function T(){e("#stage").text(TX.tx("Loading application")),_()}function S(){if(e("#sites-node").tree({is_root:!0,compare:t.compare}),C=e("#sites-node").data("squirrelTree"),global.DEBUG&&console.debug("DOM tree rooted "+C),e(".dlg-dialog").squirrelDialog({autoOpen:!1}),e("#alerts").dialog({autoOpen:!1}),e(".template").template(),e(".twisted").twisted(),e('input[type="password"]').simulated_password(),global.DEBUG){var r=1;e("#template-test").template().template("pick",r).template("expand","Cats"),e("#template-tester").iconbutton().on("click",function(){e("#template-test").template("pick",r).template("expand","Squirrels","cats"),r=(r+1)%3})}else e(".debug-only").remove();e("#save_button").hide().on(e.getTapEvent(),function(){return d(),!1}),e("#undo_button").hide().on(e.getTapEvent(),function(){return t.undo(function(e){t.alert({title:"Undo",message:e})}),!1}),e("#extras_button").on(e.getTapEvent(),function(){e("#extras_dlg").squirrelDialog("open")}),e("#search_input").on("change",function(){t.search(e(this).val())}),e("#search_button").on(e.getTapEvent(),function(){t.search(e("#search_input").val())}),e("button").iconbutton(),w(),e(document).on("init_application",T).on("check_alarms",o).on("update_save",g).on("reset_styling",function(){e.reset_styling()}),e.reset_styling(),Utils.sometime_is_now()}var A,C,x,U=!1,k=!1,F=[],B=0,X={store:null,hoard:null,status:t.IS_EMPTY},G={store:null,hoard:null,status:t.IS_EMPTY},I=[TX.tx("A new folder"),TX.tx("A new value"),TX.tx("User"),TX.tx("Pass")];t.alert=function(t){var o=e("#alerts");if(o.hasClass("dlg-initialised")||(o.find(".close").on("click",function(){o.dialog("close")}),o.addClass("dlg-initialised")),void 0===t)return void(o.dialog("isOpen")&&o.dialog("close"));o.dialog("isOpen")||(o.find(".messages").empty(),o.dialog("option","title",t.title||TX.tx("Alert")),o.dialog("open")),o.find(".transitory").remove();var r=e(document.createElement("div")).addClass("dlg-"+t.severity);t.transitory&&r.addClass("transitory"),r.append(t.message),o.find(".messages").append(r)},t.theme=function(t){return void 0!==t&&(e("#jQueryTheme").each(function(){this.href=this.href.replace(/\/themes\/[^\/]+/,"/themes/"+t),e(this).replaceWith(e(this)),Utils.sometime("reset_styling")}),"base"===t?Cookies.remove("ui_theme"):Cookies.set("ui_theme",t,{expires:365})),Cookies.get("ui_theme")},t.scale=function(t){return void 0!==t&&t>6&&(e("body").css("font-size",t+"px"),Cookies.set("ui_scale",t,{expires:365})),Cookies.get("ui_scale")},t.zoom=function(o){var r=e("body").css("font-size");r=r.replace(/px/,""),t.scale(Math.round(o*parseInt(r)))},t.autosave=function(e){if(void 0!==typeof e){var t=e?"on":"off";Cookies.get("ui_autosave")!==t&&(Cookies.set("ui_autosave",t,{expires:365}),Utils.sometime("update_save"))}return Cookies.get("ui_autosave")},t.compare=function(e,t){if(e==t)return 0;for(var o=0;o<I.length;o++){if(e==I[o])return-1;if(t==I[o])return 1}return e<t?-1:1};var M=!0,N=!0;t.construct_new_cloud=function(e,t){global.DEBUG&&console.debug("...construct cloud "),G.hoard=new Hoard("new Cloud"),X.hoard.reconstruct_actions(function(e,t){G.hoard.push_action(e),t&&t()},e,function(){l(t)})},t.contextMenu=function(t){switch(t){case"enable":B>0&&B--,global.DEBUG&&console.log("Context menu disables "+B),B<=0&&e("body").contextmenu("option","autoTrigger",!0);break;case"disable":B++,global.DEBUG&&console.log("Context menu disables "+B),e("body").contextmenu("option","autoTrigger",!1);break;default:return e("body").contextmenu(t)}},t.add_child_node=function(e,o,r){var n=e.tree("getPath");n=n.concat(o);var a=X.hoard.push_action("N",n,Date.now(),"string"==typeof r?r:void 0),i=X.hoard.play_action(a,function(e){C.action(e,t.pushUndo,function(e){global.DEBUG,"string"!=typeof r&&void 0!==r&&t.insert_data(e.tree("getPath"),r),e.tree("open",{decorate:!0}),Utils.sometime("update_save")})});null!==i&&t.alert({message:i.message})};var O="",R=0;t.search=function(o){var r;if(e(".picked-hit").removeClass("picked-hit"),o!==O){e("#search_hits").text(TX.tx("Searching..."));var n;try{n=new RegExp(o,"i")}catch(e){return void t.alert({message:TX.tx("Error in search expression")+" '"+o+"': "+e})}if(O=o,e(".search-hit").removeClass("search-hit"),e(".tree-node").not(".tree-root").each(function(){var t=e(this);(t.data("key").match(n)||t.hasClass("tree-leaf")&&t.data("value").match(n))&&t.addClass("search-hit")}),r=e(".search-hit"),0===r.length)return void e("#search_hits").text(TX.tx("Not found"));R=0}r=r||e(".search-hit"),R<r.length&&(e("#search_hits").text(TX.tx("$1 of $2 found",R+1,r.length)),e(r[R]).addClass("picked-hit").parents(".tree-collection").each(function(){e(this).tree("open")}),e(r[R]).scroll_into_view(),R=(R+1)%r.length)},t.insert_data=function(e,o){t.alert({title:"Loading"}),X.hoard.actions_from_hierarchy({data:o},function(o,r){o.path=e.slice().concat(o.path),o=this.push_action(o);var n=this.play_action(o,function(e){C.action(e,null,r)});null!==n&&t.alert({severity:"notice",message:n.message}),r&&r()},null,function(){Utils.sometime("update_save"),t.alert({severity:"notice",message:TX.tx("JSON has been loaded")})})},t.getClient=function(){return X},t.getCloud=function(){return G},t.playAction=function(e,o){e=X.hoard.push_action(e);var r=X.hoard.play_action(e,function(e){C.action(e,t.pushUndo,function(e){o&&o(e),Utils.sometime("update_save")})});null!==r&&t.alert({title:TX.tx("Error"),severity:"error",message:r.message})},t.pushUndo=function(){F.push(Hoard.new_action.apply(null,arguments))},t.can_undo=function(){return 0!==F.length},t.undo=function(){global.DEBUG&&F.length;var o=F.pop();o.time=Date.now(),global.DEBUG&&console.debug("Undo "+Hoard.stringify_action(o)),X.hoard.pop_action();var r=X.hoard.play_action(o,function(o){C.action(o,null,function(){0===F.length&&X.status===t.IS_LOADED&&e(".tree-modified").removeClass("tree-modified"),Utils.sometime("update_save")})});null!==r&&t.alert({title:TX.tx("Error"),severity:"error",message:r.message})},console.debug("Loading Squirrel.js"),e(function(){console.debug("Squirrel.js .ready");var o=Utils.parse_query_params();global.URLPARAMS=o,o.debug&&(global.DEBUG=!0,console.log("Debug enabled"),e.isTouchCapable&&e.isTouchCapable()&&console.log("Device is touch-capable")),global.DEBUG&&console.log("Device is "+window.screen.width+" X "+window.screen.height+" Body is "+e("body").width()+" X "+e("body").height()),global.DEBUG&&o.dumpcloud&&(k=!0),global.DEBUG||e.ajaxSetup({cache:!0});var r=Cookies.get("ui_theme");r&&"base"!==r&&t.theme(r);var n=Cookies.get("ui_scale");n&&n>0&&t.scale(n);var a="undefined"!=typeof UNMINIFIED&&UNMINIFIED?".js":".min.js",i=o.store||"TestStore",s=["js/"+i+a];void 0!==o.steg&&(U=!0),U?(s.push("js/Steganographer"+a),s.push("js/StegaStore"+a)):e(".using_steganography").remove(),Utils.load(s,function(){TX.init(function(){S(),T()})},function(t){var o=TX.tx("Javascript module load failed");for(var r in t)o=o+"<div>"+r+": "+t[r]+"</div>";e("#init_error").html(o).show()})})}(jQuery,Squirrel);