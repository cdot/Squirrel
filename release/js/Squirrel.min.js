/*@preserve  AES implementation in JavaScript                     (c) Chris Veness 2005-2014 / MIT Licence */
"use strict";function RGBA(t,e,a,n){function r(t,e){if(/%\s*$/.test(t)){return parseFloat(t)*e/100}return parseFloat(t)}if(1!==arguments.length)return this.r=t,this.g=e,this.b=a,void(this.a=n);{if("string"==typeof t){if("string"==typeof t){var o=CSSColours[t.toLowerCase()];if(void 0!==o&&(t=o),"#"==t.charAt(0))return this.r=parseInt(t.substr(1,2),16)/255,this.g=parseInt(t.substr(3,2),16)/255,void(this.b=parseInt(t.substr(5,2),16)/255);if(/^hsla?\(.*\)$/.test(t)){n=t.replace(/(hsla?\(|\))/g,"").split(/[,\s]+/);var i=RGBA.fromHSL(r(n[0],360),r(n[1],1),r(n[2],1),n.length>3?r(n[3],1):void 0);return this.r=i.r,this.g=i.g,this.b=i.b,void(this.a=i.a)}if(/^rgba?\(.*\)$/.test(t))return n=t.replace(/(rgba?\(|\))/g,"").split(","),this.r=Math.floor(r(n[0],255))/255,this.g=Math.floor(r(n[1],255))/255,this.b=Math.floor(r(n[2],255))/255,void(n.length>3&&(this.a=r(n[3],1)))}throw"object"==typeof t&&"RGBA"===t.constructor.name&&jQuery.extend(this,t),"Cannot construct from "+typeof t}if("Array"===t.constructor.name)this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3];else{if("number"!=typeof t.r||"number"!=typeof t.g||"number"!=typeof t.b)throw"Don't know how to make an RGBA from this";this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}}}/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function AbstractStore(t){t.ok.call(this)}function LayeredStore(t){var e=this,a=t.ok;t.ok=function(){e.engine=this,a.call(e)},t.understore(t)}/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function LocalStorageStore(t){if(t.user)this.user(t.user);else{for(var e,a=0,n=null;null!=(e=localStorage.key(a));){var r=/^Squirrel\.(.*)$/.exec(e);if(r){if(n){n=null;break}n=r[1]}a++}n&&this.user(n)}AbstractStore.call(this,t)}/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function EncryptedStore(t){LayeredStore.call(this,t)}function Hoard(t){if(t.version=t.version||1,t.version>VERSION)throw"Hoard error: cannot read a version "+t.version+" hoard with "+VERSION+" code";t?(this.last_sync=t.last_sync,this.actions=t.actions,this.cache=t.cache,this.options=t.options,this.version=t.version):(this.last_sync=null,this.clear_actions(),this.cache=null),void 0===this.options&&(this.options={autosave:!1,store_path:null})}var Aes={};Aes.cipher=function(t,e){for(var a=e.length/4-1,n=[[],[],[],[]],r=0;r<16;r++)n[r%4][Math.floor(r/4)]=t[r];n=Aes.addRoundKey(n,e,0,4);for(var o=1;o<a;o++)n=Aes.subBytes(n,4),n=Aes.shiftRows(n,4),n=Aes.mixColumns(n,4),n=Aes.addRoundKey(n,e,o,4);n=Aes.subBytes(n,4),n=Aes.shiftRows(n,4),n=Aes.addRoundKey(n,e,a,4);for(var i=new Array(16),r=0;r<16;r++)i[r]=n[r%4][Math.floor(r/4)];return i},Aes.keyExpansion=function(t){for(var e=t.length/4,a=e+6,n=new Array(4*(a+1)),r=new Array(4),o=0;o<e;o++){var i=[t[4*o],t[4*o+1],t[4*o+2],t[4*o+3]];n[o]=i}for(var o=e;o<4*(a+1);o++){n[o]=new Array(4);for(var s=0;s<4;s++)r[s]=n[o-1][s];if(o%e==0){r=Aes.subWord(Aes.rotWord(r));for(var s=0;s<4;s++)r[s]^=Aes.rCon[o/e][s]}else e>6&&o%e==4&&(r=Aes.subWord(r));for(var s=0;s<4;s++)n[o][s]=n[o-e][s]^r[s]}return n},Aes.subBytes=function(t,e){for(var a=0;a<4;a++)for(var n=0;n<e;n++)t[a][n]=Aes.sBox[t[a][n]];return t},Aes.shiftRows=function(t,e){for(var a=new Array(4),n=1;n<4;n++){for(var r=0;r<4;r++)a[r]=t[n][(r+n)%e];for(var r=0;r<4;r++)t[n][r]=a[r]}return t},Aes.mixColumns=function(t,e){for(var a=0;a<4;a++){for(var n=new Array(4),r=new Array(4),o=0;o<4;o++)n[o]=t[o][a],r[o]=128&t[o][a]?t[o][a]<<1^283:t[o][a]<<1;t[0][a]=r[0]^n[1]^r[1]^n[2]^n[3],t[1][a]=n[0]^r[1]^n[2]^r[2]^n[3],t[2][a]=n[0]^n[1]^r[2]^n[3]^r[3],t[3][a]=n[0]^r[0]^n[1]^n[2]^r[3]}return t},Aes.addRoundKey=function(t,e,a,n){for(var r=0;r<4;r++)for(var o=0;o<n;o++)t[r][o]^=e[4*a+o][r];return t},Aes.subWord=function(t){for(var e=0;e<4;e++)t[e]=Aes.sBox[t[e]];return t},Aes.rotWord=function(t){for(var e=t[0],a=0;a<3;a++)t[a]=t[a+1];return t[3]=e,t},Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],"undefined"!=typeof module&&module.exports&&(module.exports=Aes),"function"==typeof define&&define.amd&&define([],function(){return Aes});/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
var DEBUG=!1,Utils={waiting_for_sometime:{},sometime_timeout:!0,last_yield:Date.now(),IMMEDIATE:1,SOON:100,SOMETIME:250,MSPERDAY:864e5,TIMEUNITS:{y:{days:360,ms:314496e5,format:"$1 year$?($1!=1,s,)"},m:{days:30,ms:2592e6,format:"$1 month$?($1!=1,s,)"},d:{days:1,ms:864e5,format:"$1 day$?($1!=1,s,)"}}};Utils.setUpAjax=function(t,e,a){if(window.FormData&&(t.dataType&&"binary"===t.dataType||t.data&&(window.ArrayBuffer&&t.data instanceof ArrayBuffer||window.Blob&&t.data instanceof Blob)))return{send:function(e,a){var n=new XMLHttpRequest,r=t.url,o=t.type,i=t.async||!0,s=t.responseType||"blob",l=t.data||null,u=t.username||null,d=t.password||null;n.addEventListener("load",function(){var e={};e[t.dataType]=n.response,a(n.status,n.statusText,e,n.getAllResponseHeaders())}),n.open(o,r,i,u,d);for(var c in e)n.setRequestHeader(c,e[c]);n.responseType=s,n.send(l)},abort:function(){a.abort()}}},"undefined"!=typeof jQuery&&jQuery.ajaxTransport("+binary",Utils.setUpAjax),Utils.generate_password=function(t){var e,a;void 0===t.length&&(t.length=24),void 0===t.charset&&(t.charset="A-Za-z0-9");for(var n=t.charset,r=[];n.length>0;)if(n.length>=3&&"-"===n.charAt(1))for(e=n.charCodeAt(0),a=n.charCodeAt(2),n=n.substring(3);e<=a;)r.push(String.fromCharCode(e++));else r.push(n.charAt(0)),n=n.substring(1);var o=new Uint8Array(t.length);window.crypto.getRandomValues(o);for(var i="",s=0;s<t.length;s++)i+=r[o[s]%r.length];return i},Utils.getURLParameters=function(){var t={},e=location.search.split("?",2);if(e.length<2)return t;for(var a=e[1].split(/[&;]/),n=0;n<a.length;n++){var r=decodeURIComponent(a[n].replace(/\+/g,"%20")),o=r.split("=",2);t[o[0]]=o[1]||null}},Utils.fragmentify=function(t){return t.replace(/[^A-Za-z0-9:]/g,function(t){return"_"+t.charCodeAt(0)})},Utils.sometime=function(t){Utils.waiting_for_sometime[t]||(Utils.waiting_for_sometime[t]=!0,null===Utils.sometime_timeout&&(Utils.sometime_timeout=window.setTimeout(Utils.sometime_is_now,Utils.SOMETIME)))},Utils.sometime_is_now=function(){Utils.sometime_timeout=null,Utils.last_yield=Date.now();for(var t in Utils.waiting_for_sometime)$(document).triggerHandler(t),delete Utils.waiting_for_sometime[t]},Utils.soon=function(t){Date.now()-Utils.last_yield>Utils.SOON?window.setTimeout(function(){Utils.last_yield=Date.now(),t()},Utils.IMMEDIATE):t()},Utils.execute_queue=function(t){Utils.q_ready(),Utils.q_next(t)},Utils.q_ready=function(){Utils.qready=!0},Utils.q_next=function(t){if(t.length>0&&Utils.qready){var e=t.shift();Utils.qready=!1,e(Utils.q_ready)}window.setTimeout(function(){Utils.last_yield=Date.now(),Utils.q_next(t)},Utils.IMMEDIATE)},Utils.load=function(t,e,a){for(var n={},r=function(t){delete n[t],0===Object.keys(n).length&&"function"==typeof a&&a()},o=0;o<t.length;o++)!function(t){e&&(t=t.replace(".min.",".")),n[t]=!0,/\.js$/.test(t)?$.getScript(t).done(function(){r(t)}).fail(function(){}):/\.css$/.test(t)?($("link").appendTo("head").attr({type:"text/css",rel:"stylesheet"}).attr("href",t),r(t)):/\.html$/.test(t)&&$.get(t).done(function(e){$(e).appendTo("body"),r(t)}).fail(function(){})}(t[o])},Utils.read_file=function(t,e,a,n){var r=new FileReader;if(r.onload=function(){e(r.result)},r.onerror=function(){a(t.name+" read failed")},r.onabort=r.onerror,void 0===n||"text"===n)r.readAsText(t);else if("arraybuffer"===n)r.readAsArrayBuffer(t);else if("binarystring"===n)r.readAsBinaryString(t);else{if("datauri"!==n)throw"Unrecognised mode "+n;r.readAsDataURL(t)}},Utils.ArrayBufferToString=function(t){for(var e=new Uint16Array(t),a="",n=0;n<e.length;n++)a+=String.fromCharCode(e[n]);return a},Utils.StringToArrayBuffer=function(t){for(var e=new Uint16Array(t.length),a=0,n=t.length;a<n;a++)e[a]=t.charCodeAt(a);return e.buffer},Utils.ArrayBufferToPackedString=function(t){for(var e=new Uint8Array(t),a=0!=(1&e.length)?256:0,n=!0,r="",o=e.length,i=0;i<o;i++)n?(r+=String.fromCharCode(a|e[i]),n=!1):(a=e[i]<<8,n=!0);return n&&(r+=String.fromCharCode(a)),r},Utils.PackedStringToArrayBuffer=function(t){var e=2*t.length-1;0==(256&t.charCodeAt(0))&&e--;for(var a=!0,n=new Uint8Array(e),r=0,o=0;o<e;)a?(n[o++]|=255&t.charCodeAt(r++),a=!1):(n[o++]=t.charCodeAt(r)>>8&255,a=!0);return n.buffer},Utils.ArrayBufferToBase64=function(t){for(var e=new Uint8Array(t),a=2,n="",r=e.length,o=function(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65},i=0,s=0;s<r;s++)a=s%3,i|=e[s]<<(16>>>a&24),2!==a&&r-s!=1||(n+=String.fromCharCode(o(i>>>18&63),o(i>>>12&63),o(i>>>6&63),o(63&i)),i=0);return n.substr(0,n.length-2+a)+(2===a?"":1===a?"=":"==")},Utils.Base64ToArrayBuffer=function(t){for(var e,a,n=t.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,o=3*r+1>>2,i=new Uint8Array(o),s=0,l=0,u=0;u<r;u++)if(a=3&u,s|=function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0}(n.charCodeAt(u))<<6*(3-a),3===a||r-u==1){for(e=0;e<3&&l<o;e++,l++)i[l]=s>>>(16>>>e&24)&255;s=0}return i.buffer},Utils.query_string=function(){for(var t={},e=window.location.search.substring(1).split(/[&;]+/),a=0;a<e.length;a++)if(""!==e[a]){var n=e[a].split("=");if(void 0===t[n[0]])t[n[0]]=decodeURIComponent(n[1]);else if("string"==typeof t[n[0]]){var r=[t[n[0]],decodeURIComponent(n[1])];t[n[0]]=r}else t[n[0]].push(decodeURIComponent(n[1]))}return t},Utils.make_query_string=function(t){var e="",a="?";for(var n in t)e+=a+encodeURIComponent(n)+"="+encodeURIComponent(t[n]),a="&";return e},Utils.deltaTimeString=function(t){t=new Date(t.getTime()-Date.now());var e=[],a=t.getUTCFullYear()-1970;return a>0&&e.push(TX.tx(Utils.TIMEUNITS.y.format,a)),t.setUTCFullYear(1970),a=t.getUTCMonth(),a>0&&e.push(TX.tx(Utils.TIMEUNITS.m.format,a)),t.setUTCMonth(0),a=t.getUTCDate(),(a>0||0===e.length)&&e.push(TX.tx(Utils.TIMEUNITS.d.format,a)),e.join(" ")},"undefined"!=typeof module&&(module.exports=Utils);/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
const CSSColours={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};RGBA.prototype.inverse=function(){return new RGBA(1-this.r,1-this.g,1-this.b,this.a)},RGBA.prototype.complement=function(){var t=this.toHSV();return RGBA.fromHSV((t[0]+180)%360,t[1],t[2],this.a)},RGBA.prototype.luma=function(){return.2126*this.r+.7152*this.g+.0722*this.b},RGBA.prototype.toString=function(){var t=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)];if(void 0!==this.a)return t.push(this.a),"rgba("+t.join(",")+")";for(var e="#",a=0;a<3;a++){var n=t[a].toString(16);e+=1==n.length?"0"+n:n}return e.toUpperCase()},RGBA.prototype.toHSV=function(){var t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b),a=t-e,n=t,r=0==n?0:a/n,o=0;0!=a&&(o=this.r===t?(this.g-this.b)/a%6*60:this.g===t?60*((this.b-this.r)/a+2):60*((this.r-this.g)/a+4))<0&&(o+=360);var i=[o,r,n];return void 0!==this.a&&i.push(this.a),i},RGBA.prototype.toHSL=function(){var t,e,a,n=Math.max(this.r,this.g,this.b),r=Math.min(this.r,this.g,this.b),o=n-r;0==o?(t=e=0,a=n):(a=(n+r)/2,e=o/(a>.5?2-n-r:n+r)),0!=o&&(t=this.r===n?(this.g-this.b)/o%6*60:this.g===n?60*((this.b-this.r)/o+2):60*((this.r-this.g)/o+4))<0&&(t+=360);var i=[t,e,a];return void 0!==this.a&&i.push(this.a),i},RGBA.fromHSV=function(t,e,a,n){var r,o,i;if(1===arguments.length&&(n=t[3],a=t[2],e=t[1],t=t[0]),0==e)r=o=i=a;else{t/=60;var s=Math.floor(t),l=t-s,u=a*(1-e),d=a*(1-e*l),c=a*(1-e*(1-l));switch(s){case 0:r=a,o=c,i=u;break;case 1:r=d,o=a,i=u;break;case 2:r=u,o=a,i=c;break;case 3:r=u,o=d,i=a;break;case 4:r=c,o=u,i=a;break;default:r=a,o=u,i=d}}return new RGBA(r,o,i,n)},RGBA.fromHSL=function(t,e,a,n){function r(t,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+6*(e-t)*a:a<.5?e:a<2/3?t+(e-t)*(2/3-a)*6:t}var o,i,s;if(1===arguments.length&&(n=t[3],a=t[2],e=t[1],t=t[0]),0==e)o=i=s=a;else{t/=360;var l=a<.5?a*(1+e):a+e-a*e,u=2*a-l;o=r(u,l,t+1/3),i=r(u,l,t),s=r(u,l,t-1/3)}return new RGBA(o,i,s,n)},"undefined"!=typeof module&&(module.exports=RGBA);/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
var TX={lingo:void 0,langFromLocale:function(){TX.lingo=window.navigator.userLanguage||window.navigator.language||"en"},translations:null,clean:function(t){return t.replace(/\s+/g," ").replace(/^ /,"").replace(/ $/,"")},init:function(t){if(TX.lingo||TX.langFromLocale(),/^en(\b|$)/i.test(TX.lingo))return void t();$.ajax("locale/"+TX.lingo+".json",{success:function(e){TX.translations=e,$("body").each(function(){TX.translateDOM(this,TX.tx,!1)}),t()},error:function(e,a,n){var r=/^(.+)-.+/.exec(TX.lingo);TX.lingo=r?r[1]:"en",TX.init(t)}})},translateDOM:function(t,e,a){function n(t,e){return(" "+t.className+" ").replace(/\s+/g," ").indexOf(" "+e+" ")>=0}var r;if(3==t.nodeType)a&&/\S/.test(t.nodeValue)&&void 0!==(r=e(t.nodeValue))&&(t.nodeValue=r);else if((a||n(t,"TX_title"))&&(r=t.title)&&void 0!==(r=e(r))&&(t.title=r),n(t,"TX_html"))void 0!==(r=e(t.innerHTML))&&(t.innerHTML=r);else{n(t,"TX_text")&&(a=!0);for(var o=0,i=t.childNodes.length;o<i;++o)TX.translateDOM(t.childNodes[o],e,a)}},tx:function(s){var tx,i;for(null!==TX.translations&&void 0!==(tx=TX.translations[TX.clean(s)])&&(s=tx.s),i=arguments.length-1;i>0;i--)s=s.replace(new RegExp("\\$"+i,"g"),arguments[i]);return s=s.replace(/\$\?\((.*?),(.*?),(.*?)\)/g,function(m,test,pass,fail){var result=!1;return eval("result=("+test+")"),result?pass:fail})}};"undefined"!=typeof module&&(module.exports=TX),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(t){t.widget("squirrel.twisted",{_create:function(){function e(){n.hasClass("twisted-shut")?a.open():a.close()}var a=this,n=a.element,r=t("<button></button>").addClass("twisted-button twisted-title").button({icon:"ui-icon-info",showLabel:!1});0===n.children(".twisted-title:first").detach().insertBefore(n).prepend(r).on("click",e).length&&r.insertBefore(n).on("click",e),n.data("twisted-button",r),a.close()},open:function(){var t=this.element.data("close")||"ui-icon-circle-minus";this.element.removeClass("twisted-shut").show().data("twisted-button").button("option","icon",t)},close:function(){var t=this.element.data("open")||"ui-icon-circle-plus";this.element.addClass("twisted-shut").hide().data("twisted-button").button("option","icon",t)}})}(jQuery),/*@preserve Copyright (C) 2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(t){t.widget("squirrel.template",{_create:function(){this.element.hasClass("pick-one")&&this.element.children().hide().first().show()},pick:function(t){this.element.children().hide();var e=this.element.children("[data-id='"+t+"']");return e.show(),e},expand:function(){var t=this.element.data("raw-template");t||this.element.data("raw-template",t=this.element.html());var e;e="object"==typeof arguments[0]?arguments[0]:arguments,t=t.replace(/\$(\d+)/g,function(t,a){var n=parseInt(a);return e[n-1]}),this.element.html(t)}})}(jQuery),AbstractStore.NODATA="not found",AbstractStore.prototype.options=function(){return{identifier:"Unknown"}},AbstractStore.prototype.user=function(t){return void 0!==t&&(this.suser=t),this.suser},AbstractStore.prototype.pass=function(t){return 1===arguments.length&&void 0!==t&&(this.spass=t),this.spass},AbstractStore.prototype.write=function(t,e,a,n){n.call(this,"Store has no write method")},AbstractStore.prototype.writes=function(t,e,a,n){this.write(t,Utils.StringToArrayBuffer(e),a,n)},AbstractStore.prototype.read=function(t,e,a){a.call(this,"Store has no read method")},AbstractStore.prototype.reads=function(t,e,a){var n=this;this.read(t,function(t){var r;try{r=Utils.ArrayBufferToString(t)}catch(t){return void a.call(n,t)}e.call(n,r)},a)},LayeredStore.prototype=Object.create(AbstractStore.prototype),LayeredStore.prototype.options=function(){return this.engine.options()},LayeredStore.prototype.user=function(t){return this.engine.user(t)},LayeredStore.prototype.pass=function(t){return this.engine.pass(t)},LocalStorageStore.prototype=Object.create(AbstractStore.prototype),LocalStorageStore.prototype.options=function(){return $.extend(AbstractStore.prototype.options(),{needs_path:!0,identifier:"browser"})},LocalStorageStore.prototype.read=function(t,e,a){var n;try{n=localStorage.getItem(t)}catch(t){return void a.call(this,t)}if(null===n)a.call(this,AbstractStore.NODATA);else{var r=Utils.PackedStringToArrayBuffer(n);e.call(this,r)}},LocalStorageStore.prototype.write=function(t,e,a,n){try{var r=Utils.ArrayBufferToPackedString(e);localStorage.setItem(t,r)}catch(t){return void n.call(this,t)}a.call(this)};/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
var AES={};AES.encrypt=function(t,e,a){for(var n=new Uint8Array(t),r=a/8,o=new Array(r),i=0;i<r;i++)i<e.length?o[i]=255&e.charCodeAt(i):o[i]=0;var s=Aes.cipher(o,Aes.keyExpansion(o));s=s.concat(s.slice(0,r-16));var l=new Uint8Array(8),u=8,d=Date.now(),c=d%1e3,h=d/1e3>>0,f=65535*Math.random()>>0;for(i=0;i<2;i++)l[i]=c>>>8*i&255;for(i=0;i<2;i++)l[i+2]=f>>>8*i&255;for(i=0;i<4;i++)l[i+4]=h>>>8*i&255;for(var p=Aes.keyExpansion(s),g=Math.ceil(n.length/16),v=new Array(g),m=0;m<g;m++){for(var y=0;y<4;y++)l[15-y]=m>>>8*y&255;for(y=0;y<4;y++)l[15-y-4]=m/4294967296>>>8*y;var _=Aes.cipher(l,p),A=m<g-1?16:(n.length-1)%16+1,b=new Uint8Array(A);for(u+=A,i=0;i<A;i++)_[i],b[i]=_[i]^n[16*m+i];v[m]=b}var T=new Uint8Array(u);T.set(l);var k=l.length;for(m=0;m<g;m++)T.set(v[m],k),k+=v[m].length;return T},AES.decrypt=function(t,e,a){for(var n=new Uint8Array(t),r=a/8,o=new Uint8Array(r),i=0;i<r;i++)i<e.length?o[i]=255&e.charCodeAt(i):o[i]=0;var s=Aes.cipher(o,Aes.keyExpansion(o));s=s.concat(s.slice(0,r-16));var l=new Uint8Array(8);for(i=0;i<8;i++)l[i]=n[i];for(var u=Aes.keyExpansion(s),d=Math.ceil((n.length-8)/16),c=new Array(d),h=8,f=0;f<d;f++)c[f]=n.subarray(h,h+16),h+=16;var p=new Array(d),g=0;for(f=0;f<d;f++){for(var v=0;v<4;v++)l[15-v]=f>>>8*v&255;for(v=0;v<4;v++)l[15-v-4]=(f+1)/4294967296-1>>>8*v&255;var m=Aes.cipher(l,u),y=c[f].length,_=new Uint8Array(y);for(i=0;i<y;i++)_[i]=m[i]^c[f][i];p[f]=_,g+=y}var A=new Uint8Array(g);for(h=0,f=0;f<d;f++)A.set(p[f],h),h+=p[f].length;return A},EncryptedStore.prototype=Object.create(LayeredStore.prototype),EncryptedStore.prototype.options=function(){return $.extend(LayeredStore.prototype.options.call(this),{needs_pass:!0})},EncryptedStore.prototype.read=function(t,e,a){var n=this;this.engine.read(t,function(t){var r;try{r=AES.decrypt(t,n.engine.pass(),256)}catch(t){return void a.call(n,t)}e.call(n,r.buffer)},a)},EncryptedStore.prototype.write=function(t,e,a,n){var r,o=this;try{r=AES.encrypt(e,this.engine.pass(),256)}catch(t){return void n.call(this,t)}this.engine.write(t,r.buffer,function(){a.call(o)},n)};/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
const VERSION=2;Hoard.stringify_action=function(t){return t.type+":"+t.path.join("/")+(void 0!==t.data?" '"+t.data+"'":"")+" @"+new Date(t.time).toLocaleString()},Hoard.prototype.clear_actions=function(){this.actions=[]},Hoard.prototype.record_action=function(t,e,a){function n(t,e){for(var a=0;a<t.length-1;a++){var n=t[a];if(e&&"string"==typeof e.data);else{if(!e||!e.data[n])return;e=e.data[n]}}return e}function r(e){return{conflict:t,message:e}}void 0!==t.time&&null!==t.time||(t.time=Date.now()),a||this.actions.push({type:t.type,path:t.path.slice(),time:t.time,data:t.data});var o=n(t.path,this.cache);o||this.cache||(o=this.cache={data:{}});var i=t.path[t.path.length-1],s=o.data[i];switch(t.type){case"N":if(!o)return r(TX.tx("Cannot create")+" '"+t.path.join("/")+"': "+TX.tx("Folder not found"));if(s)return r(TX.tx("Cannot create")+" '"+t.path.join("/")+"': "+TX.tx("It already exists"));o.time=t.time,o.data[i]={time:t.time,data:"string"==typeof t.data?t.data:{}};break;case"M":if(!s)return r(TX.tx("Cannot move")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));if(t.data.length>0){var l,u=n(t.data,this.cache);u&&(l=u.data[t.data[t.data.length-1]])}else l=this.cache;if(!l)return r(TX.tx("Cannot move")+" '"+t.data.join("/")+"': "+TX.tx("New folder does not exist"));l.time=o.time=t.time,delete o.data[i],l.data[i]=s;break;case"D":if(!s)return r(TX.tx("Cannot delete")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));if(!o)return r(TX.tx("Cannot delete")+" '"+t.path.join("/")+"': "+TX.tx("Folder not found"));delete o.data[i],o.time=t.time;break;case"R":if(!o.data[i])return r(TX.tx("Cannot rename")+" '"+t.path.join("/")+"' "+TX.tx("It does not exist"));if(o.data[t.data])return r(TX.tx("Cannot rename")+" '"+t.data.join("/")+"': "+TX.tx("It already exists"));o.data[t.data]=o.data[i],delete o.data[i],o.time=t.time;break;case"E":if(!o.data[i])return r(TX.tx("Cannot change value of")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));o.data[i].data=t.data,o.data[i].time=t.time;break;case"A":if(!o.data[i])return r(TX.tx("Cannot set reminder on")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));t.data?o.data[i].alarm=t.data:delete o.data[i].alarm;break;case"C":if(!o.data[i])return r(TX.tx("Cannot cancel reminder on")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));delete o.data[i].alarm;break;case"X":if(!o.data[i])return r(TX.tx("Cannot constrain")+" '"+t.path.join("/")+"': "+TX.tx("It does not exist"));t.data?o.data[i].constraints=t.data:delete o.data[i].constraints}return e&&e.call(this,t),null},Hoard.prototype.simplify=function(t){if(this.cache=null,this.actions)for(var e=0;e<this.actions.length;e++){this.record_action(this.actions[e],!1,!0)}this.actions=[],this.cache?(this._reconstruct_actions(this.cache.data,[],function(t){this.actions.push({type:t.type,time:t.time,data:t.data,path:t.path.slice()})},t),this.cache=null):t&&t()},Hoard.prototype._reconstruct_actions=function(t,e,a,n){function r(t,e,n){if(0===e.length)return void n();var r=void 0!==t.time?t.time:Date.now(),o={type:"N",path:e,time:r};"string"==typeof t.data&&(o.data=t.data),a.call(i,o,function(){t.alarm&&a.call(i,{type:"A",path:e.slice(),time:r,data:t.alarm}),t.constraints&&a.call(i,{type:"X",path:e.slice(),time:r,data:t.constraints}),n()})}function o(t,e,a){var n,i;if(t.push(function(t){r(e,a,t)}),"object"==typeof e.data)for(n in e.data)i=a.slice(),i.push(n),o(t,e.data[n],i)}var i=this,s=[];o(s,t,e.slice()),s.push(n),Utils.execute_queue(s)},Hoard.prototype.actions_from_hierarchy=function(t,e,a){this._reconstruct_actions(t,[],e,a)},Hoard.prototype.reconstruct_actions=function(t,e){this.cache?this.actions_from_hierarchy(this.cache,t,e):e()},Hoard.prototype.merge_from_cloud=function(t,e,a){var n,r,o=this.actions,i=[];for(this.actions=[],n=0;n<t.actions.length;n++)t.actions[n].time>this.last_sync&&null!==(r=this.record_action(t.actions[n],e,!0))&&i.push(r);this.actions=o,this.last_sync=Date.now(),a&&a(i)},Hoard.prototype.dump=function(){for(var t=this.JSON()+"\n",e=0;e<this.actions.length;e++)t=t+Hoard.stringify_action(this.actions[e])+"\n";return t},Hoard.prototype.get_node=function(t){var e,a=this.cache;for(e=0;e<t.length;e++){if("string"==typeof a.data)return null;a=a.data[t[e]]}return a},Hoard.prototype.each_alarm=function(){for(var t=this,e=function(){t.each_alarm()};this.check&&this.check.queue.length>0;){var a,n=this.check.queue.pop(),r=n.node;if("object"==typeof r.data)for(a in r.data){var o=r.data[a];this.check.queue.push({node:o,path:n.path.slice().concat([a])})}if(void 0!==r.alarm&&Date.now()-r.time>=r.alarm*Utils.MSPERDAY)return void this.check.alarm(n.path,new Date(r.time+r.alarm*Utils.MSPERDAY),e)}delete this.check},Hoard.prototype.check_alarms=function(t){this.cache&&(this.check={queue:[{path:[],node:this.cache}],alarm:t},this.each_alarm())},Hoard.prototype.JSON=function(){var t="";return this.cache&&(t=JSON.stringify(this.cache.data,null,"\t")),t},"undefined"!=typeof module&&(module.exports=Hoard),/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function(t){t.fn.edit_in_place=function(e){function a(){l.remove(),n.show(),s()}var n=t(this),r=e.height||n.height(),o=e.width||n.width(),i=e.changed||function(){return n.text()},s=e.closed||function(){},l=t("<input/>"),u=e.text||n.text();n.hide(),l.insertBefore(n).addClass("in_place_editor").val(u).css("height",r).css("width",o).on("change",function(){var e=t(this).val();a(),e!==u&&(u=i.call(n,e))}).on("keydown",function(e){return 27!==e.keyCode&&(13!==e.keyCode||t(this).val()!==u)||(a(),!1)}).blur(a).select()}}(jQuery),/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function(t){t.fn.scroll_into_view=function(){return this.each(function(){var e=t(this).offset().top-t(window).scrollTop();return!(e>window.innerHeight)||(t("html,body").animate({scrollTop:e-16},500),!1)})}}(jQuery);/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
var Squirrel={PATHSEP:String.fromCharCode(1),NEW_SETTINGS:"has new settings",IS_LOADED:"is loaded",IS_CORRUPT:"is corrupt",IS_EMPTY:"is empty"};!function(t,e){function a(){var a=t("body"),n=t("<div></div>").addClass("ui-widget").addClass("ui-widget-content").hide();a.append(n);var r=n.css("background-color"),o="body {";for(var i in{font:0,color:0,"background-color":0}){o+=i+": "+n.css(i)+";\n"}o+="}",n.remove();var s=r&&"transparent"!=r&&new RGBA(r).luma()<.65;if(e.bright&&!s||!e.bright&&s){for(var l=0;l<document.styleSheets.length;l++){var u=document.styleSheets[l];if(u){var d=u.rules||u.cssRules;if(d)for(var c=0;c<d.length;c++){var h=d[c];if(/\.[-:a-z0-9]*$/i.test(h.selectorText)){var f,p="";if(h.style.color)try{f=new RGBA(h.style.color),p+="color: "+f.inverse().toString()+";\n"}catch(t){}if(h.style.backgroundColor)try{f=new RGBA(h.style.backgroundColor),p+="background-color: "+f.inverse().toString()+";\n"}catch(t){}p.length>0&&(o+=h.selectorText+"{"+p+"}\n")}}}}e.bright=s}t("#computed-styles").remove(),o="<style id='computed-styles'>"+o+"</style>",a.append(o)}function n(){E.hoard.check_alarms(function(t,a,n){T.getNodeFromPath(t).tree("ringAlarm"),e.squeak({severity:"warning",message:"<div class='ui-icon ui-icon-squirrel-rang'></div>"+TX.tx("Reminder on '$1' was due on $2",t.join("/"),a.toLocaleDateString()),after_close:n})})}function r(a,n){E.hoard.merge_from_cloud(a,T.action,function(a){a.length>0&&(e.squeak({title:TX.tx("Warning"),severity:"warning",message:TX.tx("Conflicts were detected while merging actions from the Cloud.")+" "+TX.tx("Please review these rejected actions before saving.")}),t.each(a,function(e,a){var n=a.conflict;t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"warning",message:Hoard.stringify_action(n)+": "+a.message})})),S.status=e.IS_LOADED,n()})}function o(a){var n=[];if(t(".tree-modified").each(function(){var a=t(this).data("path")||"node";n.push(TX.tx("$1 has changed",a.replace(e.PATHSEP,"/")))}),n.length>a){var r=n.length;n=n.slice(0,a),n.push(TX.tx("... and $1 more change$?($1!=1,s,)",r-5))}return S.status!==e.IS_LOADED&&n.unshift(TX.tx("The $1 hoard $2",S.store?S.store.options().identifier:TX.tx("Cloud"),TX.tx(S.status))),E.status!==e.IS_LOADED&&n.unshift(TX.tx("The $1 hoard $2",E.store.options().identifier,TX.tx(E.status))),0===n.length?null:n.join("\n")}function i(){function a(){Utils.sometime("update_save"),d&&c?E.hoard.options.autosave?t("#squeak_dlg").squirrelDialog("close"):t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("Save complete")):(t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"error",message:TX.tx("Save encountered errors")}),E.hoard.options.autosave=!1)}function n(){E.store.writes("S."+E.store.user(),JSON.stringify(E.hoard),function(){t(".tree-modified").removeClass("tree-modified"),E.status=e.IS_LOADED,t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("Saved in $1",this.options().identifier)),a()},function(e){t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"error",message:TX.tx("Failed to save in $1: $2",this.options().identifier,e)}),d=!1,a()})}function r(){if(E.status===e.IS_LOADED&&0===t(".tree-modified").length)return void a();E.status=e.PENDING_SAVE,t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"while",message:TX.tx("Saving in $1",E.store.options().identifier)}),Utils.soon(n)}function o(a){S.store.writes(E.hoard.options.store_path,JSON.stringify(a),function(){E.hoard.actions=[],E.hoard.last_sync=Date.now(),t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("Saved in $1",this.options().identifier)),S.status=e.IS_LOADED,r()},function(e){t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"error",message:TX.tx("Failed to save in $1: $2",this.options().identifier,e)}),c=!1,r()})}function i(a){a.actions=a.actions.concat(E.hoard.actions),S.store?(t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"while",message:TX.tx("Saving in $1",S.store.options().identifier)}),S.status=e.PENDING_SAVE,Utils.soon(function(){o(a)})):r()}function s(){var t=new Hoard;E.hoard.reconstruct_actions(function(e,a){t.actions.push({type:e.type,time:e.time,data:e.data,path:e.path.slice()}),a&&a()},function(){i(t)})}function l(a){var n;try{n=new Hoard(JSON.parse(a)),S.status=e.IS_LOADED}catch(a){return t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"error",message:TX.tx("$1 hoard can't be read for update",this.options().identifier)}),S.status=e.IS_CORRUPT,c=!1,void s()}S.status===e.IS_LOADED&&E.hoard.merge_from_cloud(n,T.action),S.status!==e.IS_LOADED||0!==E.hoard.actions.length?i(n):Utils.soon(r)}function u(a){a===AbstractStore.NODATA?(S.status=e.IS_EMPTY,s()):(t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"error",message:TX.tx("Failed to refresh from $1: $2",this.options().identifier,a)}),c=!1,Utils.soon(r))}e.squeak({title:TX.tx("Saving")});var d=!0,c=!0;S.status===e.NEW_SETTINGS||S.status===e.IS_EMPTY?s():S.store.reads(E.hoard.options.store_path,l,u)}function s(){t("#undo_button").toggle(e.can_undo());var a=o(3),n=t("#save_button");null!==a?E.hoard.options.autosave?i():(n.attr("title",TX.tx("Save is required because")+": "+a),n.show()):n.hide()}function l(){t("#whoami").text(E.store.user()),t("#unauthenticated").hide(),t("#authenticated").show(),Utils.sometime_is_now()}function u(){t(window).on("beforeunload",function(){var t=o(10);if(null!==t)return t=TX.tx("You have unsaved changes")+"\n"+t+"\n"+TX.tx("Are you really sure?")}),Utils.sometime("update_save"),Utils.sometime("check_alarms"),l()}function d(){S.store?(t("#progress").text(TX.tx("Reading from cloud...")),S.store.reads(E.hoard.options.store_path,function(t){var a;try{a=JSON.parse(t)}catch(t){return e.squeak({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 hoard exists, but can't be read.",this.options().identifier)+" "+TX.tx("Check that you have the correct password.")}),S.status=e.IS_CORRUPT,void Utils.soon(u)}r(new Hoard(a),u)},function(a){a===AbstractStore.NODATA?S.status=e.IS_EMPTY:(e.squeak({title:TX.tx("Error"),severity:"error",message:TX.tx("Could not load cloud hoard.")}),t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("Check that you have the correct password."))),Utils.soon(u)})):u()}function c(){E.hoard=new Hoard,E.status=e.IS_EMPTY,S.store&&S.store.options().needs_path?t("#store_settings_dlg").squirrelDialog("open",d):d()}function h(){function a(){t("#progress").text(TX.tx("Building UI..."));var e=0;E.hoard.reconstruct_actions(function(a,n){t("#percent").text(e++),T.action(a,!1,n)},function(){t(".tree-modified").removeClass("tree-modified");var e,a,n,r=E.hoard.actions;for(e=0;e<r.length;e++)for(a=r[e].path.slice();a.length>0;){if(n=T.getNodeFromPath(a)){n.addClass("tree-modified");break}a.pop()}Utils.soon(d)})}t("#progress").text(TX.tx("Reading from client...")),E.store.reads("S."+E.store.user(),function(n){try{E.hoard=new Hoard(JSON.parse(n)),E.status=e.IS_LOADED}catch(a){return e.squeak({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 hoard exists, but can't be read.",this.options().identifier),after_close:function(){Utils.sometime("init_application")}}),void t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("Check that you have the correct password."))}(E.store&&E.store.options().needs_path||S.store&&S.store.options().needs_path)&&!E.hoard.options.store_path?t("#store_settings_dlg").squirrelDialog("open",a):a()},function(t){t===AbstractStore.NODATA?Utils.soon(c):e.squeak({title:TX.tx("Error"),severity:"error",message:TX.tx("$1 store error: $2",this.options().identifier,t),after_close:function(){Utils.sometime("init_application")}})})}function f(){var e=!0,a=!0;t("#progress").text(TX.tx("Authentication...")),S.store&&void 0!==S.store.user()?(E.store.user(S.store.user()),e=!1):E.store&&void 0!==E.store.user()&&(S.store&&S.store.user(E.store.user()),e=!1),S.store&&void 0!==S.store.pass()?(E.store&&E.store.pass(S.store.pass()),a=!1):E.store&&void 0!==E.store.pass()&&(S.store&&S.store.pass(E.store.pass()),a=!1),e||a?t("#login_dlg").squirrelDialog("open",{store:E.store,on_signin:function(t,e){E.store.user(t),E.store.pass(e),S.store&&(S.store.user(t),S.store.pass(e)),h()},user_required:e,pass_required:a}):h()}function p(){new EncryptedStore({understore:function(t){return new LocalStorageStore(t)},ok:function(){E.store=this,Utils.soon(f)},fail:function(t){e.squeak({title:TX.tx("Error"),severity:"error",message:TX.tx("Encryption error: $1",t)})}})}function g(){var a={ok:function(){S.store=this,Utils.soon(p)},fail:function(a){e.squeak({title:TX.tx("Warning"),severity:"warning",message:TX.tx("Could not open cloud store: $1",a),after_close:function(){p()}}),t("#squeak_dlg").squirrelDialog("squeakAdd",{severity:"warning",message:TX.tx("If you continue, only the client store will be available")})}};return a.understore=function(t){return w?(t.understore=function(t){return new SQUIRREL_STORE(t)},new StegaStore(t)):new SQUIRREL_STORE(t)},new EncryptedStore(a)}function v(e,a){if(C>0)return!1;var n=a.target.is(".tree-node")?a.target:a.target.closest(".tree-node"),r=void 0!==n.data("alarm"),o=n.hasClass("tree-leaf"),i=a.target.closest(".tree-node").hasClass("tree-root"),s=n.hasClass("tree-open");t("body").contextmenu("showEntry","add_alarm",!r&&!i).contextmenu("showEntry","add_subtree",s&&!o).contextmenu("showEntry","add_value",s&&!o&&!i).contextmenu("showEntry","copy_value",o).contextmenu("showEntry","delete",!i).contextmenu("showEntry","edit",o).contextmenu("showEntry","insert_copy",!o&&void 0!==b).contextmenu("showEntry","make_copy",!i&&!o).contextmenu("showEntry","pick_from",o).contextmenu("showEntry","randomise",o).contextmenu("showEntry","rename",!i),k=n}function m(e,a){var n=k;if(n)switch(a.cmd){case"copy_value":b=n.data("value");break;case"make_copy":var r=n.tree("get_path"),o=E.hoard.get_node(r);b=JSON.stringify(o);break;case"insert_copy":if(b)try{var i=JSON.parse(b);t("#insert_dlg").squirrelDialog("open",{$node:n,data:i})}catch(e){}break;case"rename":n.tree("editKey");break;case"edit":n.tree("editValue");break;case"add_value":t("#add_dlg").squirrelDialog("open",{$node:n,is_value:!0});break;case"add_subtree":t("#add_dlg").squirrelDialog("open",{$node:n,is_value:!1});break;case"randomise":t("#randomise_dlg").squirrelDialog("open",{$node:n});break;case"add_alarm":t("#alarm_dlg").squirrelDialog("open",{$node:n});break;case"delete":t("#delete_dlg").squirrelDialog("open",{$node:n});break;case"pick_from":t("#pick_dlg").squirrelDialog("open",{$node:n})}}function y(){var a={delegate:".tree-title",menu:[{title:TX.tx("Copy value"),cmd:"copy_value",uiIcon:"ui-icon-squirrel-copy squirrel-icon"},{title:TX.tx("Pick characters"),cmd:"pick_from",uiIcon:"ui-icon-squirrel-pick squirrel-icon"},{title:TX.tx("Rename"),cmd:"rename",uiIcon:"ui-icon-squirrel-edit squirrel-icon"},{title:TX.tx("Edit value"),cmd:"edit",uiIcon:"ui-icon-squirrel-edit squirrel-icon"},{title:TX.tx("Add reminder"),cmd:"add_alarm",uiIcon:"ui-icon-squirrel-alarm squirrel-icon"},{title:TX.tx("Generate new random value"),cmd:"randomise",uiIcon:"ui-icon-squirrel-key squirrel-icon"},{title:TX.tx("Add new value"),cmd:"add_value",uiIcon:"ui-icon-squirrel-add-value squirrel-icon"},{title:TX.tx("Add new folder"),cmd:"add_subtree",uiIcon:"ui-icon-squirrel-add-folder squirrel-icon"},{title:TX.tx("Copy folder"),cmd:"make_copy",uiIcon:"ui-icon-squirrel-copy squirrel-icon"},{title:TX.tx("Insert copy of folder"),cmd:"insert_copy",uiIcon:"ui-icon-squirrel-paste squirrel-icon"},{title:TX.tx("Delete"),cmd:"delete",uiIcon:"ui-icon-squirrel-delete squirrel-icon"}],preventContextMenuForPopup:!0,preventSelect:!0,taphold:!0,beforeOpen:v,select:m};t("body").contextmenu(a),e.valueCopyClipboard=new Clipboard(".ui-contextmenu li[data-command='copy_value']",{text:function(){var t=k;return t.data("value")}}),e.treeCopyClipboard=new Clipboard(".ui-contextmenu li[data-command='make_copy']",{text:function(){var t=k,e=t.tree("getPath"),a=E.hoard.get_node(e);return JSON.stringify(a)}})}function _(){t("#progress").text(TX.tx("Loading application...")),g()}function A(){t("#sites-node").tree({is_root:!0,compare:e.compare}),T=t("#sites-node").data("squirrelTree"),t(".dlg-dialog").squirrelDialog({autoOpen:!1}),t(".template").template(),t(".twisted").twisted();t(".debug-only").remove(),t("#save_button").hide().on(t.getTapEvent(),function(){return i(),!1}),t("#undo_button").hide().on(t.getTapEvent(),function(){return e.undo(function(t){e.squeak({title:"Undo",message:t})}),!1}),t("#extras_button").on(t.getTapEvent(),function(){t("#extras_dlg").squirrelDialog("open")}),t("#search_input").on("change",function(){t("#search_hits").text(TX.tx("Searching...")),e.search(t(this).val())}),t("#search_button").on(t.getTapEvent(),function(){t("#search_hits").text(TX.tx("Searching...")),e.search(t("#search_input").val())}),t("button").each(function(){var e,a=t(this);if(void 0!==a.data("icon")){var n=a.data("icon");e=/squirrel/.test(n)?{icons:{primary:n},classes:{"ui-button-icon":"squirrel-icon"},text:!1}:{icon:n,text:!1}}a.button(e)}),y(),t(document).on("init_application",_).on("check_alarms",n).on("update_save",s).on("reset_styling",a),a(),Utils.sometime_is_now()}var b,T,k,w=!1,x=[],C=0,E={store:null,hoard:null,status:e.IS_EMPTY},S={store:null,status:e.IS_EMPTY},D=[TX.tx("A new folder"),TX.tx("A new value"),TX.tx("User"),TX.tx("Pass")];e.squeak=function(e){t("#squeak_dlg").squirrelDialog("open",e)},e.theme=function(e){return void 0!==e&&(t("link").filter(function(){return this.href&&this.href.indexOf("/themes/")>0}).each(function(){this.href=this.href.replace(/\/themes\/[^\/]+/,"/themes/"+e),t(this).replaceWith(t(this)),Utils.sometime("reset_styling")}),"base"===e?Cookies.remove("ui_theme"):Cookies.set("ui_theme",e)),Cookies.get("ui_theme")},e.scale=function(e){return void 0!==e&&e>6&&(t("body").css("font-size",e+"px"),Cookies.set("ui_scale",e)),Cookies.get("ui_scale")},e.zoom=function(a){var n=t("body").css("font-size");n=n.replace(/px/,""),e.scale(Math.round(a*parseInt(n)))},e.autosave=function(t){return void 0!==typeof t&&E.hoard.options.autosave!==t&&(E.hoard.options.autosave=t,Utils.sometime("update_save")),E.hoard.options.autosave},e.mask=function(t){return t.replace(/./g,".")},e.hideValues=function(a){return void 0!==a&&(a!==("on"==Cookies.get("ui_hidevalues"))&&t("#sites-node").find(".tree-value:not(:hover)").each(function(){var n=t(this).closest(".tree-node").data("value");t(this).text(a?e.mask(n):n)}),Cookies.set("ui_hidevalues",a?"on":"off")),"on"==Cookies.get("ui_hidevalues")},e.compare=function(t,e){if(t==e)return 0;for(var a=0;a<D.length;a++){if(t==D[a])return-1;if(e==D[a])return 1}return t<e?-1:1},e.enableContextMenu=function(t){t?C>0&&C--:C++},e.add_child_node=function(t,a,n){var r=t.tree("getPath");r.push(a);var o=E.hoard.record_action({type:"N",path:r,data:"string"==typeof n?n:void 0},function(t){T.action(t,!0,function(t){"string"!=typeof n&&void 0!==n&&e.insert_data(t.tree("getPath"),n),t.tree("open"),Utils.sometime("update_save")})});null!==o&&e.squeak({message:o.message})},e.search=function(a){var n;try{n=new RegExp(a,"i")}catch(t){e.squeak({message:TX.tx("Error in search expression")+" '"+a+"': "+t})}var r=[];t(".tree-node").not(".tree-root").each(function(){var e=t(this);(e.data("key").match(n)||e.hasClass("tree-leaf")&&e.data("value").match(n))&&r.push(e)}),t("#search_hits").text(TX.tx("$1 found",r.length)),0===r.length?e.squeak({message:TX.tx("'$1' not found",a)}):(t(".tree-open").not(".tree-root").each(function(){t(this).tree("close")}),t.each(r,function(e,a){a.parents(".tree-collection").each(function(){t(this).tree("open")})}))},e.insert_data=function(a,n){e.squeak({title:"Loading"}),E.hoard.actions_from_hierarchy({data:n},function(e,n){e.path=a.slice().concat(e.path);var r=E.hoard.record_action(e,function(t){T.action(t,!1,n)});null!==r&&t("#squeak_dlg").squirrelDialog("squeakAdd",r.message),n&&n()},function(){Utils.sometime("update_save"),t("#squeak_dlg").squirrelDialog("squeakAdd",TX.tx("JSON has been loaded"))})},e.getClient=function(){return E},e.getCloud=function(){return S},e.playAction=function(t,a){var n=E.hoard.record_action(t,function(t){T.action(t,!0,function(t){a&&a(t),Utils.sometime("update_save")})});null!==n&&e.squeak({title:TX.tx("Error"),severity:"error",message:n.message})},e.pushUndo=function(t){x.push(t)},e.can_undo=function(){return 0!==x.length},e.undo=function(){var a=x.pop();a.time=Date.now();var n=E.hoard.record_action(a,function(e){T.action(e,!1,function(){0===x.length&&t(".tree-modified").removeClass("tree-modified"),Utils.sometime("update_save")})});null!==n&&e.squeak({title:TX.tx("Error"),severity:"error",message:n.message})},t(function(){var a=Utils.query_string();a.debug&&(DEBUG=!0),t.ajaxSetup({cache:!0});var n=Cookies.get("ui_theme");n&&"base"!==n&&e.theme(n);var r=Cookies.get("ui_scale");r&&r>0&&e.scale(r);var o=a.store||"TestStore";void 0!==a.steg&&(w=!0);var i=["js/"+o+".min.js"];w?(i.push("js/Steganographer.min.js"),i.push("js/StegaStore.min.js")):t(".using_steganography").remove();var s="undefined"!=typeof UNCOMPRESSED&&UNCOMPRESSED;Utils.load(i,s,function(){TX.init(function(){A(),_()})})})}(jQuery,Squirrel),/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(t,e){var a,n={},r={};r._create=function(){function r(){return t("body").contextmenu("close"),t("body").find("input.in_place_editor").length>0||(t(".tree-hover").removeClass("tree-hover"),e.hideValues()&&s.hasClass("tree-leaf")&&t(this).find(".tree-value").each(function(){t(this).text(s.data("value"))}),t(this).addClass("tree-hover"),!1)}function o(){if(t("body").contextmenu("isOpen")||t("body").find("input.in_place_editor").length>0)return!0;e.hideValues()&&s.hasClass("tree-leaf")&&t(this).find(".tree-value").each(function(){t(this).text(e.mask(s.data("value")))}),t(this).removeClass("tree-hover")}var i=this,s=this.element;this.options.compare&&(a=this.options.compare);var l,u,d=this.options,c=!1,h=!d.path,f="";if(s.addClass("tree-node"),h)n[""]=s,s.addClass("tree-root"),s.data("path","");else{l=d.path.slice(),f=l.pop(),u=this.getNodeFromPath(l),s.data("key",f);var p=t("<div></div>").addClass("tree-title").hover(r,o).on("paste",function(){}).appendTo(s);if(void 0!==d.value&&null!==d.value)s.data("value",d.value).data("is_leaf",!0).addClass("tree-leaf"),c=!0;else{var g=t("<button></button>").addClass("tree-open-close");p.prepend(g),s.addClass("tree-open"),this._createIconButton(g,"folder-closed",function(){return s.tree("toggle"),!1})}var v=t("<div></div>").addClass("tree-info").appendTo(p);t("<span></span>").appendTo(v).addClass("tree-key").text(f).on(t.isTouchCapable()?"doubletap":"dblclick",function(t){t.preventDefault(),i.editKey()}),c&&(t("<span> : </span>").addClass("tree-separator").appendTo(v),t("<span></span>").appendTo(v).addClass("tree-value").text(e.hideValues()?e.mask(d.value):d.value).on(t.isTouchCapable()?"doubletap":"dblclick",function(t){t.preventDefault(),i.editValue()}))}c||s.addClass("tree-collection").append("<ul class='sortable tree-subnodes'></ul>"),this.toggle(),h||this._makeDraggable(),u&&this._insertInto(u),void 0!==d.time&&this.setModified(d.time),d.on_create&&d.on_create.call(s)},r._createIconButton=function(t,e,a){var n=t.button({icons:{primary:"ui-icon-squirrel-"+e},classes:{"ui-button-icon":"squirrel-icon"},text:!1});a&&n.on("click",a)},r._changeIconButton=function(t,e){t.length>0&&t.button("option","icons",{primary:"ui-icon-squirrel-"+e})},r._destroyIconButton=function(t){t.remove()},r.edit=function(a,n,r){var o=this.element,i=o.closest(".tree-root").width();i-=a.position().left,a.parents().each(function(){i-=t(this).position().left}),e.enableContextMenu(!1);var s=this.getPath();a.edit_in_place({width:i,text:n,changed:function(t){return e.playAction({type:r,path:s,data:t}),t},closed:function(){e.enableContextMenu(!0)}})},r.editKey=function(){var t=this.element;this.edit(t.find(".tree-key:first"),t.data("key"),"R")},r.editValue=function(){var t=this.element;this.edit(t.find(".tree-value:first"),t.data("value"),"E")},r.ringAlarm=function(){this.element.find(".tree-alarm").addClass("tree-expired").find(".ui-icon-squirrel-alarm").removeClass("ui-icon-squirrel-alarm").addClass("ui-icon-squirrel-rang")},r._makeDraggable=function(){function a(e){var a=t(".tree-collection").not(".ui-draggable-dragging").filter(function(){if(t(this).is(r.parent().closest(".tree-node")))return!1;var a=t(this).offset();return!(e.pageX<a.left||e.pageY<a.top)&&!(e.pageX>a.left+t(this).outerWidth(!0)||e.pageY>a.top+t(this).outerHeight(!0))});t(".drop-target").removeClass("drop-target"),a.length>0&&(a=a.last(),a.addClass("drop-target"))}function n(){var a=t(".drop-target");a.length,a.each(function(){var a=t(this);a.removeClass("drop-target");var n=r.tree("getPath"),o=a.tree("getPath");e.playAction({type:"M",path:n,data:o})})}var r=this.element;r.draggable({axis:"y",containment:".tree-collection",cursor:"pointer",revert:!0,revertDuration:1,drag:a,stop:n})},r.getPath=function(){var t=this.element;if(t.hasClass("tree-root"))return[];t.hasClass("tree-node");var a=t.data("path");return a||(this._addToCaches(),(a=t.data("path"))||(a="")),a.split(e.PATHSEP)},r._insertInto=function(e){var n=this.element;this._removeFromCaches(),n.detach();var r=n.data("key"),o=!1,i=e.find("ul:first");i.children(".tree-node").each(function(){if(a(t(this).data("key"),r)>0)return n.insertBefore(t(this)),o=!0,!1}),o||i.append(n)},r.setModified=function(t){return this.element.addClass("tree-modified").data("last-time-changed",t)},r.open=function(){var t=this.element;return t.hasClass("tree-open")?t:(t.hasClass("tree-root")||this._changeIconButton(t.find(".tree-open-close").first(),"folder-open"),t.addClass("tree-open").children(".tree-subnodes").scroll_into_view().show())},r.close=function(){var t=this.element;return t.hasClass("tree-open")?(this._changeIconButton(t.find(".tree-open-close").first(),"folder-closed"),t.removeClass("tree-open").children(".tree-subnodes").hide()):t},r.toggle=function(){return this.element.hasClass("tree-open")?this.close():this.open()},r.action_E=function(t,a){var n=this.element;a&&e.pushUndo({type:"E",path:this.getPath(),data:n.data("value")}),n.data("value",t.data).find(".tree-value:first").text(e.hideValues()?e.mask(t.data):t.data),this.setModified(t.time)},r.action_D=function(t,a){var n=this.element;a&&e.pushUndo({type:"N",path:this.getPath(),data:n.data("value")}),this._removeFromCaches(),n.parent().closest(".tree-node").tree("setModified",t.time),n.remove()},r.action_A=function(a,n){var r=this.element,o=r.data("alarm");if(o!==a.data){if(void 0===o){var i=t("<button></button>").addClass("tree-alarm");r.find(".tree-key").first().before(i),this._createIconButton(i,"alarm",function(){return t("#alarm_dlg").squirrelDialog("open",{$node:r}),!1}),r.parents(".tree-node").each(function(){var e=t(this).data("alarm-count")||0;t(this).data("alarm-count",e+1),t(this).addClass("tree-has-alarms")}),n&&e.pushUndo({type:"C",path:this.getPath()})}else n&&e.pushUndo({type:"A",path:this.getPath(),data:o});r.data("alarm",a.data),this.setModified(a.time)}},r.action_C=function(a,n){var r=this.element,o=r.data("alarm");o&&(n&&e.pushUndo({type:"A",path:this.getPath(),data:o}),r.parents(".tree-node").each(function(){var e=t(this).data("alarm-count")||0;e-=1,t(this).data("alarm-count",e),0===e&&t(this).removeClass("tree-has-alarms")}),this._destroyIconButton(r.find(".tree-alarm").first()),r.removeData("alarm"),this.setModified(a.time))},r.action_X=function(t,a){var n=this.element.data("constraints");n!==t.data&&(a&&e.pushUndo({type:"X",path:this.getPath(),data:n}),this.element.data("constraints",t.data),this.setModified(t.time))},r.action_M=function(t,a){var n=this.element,r=this.getPath(),o=t.data.slice(),i=this.getNodeFromPath(o);this._insertInto(i),this.getPath(),n.scroll_into_view(),this.setModified(t.time),o.push(r.pop()),a&&e.pushUndo({type:"M",path:o,data:r})},r.action_R=function(t,a){var n=this.element,r=t.path[t.path.length-1];n.data("key",t.data).find(".tree-key").first().text(t.data),this.setModified(t.time),this._insertInto(n.parent().closest(".tree-collection")),n.scroll_into_view();var o=n.tree("getPath");a&&e.pushUndo({type:"R",path:o,data:r}),Utils.sometime("update_save")},r.action=function(a,n,r){if("N"===a.type)t("<li></li>").tree({path:a.path,value:a.data,time:a.time,on_create:function(){var t=this.tree("getPath");n&&e.pushUndo({type:"D",path:t}),void 0!==r&&r(this)}});else{var o=this.getNodeFromPath(a.path);o.tree("action_"+a.type,a,n),void 0!==r&&r(o)}},r._addToCaches=function(t){var a=this.element;t||(t=a.parent().closest(".tree-node").tree("getPath")),t.push(a.data("key"));var r=t.join(e.PATHSEP);a.data("path",r),n[r]=a},r._removeFromCaches=function(){var e=this.element;e.hasClass("tree-node")||(e=e.closest(".tree-node")),delete n[e.data("path")],e.removeData("path").find(".tree-node").each(function(){var e=t(this);delete n[e.data("path")],e.data("path",null)})},r.getNodeFromPath=function(t){var a=n[t.join(e.PATHSEP)];return a},t.widget("squirrel.tree",r)}(jQuery,Squirrel),/*@preserve Copyright (C) 2015-2017 Crawford Currie http://c-dot.co.uk license MIT*/
function(t,e){var a={};a._validateUniqueKey=function(){var a=this.get("key"),n=a.val(),r=!0;if(/\S/.test(n)){this.element.data("parent").find("ul:first").children(".tree-node").each(function(){if(0==e.compare(t(this).data("key"),n))return r=!1,!1})}else r=!1;r?(this.get("ok").button("enable"),a.removeClass("dlg-disabled").attr("title",TX.tx("Enter new name"))):(this.get("ok").button("disable"),a.addClass("dlg-disabled").attr("title",TX.tx("Name is already in use")))},a.get=function(t){return this.element.find("[data-id='"+t+"']")},a.open=function(e){var a,n=this.element,r=n.attr("id").replace(/_dlg$/,"");return n.hasClass("dlg-initialised")||(n.addClass("dlg-initialised"),this.get("cancel").button().on(t.getTapEvent(),function(){return n.squirrelDialog("close"),!1}),void 0!==(a=this["_init_"+r])&&a.call(this,n)),a=this["_open_"+r],void 0!==a&&a.call(this,n,e),t.isTouchCapable()&&!this.options.position&&(this.options.position={my:"left top",at:"left top",of:t("body")}),this.options.modal=!0,this.options.width="auto",this.options.closeOnEscape=!1,this._super()},a._open_login=function(e,a){this.get("uReq").toggle(a.user_required),this.get("pReq").toggle(a.pass_required);var n=this.get("user"),r=this.get("pass"),o=this.get("signin"),i=function(){return e.squirrelDialog("close"),o.off(t.getTapEvent()),n.off("change"),r.off("change"),a.on_signin.call(a.store,n.val(),r.val()),!0};o.off(t.getTapEvent()).on(t.getTapEvent(),"p",i),n.off("change").val(a.store.user()),r.off("change").val(a.store.pass()),a.user_required&&(n.attr("autofocus","autofocus"),a.pass_required?n.off("change").on("change",function(){r.focus()}):n.off("change").on("change",i),n.focus()),a.pass_required&&(this.get("foruser").toggle(null!==a.store.user()).text(a.store.user()||""),r.attr("autofocus","autofocus"),a.user_required?r.on("change",function(){o.focus()}):(r.focus(),r.on("change",i)))},a._init_delete=function(a){this.get("ok").on(t.getTapEvent(),function(){return a.squirrelDialog("close"),e.playAction({type:"D",path:a.data("node").tree("getPath")}),!0}),this.get("cancel").on(t.getTapEvent(),function(){return a.squirrelDialog("close"),!1})},a._open_delete=function(t,e){var a=e.$node;t.data("node",a),this.get("path").text(a.tree("getPath").join("/")),this.get("coll").toggle(!a.hasClass("tree-leaf"))},a._init_pick=function(e){this.get("clear").on(t.getTapEvent(),function(){e.find(".dlg-picked").removeClass("dlg-picked")})},a._open_pick=function(e,a){var n,r,o=a.$node,i=o.data("value"),s=this.get("which"),l=this.get("from");e.find(".dlg-pick-cell").remove();var u=function(){var a=t(this).data("i");e.find("td.i"+a).addClass("dlg-picked")};for(n=0;n<i.length;n++)r=l.children("td.i"+n),0===r.length&&(t("<td></td>").data("i",n).addClass("dlg-pick-cell i"+n).text(n+1).on(t.getTapEvent(),u).appendTo(s),r=t("<td></td>").data("i",n).addClass("dlg-pick-cell i"+n).on(t.getTapEvent(),u).appendTo(l)),r.text(i.charAt(n));for(;n<l.children("td").length;)l.children("td").last().remove(),n++;e.find(".dlg-picked").removeClass("dlg-picked")},a._init_randomise=function(a){var n=this;this.get("again").on(t.getTapEvent(),function(){return n.get("idea").text(Utils.generate_password({length:n.get("len").val(),charset:n.get("chs").val()})),!1}),this.get("use").on(t.getTapEvent(),function(){return a.squirrelDialog("close"),e.playAction({type:"E",path:a.data("node").tree("getPath"),data:n.get("idea").text()}),!0}),this.get("len").on("input",function(){n.get("remember").show()}),this.get("chs").on("input",function(){n.get("remember").show()}),this.get("remember").on(t.getTapEvent(),function(){var r=n.get("len").val()+";"+n.get("chs").val();e.playAction({type:"X",path:a.data("node").tree("getPath"),data:r}),t(this).hide()})},a._open_randomise=function(e,a){var n=this,r=a.$node,o=r.data("key");e.data("node",r);var i=r.data("constraints");i&&(i=i.split(";",2),n.get("len").val(i[0]),n.get("chs").val(i[1]));var s=r.tree("getPath");this.get("path").text(s.join("/")),this.get("key").text(o),this.get("again").trigger(t.getTapEvent()),this.get("remember").hide()},a._init_search=function(a){var n=this;this.get("ok").on(t.getTapEvent(),function(){a.squirrelDialog("close"),e.search(n.get("string").val())}),this.get("string").on("change",function(){n.get("ok").trigger(t.getTapEvent())})},a._updateNext=function(){var t=this.get("number").val();t*=Utils.TIMEUNITS[this.get("units").val()].days;var e=new Date(Date.now()+t*Utils.MSPERDAY);this.get("nextmod").template("expand",Utils.deltaTimeString(e),e.toLocaleDateString())},a._init_alarm=function(a){var n=this;n.get("units").on("change",function(){n._updateNext()}),n.get("number").on("change",function(){n._updateNext()}),n.get("remind").on(t.getTapEvent(),function(){a.squirrelDialog("close");var t=n.get("number").val()*Utils.TIMEUNITS[n.get("units").val()].days;return e.playAction({type:"A",path:a.data("node").tree("getPath"),data:t}),!1}),n.get("clear").on(t.getTapEvent(),function(){return a.squirrelDialog("close"),e.playAction({type:"C",path:a.data("node").tree("getPath")}),!1})},a._open_alarm=function(t,e){var a=e.$node;this.get("path").text(a.tree("getPath").join("/")),t.data("node",a);var n=a.data("last-time-changed");if(this.get("lastmod").template("expand",new Date(n).toLocaleString()),void 0!==a.data("alarm")){var r=new Date(n+a.data("alarm")*Utils.MSPERDAY);this.get("current").template("expand",Utils.deltaTimeString(r),r.toLocaleDateString()).show(),this.get("clear").show()}else this.get("current").hide(),this.get("clear").hide();this._updateNext()},a._change_image=function(){var a=this,n=function(t){a.get("message").template("pick","cui").template("expand",t)},r=a.get("file")[0].files[0];Utils.read_file(r,function(o){(o="data:"+r.type+";base64,"+Utils.ArrayBufferToBase64(o))!==a.get("steg_image").attr("src",o)&&a.get("steg_image").attr("src",o).off("load").on("load",function(){t(this).off("load");var r=new Steganographer(this);try{r.inject("tada")}catch(t){return void n(t)}a.get("ok").button("enable");var o=this.naturalHeight,i=this.naturalWidth;this.height=100,a.get("message").template("pick","xbyy").template("expand",i,o),e.getClient().status===e.IS_LOADED&&(e.getClient().status=e.NEW_SETTINGS),e.getCloud().status===e.IS_LOADED&&(e.getCloud().status=e.NEW_SETTINGS),Utils.sometime("update_save")})},n,"arraybuffer")},a._init_store_settings=function(a){var n=this;n.get("file").hide().on(t.getTapEvent(),function(){n._change_image()}),n.get("image").on(t.getTapEvent(),function(t){n.get("file").trigger("change",t)}),n.get("storepath").on("keyup",function(){return""===n.get("storepath").val()?(n.get("message").template("pick","mnbe"),!1):(e.getClient().hoard.options.store_path!==n.get("storepath").val()&&(e.getClient().hoard.options.store_path=n.get("storepath").val(),e.getClient().status===e.IS_LOADED&&(e.getClient().status=e.NEW_SETTINGS),Utils.sometime("update_save")),!0)}),n.get("ok").on(t.getTapEvent(),function(){if(""===n.get("storepath").val())return n.get("message").template("pick","mnbe"),!1;a.squirrelDialog("close");var t=a.data("callback");"function"==typeof t&&t()})},a._open_store_settings=function(t,a){this.get("message").hide(),t.data("callback",a),this.get("storepath").val(e.getClient().hoard.options.store_path)},a._init_chpw=function(a){var n=this;n.get("show").on("change",function(){n.get("show").prop("checked")?(n.get("pass").attr("type","text"),n.get("conf").attr("type","text")):(n.get("pass").attr("type","password"),n.get("conf").attr("type","password"))}),a.data("validate",function(){var t=n.get("pass").val(),e=n.get("conf").val();return n.get("nomatch").toggle(t!==e),t===e}),n.get("conf").on("change",function(){a.data("validate").call()}),n.get("set").on(t.getTapEvent(),function(){if(!a.data("validate").call())return!1;a.squirrelDialog("close");var t=n.get("pass").val();return e.getClient().store.pass(t),e.getClient().status=e.NEW_SETTINGS,e.getCloud().store.pass(t),e.getCloud().status=e.NEW_SETTINGS,Utils.sometime("update_save"),!0})},a._open_chpw=function(t){t.data("validate").call()},a._init_json=function(a){var n=this;n.get("text").on("input",function(){n.get("ok").button("enable")}),n.get("ok").on(t.getTapEvent(),function(){a.squirrelDialog("close");var t;try{t=JSON.parse(n.get("text").val())}catch(t){return e.squeak({title:TX.tx("JSON could not be parsed"),severity:"error",message:t}),!1}return n.get("ok").button("disable"),e.insert_data([],t),!0})},a._open_json=function(){var t=e.getClient().hoard.JSON();this.get("text").text(t).select(),this.get("ok").button("disable")},a._init_extras=function(a){var n=this;n.get("theme").on("change",function(){e.theme(t(this).val())}),n.get("autosave").on("change",function(){e.autosave(t(this).prop("checked"))}),n.get("hidevalues").on("change",function(){e.hideValues(t(this).prop("checked"))}),n.get("chpw").on(t.getTapEvent(),function(){a.squirrelDialog("close"),t("#chpw_dlg").squirrelDialog("open")}),n.get("chss").on(t.getTapEvent(),function(){a.squirrelDialog("close"),t("#store_settings_dlg").squirrelDialog("open")}),n.get("theme").on(t.getTapEvent(),function(){a.squirrelDialog("close"),t("#theme_dlg").squirrelDialog("open")}),n.get("json").on(t.getTapEvent(),function(){a.squirrelDialog("close"),t("#json_dlg").squirrelDialog("open")}),n.get("bigger").button().on("click",function(){e.zoom(1.25)}),n.get("smaller").button().on("click",function(){e.zoom(.8)}),n.get("about").on(t.getTapEvent(),function(){a.squirrelDialog("close"),t("#about_dlg").squirrelDialog("open")})},a._open_extras=function(){var t=this;e.USE_STEGANOGRAPHY||e.getCloud().store&&e.getCloud().store.options().needs_path||t.get("chss").hide(),t.get("autosave").prop("checked",e.autosave()),t.get("hidevalues").prop("checked",e.hideValues()),t.get("theme").find("option:selected").prop("selected",!1),t.get("theme").find("option[value='"+e.theme()+"']").prop("selected",!0)},a._init_insert=function(a){var n=this;n.get("key").on("input",function(){n._validateUniqueKey()}),n.get("ok").button().on(t.getTapEvent(),function(){a.squirrelDialog("close"),e.add_child_node(a.data("parent"),n.get("key").val(),a.data("data"))})},a._open_insert=function(e,a){var n=a.$node;e.data("parent",n),e.data("data",a.data);var r=TX.tx("A copy"),o=new RegExp("^"+r+" ?(\\d*)$"),i=-1;n.find("ul:first").children(".tree-node").each(function(){var e=o.exec(t(this).data("key"));e&&(i=Math.max(i,e[1]?parseInt(e[1]):0))}),this.get("key").val(r+(i>=0?" "+(i+1):""))},a._init_add=function(a){var n=this;n.get("key").on("input",function(){n._validateUniqueKey()}).autocomplete({source:[TX.tx("User"),TX.tx("Pass")]}),n.get("ok").button().on(t.getTapEvent(),function(){a.squirrelDialog("close");var t=a.data("parent");return e.add_child_node(t,n.get("key").val(),a.data("adding_value")?n.get("value").val():void 0),!1})},a._open_add=function(t,e){var a=e.$node,n=e.is_value;t.data("parent",a),t.data("adding_value",n),this.get("path").text(a.tree("getPath").join(" > ")+" > "),n?(this.get("value_help").show(),this.get("folder_help").hide(),this.get("value_parts").show(),this.get("key").autocomplete("enable")):(this.get("value_help").hide(),this.get("folder_help").show(),this.get("value_parts").hide(),this.get("key").autocomplete("disable")),this._validateUniqueKey()},a._init_squeak=function(e){this.get("close").button().on(t.getTapEvent(),function(){var t=e.data("after_close");return e.removeData("after_close"),e.squirrelDialog("close"),"function"==typeof t&&t(),!1})},a._open_squeak=function(t,e){"string"==typeof e&&(e={message:e,severity:"notice"}),t.data("after_close",e.after_close),this.element.find(".messages").empty(),this.squeakAdd(e);var a={close:function(){"function"==typeof e.after_close&&e.after_close()}};e.title&&(a.title=e.title)},a.squeakAdd=function(e){var a=this.element;a.find(".dlg-while").remove(),"string"==typeof e&&(e={message:e,severity:"notice"}),e.severity||(e.severity="notice"),a.find(".messages").append(t("<div class='dlg-"+e.severity+"'></div>").append(e.message))},t.widget("squirrel.squirrelDialog",t.ui.dialog,a)}(jQuery,Squirrel);