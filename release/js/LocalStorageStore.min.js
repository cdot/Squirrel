/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
function LocalStorageStore(t){"use strict";if(t.user)this.user(t.user);else{for(var e,o=0,r=null;null!=(e=localStorage.key(o));){var a=/^Squirrel\.(.*)$/.exec(e);if(a){if(r){r=null;break}r=a[1]}o++}r&&(global.DEBUG&&console.debug("LocalStorageStore: Identified possible user "+r),this.user(r))}AbstractStore.call(this,t)}if("undefined"!=typeof module)var AbstractStore=require("./AbstractStore");LocalStorageStore.prototype=Object.create(AbstractStore.prototype),LocalStorageStore.prototype.options=function(){"use strict";return $.extend(AbstractStore.prototype.options(),{needs_path:!0,identifier:"browser"})},LocalStorageStore.prototype.read=function(t,e,o){"use strict";var r;global.DEBUG&&console.debug("LocalStorageStore: Reading "+t);try{r=localStorage.getItem(t)}catch(t){return global.DEBUG&&console.debug("Caught "+t),void o.call(this,t)}if(null===r)o.call(this,AbstractStore.NODATA);else{var a=Utils.PackedStringToArrayBuffer(r);e.call(this,a)}},LocalStorageStore.prototype.write=function(t,e,o,r){"use strict";global.DEBUG&&console.debug("LocalStorageStore: Writing "+t);try{var a=Utils.ArrayBufferToPackedString(e);localStorage.setItem(t,a)}catch(t){return global.DEBUG&&console.debug("Caught "+t),void r.call(this,t)}o.call(this)},"undefined"!=typeof module&&(module.exports=LocalStorageStore);