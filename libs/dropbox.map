{"version":3,"sources":["libs/dropbox.js"],"names":["DbxClient","DbxEnvGlobal","DbxEnvRequire","DbxXhrArrayBufferView","DbxXhrCanSendForms","DbxXhrDoesPreflight","DbxXhrIeMode","DbxXhrRequest","DbxXhrSendArrayBufferView","DbxXhrWrapBlob","Dropbox","__hasProp","hasOwnProperty","__indexOf","indexOf","item","i","l","this","length","__extends","child","parent","ctor","constructor","key","call","prototype","__super__","Error","Util","Http","File","global","module","require","bind","exports","window","navigator","name","value","_ref","_results","push","self","importScripts","Env","EventSource","options","_cancelable","cancelable","_listeners","addListener","listener","TypeError","removeListener","index","_i","_len","splice","dispatch","event","returnValue","AccountInfo","accountInfo","lastIndex","_json","display_name","email","countryCode","country","uid","toString","public_app_url","publicAppUrl","substring","referralUrl","referral_link","quota","quota_info","privateBytes","normal","sharedBytes","shared","usedQuota","parse","json","ApiError","xhr","method","url","text","status","responseType","response","responseText","_error","JSON","NETWORK_ERROR","NO_CONTENT","INVALID_PARAM","INVALID_TOKEN","OAUTH_ERROR","NOT_FOUND","INVALID_METHOD","NOT_ACCEPTABLE","CONFLICT","RATE_LIMITED","SERVER_ERROR","OVER_QUOTA","inspect","AuthDriver","authType","doAuthorize","authUrl","stateParam","client","callback","code","getStateParam","Oauth","randomAuthStateParam","resumeAuthorize","onAuthStateChange","oauthQueryParams","sort","autoConfigure","chrome","runtime","id","tabs","create","authDriver","ChromeExtension","ChromeApp","cordova","Cordova","Redirect","BrowserBase","rememberUser","scope","storageKey","storage","localStorage","stateRe","onAuthStepChange","_this","setStorageKey","authStep","Client","RESET","loadCredentials","credentials","setCredentials","DONE","forgetCredentials","storeCredentials","SIGNED_OUT","ERROR","appHash","jsonString","stringify","setItem","encodeURIComponent","document","cookie","cookieRegexp","match","getItem","replace","RegExp","exec","decodeURIComponent","expires","removeItem","Date","toGMTString","locationStateParam","location","currentLocation","replaceUrlBasename","basename","fragments","hashIndex","queryIndex","split","join","href","cleanupLocation","pageUrl","history","replaceState","title","hash","_super","receiverUrl","baseUrl","redirectUrl","redirectFile","assign","queryParamsFromUrl","error","Popup","listenForMessage","openWindow","receiverFile","open","popupWindowSpec","popupWidth","popupHeight","height","popupLeft","popupTop","width","x0","y0","_ref1","_ref2","_ref3","screenX","screenLeft","screenY","screenTop","outerWidth","documentElement","clientWidth","outerHeight","clientHeight","Math","round","data","oauthInfo","_dropboxjs_oauth_info","removeEventListener","onMessage","addEventListener","locationOrigin","oauthReceiver","message","opener","pageOrigin","top","origin","postMessage","close","ChromeBase","items","local","set","get","remove","identity","launchWebAuthFlow","interactive","receiverPath","getURL","oauthTab","sender","receiverHref","tab","dropbox_oauth_receiver_href","active","pinned","sendMessage","browser","onEvent","removed","setTimeout","type","AuthError","NodeServer","_port","port","tls","_tlsOptions","Buffer","cert","_fs","_http","_https","_open","_callbacks","_nodeUrl","createApp","openBrowser","process","env","_app","createServer","request","doRequest","listen","closeServer","pathname","query","state","on","dataFragment","closeBrowser","closeHtml","writeHead","Content-Length","Content-Type","write","end","queryString","root","description","error_description","uri","error_uri","ACCESS_DENIED","INVALID_REQUEST","UNAUTHORIZED_CLIENT","INVALID_GRANT","INVALID_SCOPE","UNSUPPORTED_GRANT_TYPE","UNSUPPORTED_RESPONSE_TYPE","TEMPORARILY_UNAVAILABLE","_serverRoot","server","_defaultServerRoot","_maxApiServer","maxApiServer","_defaultMaxApiServer","_authServer","authServer","_defaultAuthServer","_fileServer","fileServer","_defaultFileServer","_downloadServer","downloadServer","_defaultDownloadServer","_notifyServer","notifyServer","_defaultNotifyServer","onXhr","onError","_xhrOnErrorHandler","_handleXhrError","_oauth","_uid","step","_driver","authError","_credentials","setupUrls","driver","dropboxUid","_computeCredentials","authenticate","oldAuthStep","_fsmErrorStep","_fsmNextStep","_fsmStep","setAuthStateParam","PARAM_SET","authorizeUrl","authStateParam","queryParams","processRedirectParams","PARAM_LOADED","AUTHORIZED","getAccessToken","reset","isAuthenticated","signOut","stopOnXhrError","mustInvalidate","Xhr","_urls","signWithOauth","_dispatchXhr","signOff","getAccountInfo","httpCache","accountData","getUserInfo","readFile","path","params","rangeEnd","rangeHeader","rangeStart","versionTag","rev","arrayBuffer","blob","buffer","binary","start","getFile","_urlEncodePath","setParams","setResponseType","setHeader","reportResponseHeaders","metadata","headers","rangeInfo","RangeInfo","Stat","writeFile","useForm","canSendForms","_writeFileUsingForm","_writeFileUsingPut","fileName","slashIndex","lastIndexOf","file","noOverwrite","overwrite","lastVersionTag","parent_rev","parentRev","postFile","setFileField","putFile","setBody","resumableUploadStep","cursor","offset","tag","upload_id","chunkedUpload","UploadCursor","resumableUploadFinish","commitChunkedUpload","stat","contentHash","deleted","include_deleted","readDir","list","file_limit","cacheHash","entries","entry","contents","readdir","statOptions","limit","entry_stats","entry_stat","makeUrl","isDirect","useDownloadHack","longUrl","downloadHack","short_url","shares","download","media","urlData","ShareUrl","rev_limit","revisions","versions","stats","thumbnailUrl","thumbnailXhr","paramsToUrl","readThumbnail","format","png","size","thumbnails","revertFile","restore","findByName","namePattern","search","results","makeCopyReference","copyRef","refData","CopyReference","pullChanges","cursorTag","delta","deltaInfo","PulledChanges","pollForChanges","timeout","longpollDelta","PollResult","mkdir","fileopsCreateFolder","_normalizePath","fileopsDelete","unlink","copy","from","toPath","to_path","from_copy_ref","from_path","fileopsCopy","move","fromPath","fileopsMove","appInfo","appKey","appsInfo","app_key","AppInfo","isAppDeveloper","userId","appsCheckDeveloper","is_developer","hasOauthRedirectUri","redirectUri","appsCheckRedirectUri","redirect_uri","has_redirect_uri","_apiServer","_chooseApiServer","authorize","token","serverId","serverNumber","floor","random","urlEncodeValue","authorizeUrlParams","urlEncode","accessTokenParams","addOauthParams","nativeXhr","setCallback","prepare","send","expiresAt","parseDate","direct","now","isPreview","toUTCString","copy_ref","ceil","nameSlash","isFolder","is_dir","isFile","isRemoved","is_deleted","typeIcon","icon","modified","modifiedAt","client_mtime","clientModifiedAt","inAppFolder","bytes","humanSize","hasThumbnail","thumb_exists","mimeType","mime_type","permissions","_icons","icons","canUseDatastores","datastores","canUseFiles","files","canUseFullDropbox","hasAppFolder","ICON_SMALL","ICON_LARGE","blankSlate","shouldPullAgain","has_more","shouldBackOff","changes","PulledChange","wasRemoved","hasChanges","retryAfter","backoff","headerValue","parseInt","cursorData","atob","btoa","string","base64","arg","String","fromCharCode","charCodeAt","atobNibble","base64Digits","btoaNibble","accumulator","result","charAt","digits","digit","arrayToBase64","crypto","hmacSha1","sha1","sha256","sha256Init","sha256Key","stringToArray","_base64Digits","hmac","createHmac","createHash","update","digest","keyLength","hash1","ipad","opad","concat","a","a0","b","b0","c","c0","d","d0","e","e0","j","n","t","Array","ch","f","f0","g","g0","gamma0","gamma0x","gamma1","gamma1x","h","h0","maj","sigma0","sigma1","sj","t1","t2","factor","fractional","isPrime","prime","x","pow","array","i2","trit","mask","_id","_secret","_stateParam","_authCode","_token","_tokenKey","_tokenKid","_appHash","_loaded","secret","tokenKey","tokenKid","oauthCode","oauthStateParam","checkAuthStateParam","tokenType","token_type","toLowerCase","mac_algorithm","mac_key","kid","access_token","authHeader","macParams","ts","mac","addAuthParams","client_id","client_secret","response_type","grant_type","fragment","fragmentOffset","kvp","timestamp","toUpperCase","getTime","valueOf","dateString","parseDateMonths","parseDateRe","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","UTC","NaN","XMLHttpRequest","XDomainRequest","FormData","userAgent","Uint8Array","Object","getPrototypeOf","__proto__","Blob","ArrayBuffer","WebKitBlobBuilder","isGet","wantHeaders","body","preflight","signed","completed","Request","ieXdr","doesPreflight","ArrayBufferView","sendArrayBufferView","wrapBlob","oauth","cacheFriendly","addOauthHeader","headerName","oldValue","fieldName","fileData","contentType","boundary","builder","useFormData","byteOffset","append","getBlob","multipartBoundary","paramsToBody","header","onload","onXdrLoad","onerror","onXdrError","ontimeout","onprogress","onreadystatechange","onReadyStateChange","setRequestHeader","overrideMimeType","xhrError","object","chunks","urlDecode","allHeaders","apiError","dirtyText","duplicateIndex","metadataJson","readyState","getAllResponseHeaders","parseResponseHeaders","guessResponseHeaders","getResponseHeader","colonIndex","headerLines","line","trim","content-type"],"mappings":"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","file":"libs/dropbox.min.js","sourcesContent":["// Generated by CoffeeScript 1.6.3\n(function() {\n  var DbxClient, DbxEnvGlobal, DbxEnvRequire, DbxXhrArrayBufferView, DbxXhrCanSendForms, DbxXhrDoesPreflight, DbxXhrIeMode, DbxXhrRequest, DbxXhrSendArrayBufferView, DbxXhrWrapBlob, Dropbox,\n    __hasProp = {}.hasOwnProperty,\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  Dropbox = (function() {\n    function Dropbox() {\n      throw new Error(\"Not implemented. Did you mean to use Dropbox.Client?\");\n    }\n\n    return Dropbox;\n\n  })();\n\n  Dropbox.Util = (function() {\n    function Util() {}\n\n    return Util;\n\n  })();\n\n  Dropbox.Http = (function() {\n    function Http() {}\n\n    return Http;\n\n  })();\n\n  Dropbox.File = (function() {\n    function File() {}\n\n    return File;\n\n  })();\n\n  if (typeof global !== 'undefined' && typeof module !== 'undefined' && 'exports' in module) {\n    DbxEnvGlobal = global;\n    DbxEnvRequire = module.require.bind(module);\n    module.exports = Dropbox;\n  } else if (typeof window !== 'undefined' && typeof navigator !== 'undefined') {\n    DbxEnvGlobal = window;\n    DbxEnvRequire = null;\n    if (window.Dropbox) {\n      (function() {\n        var name, value, _ref, _results;\n        _ref = window.Dropbox;\n        _results = [];\n        for (name in _ref) {\n          if (!__hasProp.call(_ref, name)) continue;\n          value = _ref[name];\n          _results.push(Dropbox[name] = value);\n        }\n        return _results;\n      })();\n    }\n    window.Dropbox = Dropbox;\n  } else if (typeof self !== 'undefined' && typeof navigator !== 'undefined') {\n    DbxEnvGlobal = self;\n    DbxEnvRequire = self.importScripts.bind(self);\n    self.Dropbox = Dropbox;\n  } else {\n    throw new Error('dropbox.js loaded in an unsupported JavaScript environment.');\n  }\n\n  Dropbox.Env = (function() {\n    function Env() {}\n\n    Env.global = DbxEnvGlobal;\n\n    Env.require = DbxEnvRequire;\n\n    return Env;\n\n  })();\n\n  Dropbox.Util.EventSource = (function() {\n    function EventSource(options) {\n      this._cancelable = options && options.cancelable;\n      this._listeners = [];\n    }\n\n    EventSource.prototype.addListener = function(listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('Invalid listener type; expected function');\n      }\n      if (__indexOf.call(this._listeners, listener) < 0) {\n        this._listeners.push(listener);\n      }\n      return this;\n    };\n\n    EventSource.prototype.removeListener = function(listener) {\n      var i, index, subscriber, _i, _len, _ref;\n      if (this._listeners.indexOf) {\n        index = this._listeners.indexOf(listener);\n        if (index !== -1) {\n          this._listeners.splice(index, 1);\n        }\n      } else {\n        _ref = this._listeners;\n        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n          subscriber = _ref[i];\n          if (subscriber === listener) {\n            this._listeners.splice(i, 1);\n            break;\n          }\n        }\n      }\n      return this;\n    };\n\n    EventSource.prototype.dispatch = function(event) {\n      var listener, returnValue, _i, _len, _ref;\n      _ref = this._listeners;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        listener = _ref[_i];\n        returnValue = listener(event);\n        if (this._cancelable && returnValue === false) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    return EventSource;\n\n  })();\n\n  Dropbox.AccountInfo = (function() {\n    AccountInfo.parse = function(accountInfo) {\n      if (accountInfo && typeof accountInfo === 'object') {\n        return new Dropbox.AccountInfo(accountInfo);\n      } else {\n        return accountInfo;\n      }\n    };\n\n    AccountInfo.prototype.name = null;\n\n    AccountInfo.prototype.email = null;\n\n    AccountInfo.prototype.countryCode = null;\n\n    AccountInfo.prototype.uid = null;\n\n    AccountInfo.prototype.referralUrl = null;\n\n    AccountInfo.prototype.publicAppUrl = null;\n\n    AccountInfo.prototype.quota = null;\n\n    AccountInfo.prototype.usedQuota = null;\n\n    AccountInfo.prototype.privateBytes = null;\n\n    AccountInfo.prototype.sharedBytes = null;\n\n    AccountInfo.prototype.json = function() {\n      return this._json;\n    };\n\n    function AccountInfo(accountInfo) {\n      var lastIndex;\n      this._json = accountInfo;\n      this.name = accountInfo.display_name;\n      this.email = accountInfo.email;\n      this.countryCode = accountInfo.country || null;\n      this.uid = accountInfo.uid.toString();\n      if (accountInfo.public_app_url) {\n        this.publicAppUrl = accountInfo.public_app_url;\n        lastIndex = this.publicAppUrl.length - 1;\n        if (lastIndex >= 0 && this.publicAppUrl.substring(lastIndex) === '/') {\n          this.publicAppUrl = this.publicAppUrl.substring(0, lastIndex);\n        }\n      } else {\n        this.publicAppUrl = null;\n      }\n      this.referralUrl = accountInfo.referral_link;\n      this.quota = accountInfo.quota_info.quota;\n      this.privateBytes = accountInfo.quota_info.normal || 0;\n      this.sharedBytes = accountInfo.quota_info.shared || 0;\n      this.usedQuota = this.privateBytes + this.sharedBytes;\n    }\n\n    return AccountInfo;\n\n  })();\n\n  Dropbox.ApiError = (function() {\n    ApiError.prototype.status = null;\n\n    ApiError.prototype.method = null;\n\n    ApiError.prototype.url = null;\n\n    ApiError.prototype.responseText = null;\n\n    ApiError.prototype.response = null;\n\n    ApiError.NETWORK_ERROR = 0;\n\n    ApiError.NO_CONTENT = 304;\n\n    ApiError.INVALID_PARAM = 400;\n\n    ApiError.INVALID_TOKEN = 401;\n\n    ApiError.OAUTH_ERROR = 403;\n\n    ApiError.NOT_FOUND = 404;\n\n    ApiError.INVALID_METHOD = 405;\n\n    ApiError.NOT_ACCEPTABLE = 406;\n\n    ApiError.CONFLICT = 409;\n\n    ApiError.RATE_LIMITED = 429;\n\n    ApiError.SERVER_ERROR = 503;\n\n    ApiError.OVER_QUOTA = 507;\n\n    function ApiError(xhr, method, url) {\n      var text, xhrError;\n      this.method = method;\n      this.url = url;\n      this.status = xhr.status;\n      if (xhr.responseType) {\n        try {\n          text = xhr.response || xhr.responseText;\n        } catch (_error) {\n          xhrError = _error;\n          try {\n            text = xhr.responseText;\n          } catch (_error) {\n            xhrError = _error;\n            text = null;\n          }\n        }\n      } else {\n        try {\n          text = xhr.responseText;\n        } catch (_error) {\n          xhrError = _error;\n          text = null;\n        }\n      }\n      if (text) {\n        try {\n          this.responseText = text.toString();\n          this.response = JSON.parse(text);\n        } catch (_error) {\n          xhrError = _error;\n          this.response = null;\n        }\n      } else {\n        this.responseText = '(no response)';\n        this.response = null;\n      }\n    }\n\n    ApiError.prototype.toString = function() {\n      return \"Dropbox API error \" + this.status + \" from \" + this.method + \" \" + this.url + \" :: \" + this.responseText;\n    };\n\n    ApiError.prototype.inspect = function() {\n      return this.toString();\n    };\n\n    return ApiError;\n\n  })();\n\n  Dropbox.AuthDriver = (function() {\n    function AuthDriver() {}\n\n    AuthDriver.prototype.authType = function() {\n      return \"code\";\n    };\n\n    AuthDriver.prototype.url = function() {\n      return \"https://some.url\";\n    };\n\n    AuthDriver.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      return callback({\n        code: 'access-code'\n      });\n    };\n\n    AuthDriver.prototype.getStateParam = function(client, callback) {\n      return callback(Dropbox.Util.Oauth.randomAuthStateParam());\n    };\n\n    AuthDriver.prototype.resumeAuthorize = function(stateParam, client, callback) {\n      return callback({\n        code: 'access-code'\n      });\n    };\n\n    AuthDriver.prototype.onAuthStateChange = function(client, callback) {\n      return callback();\n    };\n\n    AuthDriver.oauthQueryParams = ['access_token', 'expires_in', 'scope', 'token_type', 'code', 'error', 'error_description', 'error_uri', 'mac_key', 'mac_algorithm'].sort();\n\n    return AuthDriver;\n\n  })();\n\n  Dropbox.AuthDriver.autoConfigure = function(client) {\n    if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.id) {\n      if (chrome.tabs && chrome.tabs.create) {\n        client.authDriver(new Dropbox.AuthDriver.ChromeExtension());\n      } else {\n        client.authDriver(new Dropbox.AuthDriver.ChromeApp());\n      }\n      return;\n    }\n    if (typeof window !== 'undefined') {\n      if (window.cordova) {\n        client.authDriver(new Dropbox.AuthDriver.Cordova());\n        return;\n      }\n      if (window && window.navigator) {\n        client.authDriver(new Dropbox.AuthDriver.Redirect());\n      }\n    }\n  };\n\n  Dropbox.AuthDriver.BrowserBase = (function() {\n    function BrowserBase(options) {\n      if (options) {\n        this.rememberUser = 'rememberUser' in options ? options.rememberUser : true;\n        this.scope = options.scope || 'default';\n      } else {\n        this.rememberUser = true;\n        this.scope = 'default';\n      }\n      this.storageKey = null;\n      this.storage = Dropbox.AuthDriver.BrowserBase.localStorage();\n      this.stateRe = /^[^#]+\\#(.*&)?state=([^&]+)(&|$)/;\n    }\n\n    BrowserBase.prototype.authType = function() {\n      return 'token';\n    };\n\n    BrowserBase.prototype.onAuthStepChange = function(client, callback) {\n      var _this = this;\n      this.setStorageKey(client);\n      switch (client.authStep) {\n        case Dropbox.Client.RESET:\n          return this.loadCredentials(function(credentials) {\n            if (!credentials) {\n              return callback();\n            }\n            client.setCredentials(credentials);\n            if (client.authStep !== Dropbox.Client.DONE) {\n              return callback();\n            }\n            if (!_this.rememberUser) {\n              return _this.forgetCredentials(callback);\n            }\n            client.setCredentials(credentials);\n            return callback();\n          });\n        case Dropbox.Client.DONE:\n          if (this.rememberUser) {\n            return this.storeCredentials(client.credentials(), callback);\n          }\n          return this.forgetCredentials(callback);\n        case Dropbox.Client.SIGNED_OUT:\n          return this.forgetCredentials(callback);\n        case Dropbox.Client.ERROR:\n          return this.forgetCredentials(callback);\n        default:\n          callback();\n          return this;\n      }\n    };\n\n    BrowserBase.prototype.setStorageKey = function(client) {\n      this.storageKey = \"dropbox-auth:\" + this.scope + \":\" + (client.appHash());\n      return this;\n    };\n\n    BrowserBase.prototype.storeCredentials = function(credentials, callback) {\n      var jsonString, name, storageError, value;\n      jsonString = JSON.stringify(credentials);\n      try {\n        this.storage.setItem(this.storageKey, jsonString);\n      } catch (_error) {\n        storageError = _error;\n        name = encodeURIComponent(this.storageKey);\n        value = encodeURIComponent(jsonString);\n        document.cookie = \"\" + name + \"=\" + value + \"; path=/\";\n      }\n      callback();\n      return this;\n    };\n\n    BrowserBase.prototype.loadCredentials = function(callback) {\n      var cookieRegexp, jsonError, jsonString, match, name, nameRegexp, storageError;\n      try {\n        jsonString = this.storage.getItem(this.storageKey);\n      } catch (_error) {\n        storageError = _error;\n        jsonString = null;\n      }\n      if (jsonString === null) {\n        name = encodeURIComponent(this.storageKey);\n        nameRegexp = name.replace(/[.*+()]/g, '\\\\$&');\n        cookieRegexp = new RegExp(\"(^|(;\\\\s*))\" + name + \"=([^;]*)(;|$)\");\n        if (match = cookieRegexp.exec(document.cookie)) {\n          jsonString = decodeURIComponent(match[3]);\n        }\n      }\n      if (!jsonString) {\n        callback(null);\n        return this;\n      }\n      try {\n        callback(JSON.parse(jsonString));\n      } catch (_error) {\n        jsonError = _error;\n        callback(null);\n      }\n      return this;\n    };\n\n    BrowserBase.prototype.forgetCredentials = function(callback) {\n      var expires, name, storageError;\n      try {\n        this.storage.removeItem(this.storageKey);\n      } catch (_error) {\n        storageError = _error;\n        name = encodeURIComponent(this.storageKey);\n        expires = (new Date(0)).toGMTString();\n        document.cookie = \"\" + name + \"={}; expires=\" + expires + \"; path=/\";\n      }\n      callback();\n      return this;\n    };\n\n    BrowserBase.prototype.locationStateParam = function(url) {\n      var location, match;\n      location = url || Dropbox.AuthDriver.BrowserBase.currentLocation();\n      match = this.stateRe.exec(location);\n      if (match) {\n        return decodeURIComponent(match[2]);\n      }\n      return null;\n    };\n\n    BrowserBase.prototype.replaceUrlBasename = function(url, basename) {\n      var fragments, hashIndex, queryIndex;\n      hashIndex = url.indexOf('#');\n      if (hashIndex !== -1) {\n        url = url.substring(0, hashIndex);\n      }\n      queryIndex = url.indexOf('?');\n      if (queryIndex !== -1) {\n        url = url.substring(0, queryIndex);\n      }\n      fragments = url.split('/');\n      fragments[fragments.length - 1] = basename;\n      return fragments.join('/');\n    };\n\n    BrowserBase.localStorage = function() {\n      if (typeof window !== 'undefined') {\n        return window.localStorage;\n      } else {\n        return null;\n      }\n    };\n\n    BrowserBase.currentLocation = function() {\n      return window.location.href;\n    };\n\n    BrowserBase.cleanupLocation = function() {\n      var hashIndex, pageUrl;\n      if (window.history && window.history.replaceState) {\n        pageUrl = this.currentLocation();\n        hashIndex = pageUrl.indexOf('#');\n        window.history.replaceState({}, document.title, pageUrl.substring(0, hashIndex));\n      } else {\n        window.location.hash = '';\n      }\n    };\n\n    return BrowserBase;\n\n  })();\n\n  Dropbox.AuthDriver.Redirect = (function(_super) {\n    __extends(Redirect, _super);\n\n    function Redirect(options) {\n      Redirect.__super__.constructor.call(this, options);\n      this.receiverUrl = this.baseUrl(options);\n    }\n\n    Redirect.prototype.baseUrl = function(options) {\n      var hashIndex, url;\n      url = Dropbox.AuthDriver.BrowserBase.currentLocation();\n      if (options) {\n        if (options.redirectUrl) {\n          return options.redirectUrl;\n        }\n        if (options.redirectFile) {\n          return this.replaceUrlBasename(url, options.redirectFile);\n        }\n      }\n      hashIndex = url.indexOf('#');\n      if (hashIndex !== -1) {\n        url = url.substring(0, hashIndex);\n      }\n      return url;\n    };\n\n    Redirect.prototype.url = function() {\n      return this.receiverUrl;\n    };\n\n    Redirect.prototype.doAuthorize = function(authUrl, stateParam, client) {\n      return this.storeCredentials(client.credentials(), function() {\n        return window.location.assign(authUrl);\n      });\n    };\n\n    Redirect.prototype.resumeAuthorize = function(stateParam, client, callback) {\n      var pageUrl;\n      if (this.locationStateParam() === stateParam) {\n        pageUrl = Dropbox.AuthDriver.BrowserBase.currentLocation();\n        Dropbox.AuthDriver.BrowserBase.cleanupLocation();\n        return callback(Dropbox.Util.Oauth.queryParamsFromUrl(pageUrl));\n      } else {\n        return this.forgetCredentials(function() {\n          return callback({\n            error: 'Authorization error'\n          });\n        });\n      }\n    };\n\n    return Redirect;\n\n  })(Dropbox.AuthDriver.BrowserBase);\n\n  Dropbox.AuthDriver.Popup = (function(_super) {\n    __extends(Popup, _super);\n\n    function Popup(options) {\n      Popup.__super__.constructor.call(this, options);\n      this.receiverUrl = this.baseUrl(options);\n    }\n\n    Popup.prototype.url = function() {\n      return this.receiverUrl;\n    };\n\n    Popup.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      this.listenForMessage(stateParam, callback);\n      return this.openWindow(authUrl);\n    };\n\n    Popup.prototype.baseUrl = function(options) {\n      var url;\n      url = Dropbox.AuthDriver.BrowserBase.currentLocation();\n      if (options) {\n        if (options.receiverUrl) {\n          return options.receiverUrl;\n        } else if (options.receiverFile) {\n          return this.replaceUrlBasename(url, options.receiverFile);\n        }\n      }\n      return url;\n    };\n\n    Popup.prototype.openWindow = function(url) {\n      return window.open(url, '_dropboxOauthSigninWindow', this.popupWindowSpec(980, 700));\n    };\n\n    Popup.prototype.popupWindowSpec = function(popupWidth, popupHeight) {\n      var height, popupLeft, popupTop, width, x0, y0, _ref, _ref1, _ref2, _ref3;\n      x0 = (_ref = window.screenX) != null ? _ref : window.screenLeft;\n      y0 = (_ref1 = window.screenY) != null ? _ref1 : window.screenTop;\n      width = (_ref2 = window.outerWidth) != null ? _ref2 : document.documentElement.clientWidth;\n      height = (_ref3 = window.outerHeight) != null ? _ref3 : document.documentElement.clientHeight;\n      popupLeft = Math.round(x0 + (width - popupWidth) / 2);\n      popupTop = Math.round(y0 + (height - popupHeight) / 2.5);\n      if (popupLeft < x0) {\n        popupLeft = x0;\n      }\n      if (popupTop < y0) {\n        popupTop = y0;\n      }\n      return (\"width=\" + popupWidth + \",height=\" + popupHeight + \",\") + (\"left=\" + popupLeft + \",top=\" + popupTop) + 'dialog=yes,dependent=yes,scrollbars=yes,location=yes';\n    };\n\n    Popup.prototype.listenForMessage = function(stateParam, callback) {\n      var listener,\n        _this = this;\n      listener = function(event) {\n        var data, jsonError, oauthInfo;\n        if (event.data) {\n          data = event.data;\n        } else {\n          data = event;\n        }\n        try {\n          oauthInfo = JSON.parse(data)._dropboxjs_oauth_info;\n        } catch (_error) {\n          jsonError = _error;\n          return;\n        }\n        if (!oauthInfo) {\n          return;\n        }\n        if (_this.locationStateParam(oauthInfo) === stateParam) {\n          stateParam = false;\n          window.removeEventListener('message', listener);\n          Dropbox.AuthDriver.Popup.onMessage.removeListener(listener);\n          return callback(Dropbox.Util.Oauth.queryParamsFromUrl(data));\n        }\n      };\n      window.addEventListener('message', listener, false);\n      return Dropbox.AuthDriver.Popup.onMessage.addListener(listener);\n    };\n\n    Popup.locationOrigin = function(location) {\n      var match;\n      match = /^(file:\\/\\/[^\\?\\#]*)(\\?|\\#|$)/.exec(location);\n      if (match) {\n        return match[1];\n      }\n      match = /^([^\\:]+\\:\\/\\/[^\\/\\?\\#]*)(\\/|\\?|\\#|$)/.exec(location);\n      if (match) {\n        return match[1];\n      }\n      return location;\n    };\n\n    Popup.oauthReceiver = function() {\n      window.addEventListener('load', function() {\n        var frameError, ieError, message, opener, pageOrigin, pageUrl;\n        pageUrl = window.location.href;\n        message = JSON.stringify({\n          _dropboxjs_oauth_info: pageUrl\n        });\n        Dropbox.AuthDriver.BrowserBase.cleanupLocation();\n        opener = window.opener;\n        if (window.parent !== window.top) {\n          opener || (opener = window.parent);\n        }\n        if (opener) {\n          try {\n            pageOrigin = window.location.origin || locationOrigin(pageUrl);\n            opener.postMessage(message, pageOrigin);\n            window.close();\n          } catch (_error) {\n            ieError = _error;\n          }\n          try {\n            opener.Dropbox.AuthDriver.Popup.onMessage.dispatch(message);\n            return window.close();\n          } catch (_error) {\n            frameError = _error;\n          }\n        }\n      });\n    };\n\n    Popup.onMessage = new Dropbox.Util.EventSource;\n\n    return Popup;\n\n  })(Dropbox.AuthDriver.BrowserBase);\n\n  Dropbox.AuthDriver.ChromeBase = (function(_super) {\n    __extends(ChromeBase, _super);\n\n    function ChromeBase(options) {\n      ChromeBase.__super__.constructor.call(this, options);\n      this.storageKey = \"dropbox_js_\" + this.scope + \"_credentials\";\n    }\n\n    ChromeBase.prototype.onAuthStepChange = function(client, callback) {\n      switch (client.authStep) {\n        case Dropbox.Client.RESET:\n          return this.loadCredentials(function(credentials) {\n            if (credentials) {\n              client.setCredentials(credentials);\n            }\n            return callback();\n          });\n        case Dropbox.Client.DONE:\n          return this.storeCredentials(client.credentials(), callback);\n        case Dropbox.Client.SIGNED_OUT:\n          return this.forgetCredentials(callback);\n        case Dropbox.Client.ERROR:\n          return this.forgetCredentials(callback);\n        default:\n          return callback();\n      }\n    };\n\n    ChromeBase.prototype.url = function() {\n      return this.receiverUrl;\n    };\n\n    ChromeBase.prototype.storeCredentials = function(credentials, callback) {\n      var items;\n      items = {};\n      items[this.storageKey] = credentials;\n      chrome.storage.local.set(items, callback);\n      return this;\n    };\n\n    ChromeBase.prototype.loadCredentials = function(callback) {\n      var _this = this;\n      chrome.storage.local.get(this.storageKey, function(items) {\n        return callback(items[_this.storageKey] || null);\n      });\n      return this;\n    };\n\n    ChromeBase.prototype.forgetCredentials = function(callback) {\n      chrome.storage.local.remove(this.storageKey, callback);\n      return this;\n    };\n\n    return ChromeBase;\n\n  })(Dropbox.AuthDriver.BrowserBase);\n\n  Dropbox.AuthDriver.ChromeApp = (function(_super) {\n    __extends(ChromeApp, _super);\n\n    function ChromeApp(options) {\n      ChromeApp.__super__.constructor.call(this, options);\n      this.receiverUrl = \"https://\" + chrome.runtime.id + \".chromiumapp.org/\";\n    }\n\n    ChromeApp.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      var _this = this;\n      return chrome.identity.launchWebAuthFlow({\n        url: authUrl,\n        interactive: true\n      }, function(redirectUrl) {\n        if (_this.locationStateParam(redirectUrl) === stateParam) {\n          stateParam = false;\n          return callback(Dropbox.Util.Oauth.queryParamsFromUrl(redirectUrl));\n        }\n      });\n    };\n\n    return ChromeApp;\n\n  })(Dropbox.AuthDriver.ChromeBase);\n\n  Dropbox.AuthDriver.ChromeExtension = (function(_super) {\n    __extends(ChromeExtension, _super);\n\n    function ChromeExtension(options) {\n      var receiverPath;\n      ChromeExtension.__super__.constructor.call(this, options);\n      receiverPath = (options && options.receiverPath) || 'chrome_oauth_receiver.html';\n      this.receiverUrl = chrome.runtime.getURL(receiverPath);\n    }\n\n    ChromeExtension.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      var listener, oauthTab,\n        _this = this;\n      oauthTab = null;\n      listener = function(message, sender) {\n        var receiverHref;\n        if (sender && sender.tab) {\n          if (sender.tab.url.substring(0, _this.receiverUrl.length) !== _this.receiverUrl) {\n            return;\n          }\n        }\n        if (!message.dropbox_oauth_receiver_href) {\n          return;\n        }\n        receiverHref = message.dropbox_oauth_receiver_href;\n        if (_this.locationStateParam(receiverHref) === stateParam) {\n          stateParam = false;\n          if (oauthTab) {\n            chrome.tabs.remove(oauthTab.id);\n          }\n          chrome.runtime.onMessage.removeListener(listener);\n          return callback(Dropbox.Util.Oauth.queryParamsFromUrl(receiverHref));\n        }\n      };\n      chrome.runtime.onMessage.addListener(listener);\n      return chrome.tabs.create({\n        url: authUrl,\n        active: true,\n        pinned: false\n      }, function(tab) {\n        return oauthTab = tab;\n      });\n    };\n\n    ChromeExtension.oauthReceiver = function() {\n      return window.addEventListener('load', function() {\n        var pageUrl;\n        pageUrl = window.location.href;\n        window.location.hash = '';\n        chrome.runtime.sendMessage({\n          dropbox_oauth_receiver_href: pageUrl\n        });\n        if (window.close) {\n          return window.close();\n        }\n      });\n    };\n\n    return ChromeExtension;\n\n  })(Dropbox.AuthDriver.ChromeBase);\n\n  Dropbox.AuthDriver.Cordova = (function(_super) {\n    __extends(Cordova, _super);\n\n    function Cordova(options) {\n      Cordova.__super__.constructor.call(this, options);\n    }\n\n    Cordova.prototype.url = function() {\n      return 'https://www.dropbox.com/1/oauth2/redirect_receiver';\n    };\n\n    Cordova.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      var authHost, browser, onEvent, promptPageLoaded, removed,\n        _this = this;\n      browser = window.open(authUrl, '_blank', 'location=yes,closebuttoncaption=Cancel');\n      promptPageLoaded = false;\n      authHost = /^[^/]*\\/\\/[^/]*\\//.exec(authUrl)[0];\n      removed = false;\n      onEvent = function(event) {\n        if (event.url && _this.locationStateParam(event.url) === stateParam) {\n          if (removed) {\n            return;\n          }\n          browser.removeEventListener('loadstart', onEvent);\n          browser.removeEventListener('loaderror', onEvent);\n          browser.removeEventListener('loadstop', onEvent);\n          browser.removeEventListener('exit', onEvent);\n          removed = true;\n          window.setTimeout((function() {\n            return browser.close();\n          }), 10);\n          callback(Dropbox.Util.Oauth.queryParamsFromUrl(event.url));\n          return;\n        }\n        if (event.type === 'exit') {\n          if (removed) {\n            return;\n          }\n          browser.removeEventListener('loadstart', onEvent);\n          browser.removeEventListener('loaderror', onEvent);\n          browser.removeEventListener('loadstop', onEvent);\n          browser.removeEventListener('exit', onEvent);\n          removed = true;\n          callback(new AuthError('error=access_denied&error_description=User+closed+browser+window'));\n        }\n      };\n      browser.addEventListener('loadstart', onEvent);\n      browser.addEventListener('loaderror', onEvent);\n      browser.addEventListener('loadstop', onEvent);\n      return browser.addEventListener('exit', onEvent);\n    };\n\n    return Cordova;\n\n  })(Dropbox.AuthDriver.BrowserBase);\n\n  Dropbox.AuthDriver.NodeServer = (function() {\n    function NodeServer(options) {\n      this._port = (options != null ? options.port : void 0) || 8912;\n      if (options != null ? options.tls : void 0) {\n        this._tlsOptions = options.tls;\n        if (typeof this._tlsOptions === 'string' || this._tlsOptions instanceof Buffer) {\n          this._tlsOptions = {\n            key: this._tlsOptions,\n            cert: this._tlsOptions\n          };\n        }\n      } else {\n        this._tlsOptions = null;\n      }\n      this._fs = Dropbox.Env.require('fs');\n      this._http = Dropbox.Env.require('http');\n      this._https = Dropbox.Env.require('https');\n      this._open = Dropbox.Env.require('open');\n      this._callbacks = {};\n      this._nodeUrl = Dropbox.Env.require('url');\n      this.createApp();\n    }\n\n    NodeServer.prototype.authType = function() {\n      return \"code\";\n    };\n\n    NodeServer.prototype.url = function() {\n      var protocol;\n      protocol = this._tlsOptions === null ? 'http' : 'https';\n      return \"\" + protocol + \"://localhost:\" + this._port + \"/oauth_callback\";\n    };\n\n    NodeServer.prototype.doAuthorize = function(authUrl, stateParam, client, callback) {\n      this._callbacks[stateParam] = callback;\n      return this.openBrowser(authUrl);\n    };\n\n    NodeServer.prototype.openBrowser = function(url) {\n      if (!url.match(/^https?:\\/\\//)) {\n        throw new Error(\"Not a http/https URL: \" + url);\n      }\n      if ('BROWSER' in process.env) {\n        return this._open(url, process.env['BROWSER']);\n      } else {\n        return this._open(url);\n      }\n    };\n\n    NodeServer.prototype.createApp = function() {\n      var _this = this;\n      if (this._tlsOptions) {\n        this._app = this._https.createServer(this._tlsOptions, function(request, response) {\n          return _this.doRequest(request, response);\n        });\n      } else {\n        this._app = this._http.createServer(function(request, response) {\n          return _this.doRequest(request, response);\n        });\n      }\n      return this._app.listen(this._port);\n    };\n\n    NodeServer.prototype.closeServer = function() {\n      return this._app.close();\n    };\n\n    NodeServer.prototype.doRequest = function(request, response) {\n      var data, stateParam, url,\n        _this = this;\n      url = this._nodeUrl.parse(request.url, true);\n      if (url.pathname === '/oauth_callback') {\n        stateParam = url.query.state;\n        if (this._callbacks[stateParam]) {\n          this._callbacks[stateParam](url.query);\n          delete this._callbacks[stateParam];\n        }\n      }\n      data = '';\n      request.on('data', function(dataFragment) {\n        return data += dataFragment;\n      });\n      return request.on('end', function() {\n        return _this.closeBrowser(response);\n      });\n    };\n\n    NodeServer.prototype.closeBrowser = function(response) {\n      var closeHtml;\n      closeHtml = \"<!doctype html>\\n<script type=\\\"text/javascript\\\">window.close();</script>\\n<p>Please close this window.</p>\";\n      response.writeHead(200, {\n        'Content-Length': closeHtml.length,\n        'Content-Type': 'text/html'\n      });\n      response.write(closeHtml);\n      return response.end();\n    };\n\n    return NodeServer;\n\n  })();\n\n  Dropbox.AuthError = (function() {\n    AuthError.prototype.code = null;\n\n    AuthError.prototype.description = null;\n\n    AuthError.prototype.uri = null;\n\n    AuthError.ACCESS_DENIED = 'access_denied';\n\n    AuthError.INVALID_REQUEST = 'invalid_request';\n\n    AuthError.UNAUTHORIZED_CLIENT = 'unauthorized_client';\n\n    AuthError.INVALID_GRANT = 'invalid_grant';\n\n    AuthError.INVALID_SCOPE = 'invalid_scope';\n\n    AuthError.UNSUPPORTED_GRANT_TYPE = 'unsupported_grant_type';\n\n    AuthError.UNSUPPORTED_RESPONSE_TYPE = 'unsupported_response_type';\n\n    AuthError.SERVER_ERROR = 'server_error';\n\n    AuthError.TEMPORARILY_UNAVAILABLE = 'temporarily_unavailable';\n\n    function AuthError(queryString) {\n      var root;\n      if (!queryString.error) {\n        throw new Error(\"Not an OAuth 2.0 error: \" + (JSON.stringify(queryString)));\n      }\n      if (typeof queryString.error === 'object' && queryString.error.error) {\n        root = queryString.error;\n      } else {\n        root = queryString;\n      }\n      this.code = root.error;\n      this.description = root.error_description || null;\n      this.uri = root.error_uri || null;\n    }\n\n    AuthError.prototype.toString = function() {\n      return \"Dropbox OAuth error \" + this.code + \" :: \" + this.description;\n    };\n\n    AuthError.prototype.inspect = function() {\n      return this.toString();\n    };\n\n    return AuthError;\n\n  })();\n\n  Dropbox.Client = (function() {\n    function Client(options) {\n      var _this = this;\n      this._serverRoot = options.server || this._defaultServerRoot();\n      if ('maxApiServer' in options) {\n        this._maxApiServer = options.maxApiServer;\n      } else {\n        this._maxApiServer = this._defaultMaxApiServer();\n      }\n      this._authServer = options.authServer || this._defaultAuthServer();\n      this._fileServer = options.fileServer || this._defaultFileServer();\n      this._downloadServer = options.downloadServer || this._defaultDownloadServer();\n      this._notifyServer = options.notifyServer || this._defaultNotifyServer();\n      this.onXhr = new Dropbox.Util.EventSource({\n        cancelable: true\n      });\n      this.onError = new Dropbox.Util.EventSource;\n      this.onAuthStepChange = new Dropbox.Util.EventSource;\n      this._xhrOnErrorHandler = function(error, callback) {\n        return _this._handleXhrError(error, callback);\n      };\n      this._oauth = new Dropbox.Util.Oauth(options);\n      this._uid = options.uid || null;\n      this.authStep = this._oauth.step();\n      this._driver = null;\n      this.authError = null;\n      this._credentials = null;\n      this.setupUrls();\n    }\n\n    Client.prototype.onXhr = null;\n\n    Client.prototype.onError = null;\n\n    Client.prototype.onAuthStepChange = null;\n\n    Client.prototype.authDriver = function(driver) {\n      this._driver = driver;\n      return this;\n    };\n\n    Client.prototype.dropboxUid = function() {\n      return this._uid;\n    };\n\n    Client.prototype.credentials = function() {\n      if (!this._credentials) {\n        this._computeCredentials();\n      }\n      return this._credentials;\n    };\n\n    Client.prototype.authenticate = function(options, callback) {\n      var interactive, oldAuthStep, _fsmErrorStep, _fsmNextStep, _fsmStep,\n        _this = this;\n      if (!callback && typeof options === 'function') {\n        callback = options;\n        options = null;\n      }\n      if (options && 'interactive' in options) {\n        interactive = options.interactive;\n      } else {\n        interactive = true;\n      }\n      if (!(this._driver || this.authStep === DbxClient.DONE)) {\n        Dropbox.AuthDriver.autoConfigure(this);\n        if (!this._driver) {\n          throw new Error('OAuth driver auto-configuration failed. Call authDriver.');\n        }\n      }\n      if (this.authStep === DbxClient.ERROR) {\n        throw new Error('Client got in an error state. Call reset() to reuse it!');\n      }\n      _fsmNextStep = function() {\n        _this.authStep = _this._oauth.step();\n        if (_this.authStep === DbxClient.ERROR) {\n          _this.authError = _this._oauth.error();\n        }\n        _this._credentials = null;\n        _this.onAuthStepChange.dispatch(_this);\n        return _fsmStep();\n      };\n      _fsmErrorStep = function() {\n        _this.authStep = DbxClient.ERROR;\n        _this._credentials = null;\n        _this.onAuthStepChange.dispatch(_this);\n        return _fsmStep();\n      };\n      oldAuthStep = null;\n      _fsmStep = function() {\n        var authUrl;\n        if (oldAuthStep !== _this.authStep) {\n          oldAuthStep = _this.authStep;\n          if (_this._driver && _this._driver.onAuthStepChange) {\n            _this._driver.onAuthStepChange(_this, _fsmStep);\n            return;\n          }\n        }\n        switch (_this.authStep) {\n          case DbxClient.RESET:\n            if (!interactive) {\n              if (callback) {\n                callback(null, _this);\n              }\n              return;\n            }\n            if (_this._driver.getStateParam) {\n              _this._driver.getStateParam(function(stateParam) {\n                if (_this.client.authStep === DbxClient.RESET) {\n                  _this._oauth.setAuthStateParam(stateParam);\n                }\n                return _fsmNextStep();\n              });\n            }\n            _this._oauth.setAuthStateParam(Dropbox.Util.Oauth.randomAuthStateParam());\n            return _fsmNextStep();\n          case DbxClient.PARAM_SET:\n            if (!interactive) {\n              if (callback) {\n                callback(null, _this);\n              }\n              return;\n            }\n            authUrl = _this.authorizeUrl();\n            return _this._driver.doAuthorize(authUrl, _this._oauth.authStateParam(), _this, function(queryParams) {\n              _this._oauth.processRedirectParams(queryParams);\n              if (queryParams.uid) {\n                _this._uid = queryParams.uid;\n              }\n              return _fsmNextStep();\n            });\n          case DbxClient.PARAM_LOADED:\n            if (!_this._driver.resumeAuthorize) {\n              _this._oauth.setAuthStateParam(_this._oauth.authStateParam());\n              _fsmNextStep();\n              return;\n            }\n            return _this._driver.resumeAuthorize(_this._oauth.authStateParam(), _this, function(queryParams) {\n              _this._oauth.processRedirectParams(queryParams);\n              if (queryParams.uid) {\n                _this._uid = queryParams.uid;\n              }\n              return _fsmNextStep();\n            });\n          case DbxClient.AUTHORIZED:\n            return _this.getAccessToken(function(error, data) {\n              if (error) {\n                _this.authError = error;\n                return _fsmErrorStep();\n              } else {\n                _this._oauth.processRedirectParams(data);\n                _this._uid = data.uid;\n                return _fsmNextStep();\n              }\n            });\n          case DbxClient.DONE:\n            if (callback) {\n              callback(null, _this);\n            }\n            break;\n          case DbxClient.SIGNED_OUT:\n            _this.authStep = DbxClient.RESET;\n            _this.reset();\n            return _fsmStep();\n          case DbxClient.ERROR:\n            if (callback) {\n              callback(_this.authError, _this);\n            }\n        }\n      };\n      _fsmStep();\n      return this;\n    };\n\n    Client.prototype.isAuthenticated = function() {\n      return this.authStep === DbxClient.DONE;\n    };\n\n    Client.prototype.signOut = function(options, callback) {\n      var stopOnXhrError, xhr,\n        _this = this;\n      if (!callback && typeof options === 'function') {\n        callback = options;\n        options = null;\n      }\n      stopOnXhrError = options && options.mustInvalidate;\n      if (this.authStep !== DbxClient.DONE) {\n        throw new Error(\"This client doesn't have a user's token\");\n      }\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.signOut);\n      xhr.signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error) {\n        if (error) {\n          if (error.status === Dropbox.ApiError.INVALID_TOKEN) {\n            error = null;\n          } else if (stopOnXhrError) {\n            if (callback) {\n              callback(error);\n            }\n            return;\n          }\n        }\n        _this.authStep = DbxClient.RESET;\n        _this.reset();\n        _this.authStep = DbxClient.SIGNED_OUT;\n        _this.onAuthStepChange.dispatch(_this);\n        if (_this._driver && _this._driver.onAuthStepChange) {\n          return _this._driver.onAuthStepChange(_this, function() {\n            if (callback) {\n              return callback(null);\n            }\n          });\n        } else {\n          if (callback) {\n            return callback(null);\n          }\n        }\n      });\n    };\n\n    Client.prototype.signOff = function(options, callback) {\n      return this.signOut(options, callback);\n    };\n\n    Client.prototype.getAccountInfo = function(options, callback) {\n      var httpCache, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      httpCache = false;\n      if (options && options.httpCache) {\n        httpCache = true;\n      }\n      xhr = new Dropbox.Util.Xhr('GET', this._urls.accountInfo);\n      xhr.signWithOauth(this._oauth, httpCache);\n      return this._dispatchXhr(xhr, function(error, accountData) {\n        return callback(error, Dropbox.AccountInfo.parse(accountData), accountData);\n      });\n    };\n\n    Client.prototype.getUserInfo = function(options, callback) {\n      return this.getAccountInfo(options, callback);\n    };\n\n    Client.prototype.readFile = function(path, options, callback) {\n      var httpCache, params, rangeEnd, rangeHeader, rangeStart, responseType, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {};\n      responseType = 'text';\n      rangeHeader = null;\n      httpCache = false;\n      if (options) {\n        if (options.versionTag) {\n          params.rev = options.versionTag;\n        } else if (options.rev) {\n          params.rev = options.rev;\n        }\n        if (options.arrayBuffer) {\n          responseType = 'arraybuffer';\n        } else if (options.blob) {\n          responseType = 'blob';\n        } else if (options.buffer) {\n          responseType = 'buffer';\n        } else if (options.binary) {\n          responseType = 'b';\n        }\n        if (options.length) {\n          if (options.start != null) {\n            rangeStart = options.start;\n            rangeEnd = options.start + options.length - 1;\n          } else {\n            rangeStart = '';\n            rangeEnd = options.length;\n          }\n          rangeHeader = \"bytes=\" + rangeStart + \"-\" + rangeEnd;\n        } else if (options.start != null) {\n          rangeHeader = \"bytes=\" + options.start + \"-\";\n        }\n        if (options.httpCache) {\n          httpCache = true;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.getFile + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth, httpCache);\n      xhr.setResponseType(responseType);\n      if (rangeHeader) {\n        if (rangeHeader) {\n          xhr.setHeader('Range', rangeHeader);\n        }\n        xhr.reportResponseHeaders();\n      }\n      return this._dispatchXhr(xhr, function(error, data, metadata, headers) {\n        var rangeInfo;\n        if (headers) {\n          rangeInfo = Dropbox.Http.RangeInfo.parse(headers['content-range']);\n        } else {\n          rangeInfo = null;\n        }\n        return callback(error, data, Dropbox.File.Stat.parse(metadata), rangeInfo);\n      });\n    };\n\n    Client.prototype.writeFile = function(path, data, options, callback) {\n      var useForm;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      useForm = Dropbox.Util.Xhr.canSendForms && typeof data === 'object';\n      if (useForm) {\n        return this._writeFileUsingForm(path, data, options, callback);\n      } else {\n        return this._writeFileUsingPut(path, data, options, callback);\n      }\n    };\n\n    Client.prototype._writeFileUsingForm = function(path, data, options, callback) {\n      var fileName, params, slashIndex, xhr;\n      slashIndex = path.lastIndexOf('/');\n      if (slashIndex === -1) {\n        fileName = path;\n        path = '';\n      } else {\n        fileName = path.substring(slashIndex);\n        path = path.substring(0, slashIndex);\n      }\n      params = {\n        file: fileName\n      };\n      if (options) {\n        if (options.noOverwrite) {\n          params.overwrite = 'false';\n        }\n        if (options.lastVersionTag) {\n          params.parent_rev = options.lastVersionTag;\n        } else if (options.parentRev || options.parent_rev) {\n          params.parent_rev = options.parentRev || options.parent_rev;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('POST', \"\" + this._urls.postFile + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth).setFileField('file', fileName, data, 'application/octet-stream');\n      delete params.file;\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype._writeFileUsingPut = function(path, data, options, callback) {\n      var params, xhr;\n      params = {};\n      if (options) {\n        if (options.noOverwrite) {\n          params.overwrite = 'false';\n        }\n        if (options.lastVersionTag) {\n          params.parent_rev = options.lastVersionTag;\n        } else if (options.parentRev || options.parent_rev) {\n          params.parent_rev = options.parentRev || options.parent_rev;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('POST', \"\" + this._urls.putFile + \"/\" + (this._urlEncodePath(path)));\n      xhr.setBody(data).setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.resumableUploadStep = function(data, cursor, callback) {\n      var params, xhr;\n      if (cursor) {\n        params = {\n          offset: cursor.offset\n        };\n        if (cursor.tag) {\n          params.upload_id = cursor.tag;\n        }\n      } else {\n        params = {\n          offset: 0\n        };\n      }\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.chunkedUpload);\n      xhr.setBody(data).setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, cursor) {\n        if (error && error.status === Dropbox.ApiError.INVALID_PARAM && error.response && error.response.upload_id && error.response.offset) {\n          return callback(null, Dropbox.Http.UploadCursor.parse(error.response));\n        } else {\n          return callback(error, Dropbox.Http.UploadCursor.parse(cursor));\n        }\n      });\n    };\n\n    Client.prototype.resumableUploadFinish = function(path, cursor, options, callback) {\n      var params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {\n        upload_id: cursor.tag\n      };\n      if (options) {\n        if (options.lastVersionTag) {\n          params.parent_rev = options.lastVersionTag;\n        } else if (options.parentRev || options.parent_rev) {\n          params.parent_rev = options.parentRev || options.parent_rev;\n        }\n        if (options.noOverwrite) {\n          params.overwrite = 'false';\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('POST', \"\" + this._urls.commitChunkedUpload + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.stat = function(path, options, callback) {\n      var httpCache, params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {};\n      httpCache = false;\n      if (options) {\n        if (options.versionTag) {\n          params.rev = options.versionTag;\n        } else if (options.rev) {\n          params.rev = options.rev;\n        }\n        if (options.contentHash) {\n          params.hash = options.contentHash;\n        } else if (options.hash) {\n          params.hash = options.hash;\n        }\n        if (options.removed || options.deleted) {\n          params.include_deleted = 'true';\n        }\n        if (options.readDir) {\n          params.list = 'true';\n          if (options.readDir !== true) {\n            params.file_limit = options.readDir.toString();\n          }\n        }\n        if (options.cacheHash) {\n          params.hash = options.cacheHash;\n        }\n        if (options.httpCache) {\n          httpCache = true;\n        }\n      }\n      params.include_deleted || (params.include_deleted = 'false');\n      params.list || (params.list = 'false');\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.metadata + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth, httpCache);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        var entries, entry, stat;\n        stat = Dropbox.File.Stat.parse(metadata);\n        if (metadata != null ? metadata.contents : void 0) {\n          entries = (function() {\n            var _i, _len, _ref, _results;\n            _ref = metadata.contents;\n            _results = [];\n            for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n              entry = _ref[_i];\n              _results.push(Dropbox.File.Stat.parse(entry));\n            }\n            return _results;\n          })();\n        } else {\n          entries = void 0;\n        }\n        return callback(error, stat, entries);\n      });\n    };\n\n    Client.prototype.readdir = function(path, options, callback) {\n      var statOptions;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      statOptions = {\n        readDir: true\n      };\n      if (options) {\n        if (options.limit != null) {\n          statOptions.readDir = options.limit;\n        }\n        if (options.versionTag) {\n          statOptions.versionTag = options.versionTag;\n        } else if (options.rev) {\n          statOptions.versionTag = options.rev;\n        }\n        if (options.contentHash) {\n          statOptions.contentHash = options.contentHash;\n        } else if (options.hash) {\n          statOptions.contentHash = options.hash;\n        }\n        if (options.removed || options.deleted) {\n          statOptions.removed = options.removed || options.deleted;\n        }\n        if (options.httpCache) {\n          statOptions.httpCache = options.httpCache;\n        }\n      }\n      return this.stat(path, statOptions, function(error, stat, entry_stats) {\n        var entries, entry_stat;\n        if (entry_stats) {\n          entries = (function() {\n            var _i, _len, _results;\n            _results = [];\n            for (_i = 0, _len = entry_stats.length; _i < _len; _i++) {\n              entry_stat = entry_stats[_i];\n              _results.push(entry_stat.name);\n            }\n            return _results;\n          })();\n        } else {\n          entries = null;\n        }\n        return callback(error, entries, stat, entry_stats);\n      });\n    };\n\n    Client.prototype.metadata = function(path, options, callback) {\n      return this.stat(path, options, callback);\n    };\n\n    Client.prototype.makeUrl = function(path, options, callback) {\n      var isDirect, params, url, useDownloadHack, xhr,\n        _this = this;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      if (options && (options['long'] || options.longUrl || options.downloadHack)) {\n        params = {\n          short_url: 'false'\n        };\n      } else {\n        params = {};\n      }\n      path = this._urlEncodePath(path);\n      url = \"\" + this._urls.shares + \"/\" + path;\n      isDirect = false;\n      useDownloadHack = false;\n      if (options) {\n        if (options.downloadHack) {\n          isDirect = true;\n          useDownloadHack = true;\n        } else if (options.download) {\n          isDirect = true;\n          url = \"\" + this._urls.media + \"/\" + path;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('POST', url).setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, urlData) {\n        if (useDownloadHack && (urlData != null ? urlData.url : void 0)) {\n          urlData.url = urlData.url.replace(_this._authServer, _this._downloadServer);\n        }\n        return callback(error, Dropbox.File.ShareUrl.parse(urlData, isDirect));\n      });\n    };\n\n    Client.prototype.history = function(path, options, callback) {\n      var httpCache, params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {};\n      httpCache = false;\n      if (options) {\n        if (options.limit != null) {\n          params.rev_limit = options.limit;\n        }\n        if (options.httpCache) {\n          httpCache = true;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.revisions + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth, httpCache);\n      return this._dispatchXhr(xhr, function(error, versions) {\n        var metadata, stats;\n        if (versions) {\n          stats = (function() {\n            var _i, _len, _results;\n            _results = [];\n            for (_i = 0, _len = versions.length; _i < _len; _i++) {\n              metadata = versions[_i];\n              _results.push(Dropbox.File.Stat.parse(metadata));\n            }\n            return _results;\n          })();\n        } else {\n          stats = void 0;\n        }\n        return callback(error, stats);\n      });\n    };\n\n    Client.prototype.revisions = function(path, options, callback) {\n      return this.history(path, options, callback);\n    };\n\n    Client.prototype.thumbnailUrl = function(path, options) {\n      var xhr;\n      xhr = this.thumbnailXhr(path, options);\n      return xhr.paramsToUrl().url;\n    };\n\n    Client.prototype.readThumbnail = function(path, options, callback) {\n      var responseType, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      responseType = 'b';\n      if (options) {\n        if (options.blob) {\n          responseType = 'blob';\n        }\n        if (options.arrayBuffer) {\n          responseType = 'arraybuffer';\n        }\n        if (options.buffer) {\n          responseType = 'buffer';\n        }\n      }\n      xhr = this.thumbnailXhr(path, options);\n      xhr.setResponseType(responseType);\n      return this._dispatchXhr(xhr, function(error, data, metadata) {\n        return callback(error, data, Dropbox.File.Stat.parse(metadata));\n      });\n    };\n\n    Client.prototype.thumbnailXhr = function(path, options) {\n      var params, xhr;\n      params = {};\n      if (options) {\n        if (options.format) {\n          params.format = options.format;\n        } else if (options.png) {\n          params.format = 'png';\n        }\n        if (options.size) {\n          params.size = options.size;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.thumbnails + \"/\" + (this._urlEncodePath(path)));\n      return xhr.setParams(params).signWithOauth(this._oauth);\n    };\n\n    Client.prototype.revertFile = function(path, versionTag, callback) {\n      var xhr;\n      xhr = new Dropbox.Util.Xhr('POST', \"\" + this._urls.restore + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams({\n        rev: versionTag\n      }).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.restore = function(path, versionTag, callback) {\n      return this.revertFile(path, versionTag, callback);\n    };\n\n    Client.prototype.findByName = function(path, namePattern, options, callback) {\n      var httpCache, params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {\n        query: namePattern\n      };\n      httpCache = false;\n      if (options) {\n        if (options.limit != null) {\n          params.file_limit = options.limit;\n        }\n        if (options.removed || options.deleted) {\n          params.include_deleted = true;\n        }\n        if (options.httpCache) {\n          httpCache = true;\n        }\n      }\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.search + \"/\" + (this._urlEncodePath(path)));\n      xhr.setParams(params).signWithOauth(this._oauth, httpCache);\n      return this._dispatchXhr(xhr, function(error, results) {\n        var metadata, stats;\n        if (results) {\n          stats = (function() {\n            var _i, _len, _results;\n            _results = [];\n            for (_i = 0, _len = results.length; _i < _len; _i++) {\n              metadata = results[_i];\n              _results.push(Dropbox.File.Stat.parse(metadata));\n            }\n            return _results;\n          })();\n        } else {\n          stats = void 0;\n        }\n        return callback(error, stats);\n      });\n    };\n\n    Client.prototype.search = function(path, namePattern, options, callback) {\n      return this.findByName(path, namePattern, options, callback);\n    };\n\n    Client.prototype.makeCopyReference = function(path, callback) {\n      var xhr;\n      xhr = new Dropbox.Util.Xhr('GET', \"\" + this._urls.copyRef + \"/\" + (this._urlEncodePath(path)));\n      xhr.signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, refData) {\n        return callback(error, Dropbox.File.CopyReference.parse(refData));\n      });\n    };\n\n    Client.prototype.copyRef = function(path, callback) {\n      return this.makeCopyReference(path, callback);\n    };\n\n    Client.prototype.pullChanges = function(cursor, callback) {\n      var params, xhr;\n      if ((!callback) && (typeof cursor === 'function')) {\n        callback = cursor;\n        cursor = null;\n      }\n      if (cursor) {\n        if (cursor.cursorTag) {\n          params = {\n            cursor: cursor.cursorTag\n          };\n        } else {\n          params = {\n            cursor: cursor\n          };\n        }\n      } else {\n        params = {};\n      }\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.delta);\n      xhr.setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, deltaInfo) {\n        return callback(error, Dropbox.Http.PulledChanges.parse(deltaInfo));\n      });\n    };\n\n    Client.prototype.delta = function(cursor, callback) {\n      return this.pullChanges(cursor, callback);\n    };\n\n    Client.prototype.pollForChanges = function(cursor, options, callback) {\n      var params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      if (cursor.cursorTag) {\n        params = {\n          cursor: cursor.cursorTag\n        };\n      } else {\n        params = {\n          cursor: cursor\n        };\n      }\n      if (options && 'timeout' in options) {\n        params.timeout = options.timeout;\n      }\n      xhr = new Dropbox.Util.Xhr('GET', this._urls.longpollDelta);\n      xhr.setParams(params);\n      return this._dispatchXhr(xhr, function(error, response) {\n        var jsonError;\n        if (typeof response === 'string') {\n          try {\n            response = JSON.parse(response);\n          } catch (_error) {\n            jsonError = _error;\n            response = null;\n          }\n        }\n        return callback(error, Dropbox.Http.PollResult.parse(response));\n      });\n    };\n\n    Client.prototype.mkdir = function(path, callback) {\n      var xhr;\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.fileopsCreateFolder);\n      xhr.setParams({\n        root: 'auto',\n        path: this._normalizePath(path)\n      }).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.remove = function(path, callback) {\n      var xhr;\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.fileopsDelete);\n      xhr.setParams({\n        root: 'auto',\n        path: this._normalizePath(path)\n      }).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.unlink = function(path, callback) {\n      return this.remove(path, callback);\n    };\n\n    Client.prototype[\"delete\"] = function(path, callback) {\n      return this.remove(path, callback);\n    };\n\n    Client.prototype.copy = function(from, toPath, callback) {\n      var options, params, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      params = {\n        root: 'auto',\n        to_path: this._normalizePath(toPath)\n      };\n      if (from instanceof Dropbox.File.CopyReference) {\n        params.from_copy_ref = from.tag;\n      } else {\n        params.from_path = this._normalizePath(from);\n      }\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.fileopsCopy);\n      xhr.setParams(params).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.move = function(fromPath, toPath, callback) {\n      var options, xhr;\n      if ((!callback) && (typeof options === 'function')) {\n        callback = options;\n        options = null;\n      }\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.fileopsMove);\n      xhr.setParams({\n        root: 'auto',\n        from_path: this._normalizePath(fromPath),\n        to_path: this._normalizePath(toPath)\n      }).signWithOauth(this._oauth);\n      return this._dispatchXhr(xhr, function(error, metadata) {\n        if (callback) {\n          return callback(error, Dropbox.File.Stat.parse(metadata));\n        }\n      });\n    };\n\n    Client.prototype.appInfo = function(appKey, callback) {\n      var xhr;\n      if ((!callback) && (typeof appKey === 'function')) {\n        callback = appKey;\n        appKey = this._oauth.credentials().key;\n      }\n      xhr = new Dropbox.Util.Xhr('GET', this._urls.appsInfo);\n      xhr.setParams({\n        app_key: appKey\n      });\n      return this._dispatchXhr(xhr, function(error, appInfo) {\n        return callback(error, Dropbox.Http.AppInfo.parse(appInfo, appKey));\n      });\n    };\n\n    Client.prototype.isAppDeveloper = function(userId, appKey, callback) {\n      var xhr;\n      if ((typeof userId === 'object') && ('uid' in userId)) {\n        userId = userId.uid;\n      }\n      if ((!callback) && (typeof appKey === 'function')) {\n        callback = appKey;\n        appKey = this._oauth.credentials().key;\n      } else if ((typeof appKey === 'object') && ('key' in appKey)) {\n        appKey = appKey.key;\n      }\n      xhr = new Dropbox.Util.Xhr('GET', this._urls.appsCheckDeveloper);\n      xhr.setParams({\n        app_key: appKey,\n        uid: userId\n      });\n      return this._dispatchXhr(xhr, function(error, response) {\n        if (response) {\n          return callback(error, response.is_developer);\n        } else {\n          return callback(error);\n        }\n      });\n    };\n\n    Client.prototype.hasOauthRedirectUri = function(redirectUri, appKey, callback) {\n      var xhr;\n      if ((!callback) && (typeof appKey === 'function')) {\n        callback = appKey;\n        appKey = this._oauth.credentials().key;\n      } else if ((typeof appKey === 'object') && ('key' in appKey)) {\n        appKey = appKey.key;\n      }\n      xhr = new Dropbox.Util.Xhr('GET', this._urls.appsCheckRedirectUri);\n      xhr.setParams({\n        app_key: appKey,\n        redirect_uri: redirectUri\n      });\n      return this._dispatchXhr(xhr, function(error, response) {\n        if (response) {\n          return callback(error, response.has_redirect_uri);\n        } else {\n          return callback(error);\n        }\n      });\n    };\n\n    Client.prototype.reset = function() {\n      var oldAuthStep;\n      this._uid = null;\n      this._oauth.reset();\n      oldAuthStep = this.authStep;\n      this.authStep = this._oauth.step();\n      if (oldAuthStep !== this.authStep) {\n        this.onAuthStepChange.dispatch(this);\n      }\n      this.authError = null;\n      this._credentials = null;\n      return this;\n    };\n\n    Client.prototype.setCredentials = function(credentials) {\n      var oldAuthStep;\n      oldAuthStep = this.authStep;\n      this._oauth.setCredentials(credentials);\n      this.authStep = this._oauth.step();\n      this._uid = credentials.uid || null;\n      this.authError = null;\n      this._credentials = null;\n      if (oldAuthStep !== this.authStep) {\n        this.onAuthStepChange.dispatch(this);\n      }\n      return this;\n    };\n\n    Client.prototype.appHash = function() {\n      return this._oauth.appHash();\n    };\n\n    Client.prototype.setupUrls = function() {\n      this._apiServer = this._chooseApiServer();\n      return this._urls = {\n        authorize: \"\" + this._authServer + \"/1/oauth2/authorize\",\n        token: \"\" + this._apiServer + \"/1/oauth2/token\",\n        signOut: \"\" + this._apiServer + \"/1/unlink_access_token\",\n        accountInfo: \"\" + this._apiServer + \"/1/account/info\",\n        getFile: \"\" + this._fileServer + \"/1/files/auto\",\n        postFile: \"\" + this._fileServer + \"/1/files/auto\",\n        putFile: \"\" + this._fileServer + \"/1/files_put/auto\",\n        metadata: \"\" + this._apiServer + \"/1/metadata/auto\",\n        delta: \"\" + this._apiServer + \"/1/delta\",\n        longpollDelta: \"\" + this._notifyServer + \"/1/longpoll_delta\",\n        revisions: \"\" + this._apiServer + \"/1/revisions/auto\",\n        restore: \"\" + this._apiServer + \"/1/restore/auto\",\n        search: \"\" + this._apiServer + \"/1/search/auto\",\n        shares: \"\" + this._apiServer + \"/1/shares/auto\",\n        media: \"\" + this._apiServer + \"/1/media/auto\",\n        copyRef: \"\" + this._apiServer + \"/1/copy_ref/auto\",\n        thumbnails: \"\" + this._fileServer + \"/1/thumbnails/auto\",\n        chunkedUpload: \"\" + this._fileServer + \"/1/chunked_upload\",\n        commitChunkedUpload: \"\" + this._fileServer + \"/1/commit_chunked_upload/auto\",\n        fileopsCopy: \"\" + this._apiServer + \"/1/fileops/copy\",\n        fileopsCreateFolder: \"\" + this._apiServer + \"/1/fileops/create_folder\",\n        fileopsDelete: \"\" + this._apiServer + \"/1/fileops/delete\",\n        fileopsMove: \"\" + this._apiServer + \"/1/fileops/move\",\n        appsInfo: \"\" + this._apiServer + \"/1/apps/info\",\n        appsCheckDeveloper: \"\" + this._apiServer + \"/1/apps/check_developer\",\n        appsCheckRedirectUri: \"\" + this._apiServer + \"/1/apps/check_redirect_uri\"\n      };\n    };\n\n    Client.prototype._chooseApiServer = function() {\n      var serverId, serverNumber;\n      serverNumber = Math.floor(Math.random() * (this._maxApiServer + 1));\n      serverId = serverNumber === 0 ? '' : serverNumber.toString();\n      return this._serverRoot.replace('$', serverId);\n    };\n\n    Client.prototype.authStep = null;\n\n    Client.ERROR = 0;\n\n    Client.RESET = 1;\n\n    Client.PARAM_SET = 2;\n\n    Client.PARAM_LOADED = 3;\n\n    Client.AUTHORIZED = 4;\n\n    Client.DONE = 5;\n\n    Client.SIGNED_OUT = 6;\n\n    Client.prototype._urlEncodePath = function(path) {\n      return Dropbox.Util.Xhr.urlEncodeValue(this._normalizePath(path)).replace(/%2F/gi, '/');\n    };\n\n    Client.prototype._normalizePath = function(path) {\n      var i;\n      if (path.substring(0, 1) === '/') {\n        i = 1;\n        while (path.substring(i, i + 1) === '/') {\n          i += 1;\n        }\n        return path.substring(i);\n      } else {\n        return path;\n      }\n    };\n\n    Client.prototype.authorizeUrl = function() {\n      var params;\n      params = this._oauth.authorizeUrlParams(this._driver.authType(), this._driver.url());\n      return this._urls.authorize + \"?\" + Dropbox.Util.Xhr.urlEncode(params);\n    };\n\n    Client.prototype.getAccessToken = function(callback) {\n      var params, xhr;\n      params = this._oauth.accessTokenParams(this._driver.url());\n      xhr = new Dropbox.Util.Xhr('POST', this._urls.token).setParams(params).addOauthParams(this._oauth);\n      return this._dispatchXhr(xhr, function(error, data) {\n        if (error && error.status === Dropbox.ApiError.INVALID_PARAM && error.response && error.response.error) {\n          error = new Dropbox.AuthError(error.response);\n        }\n        return callback(error, data);\n      });\n    };\n\n    Client.prototype._dispatchXhr = function(xhr, callback) {\n      var nativeXhr;\n      xhr.setCallback(callback);\n      xhr.onError = this._xhrOnErrorHandler;\n      xhr.prepare();\n      nativeXhr = xhr.xhr;\n      if (this.onXhr.dispatch(xhr)) {\n        xhr.send();\n      }\n      return nativeXhr;\n    };\n\n    Client.prototype._handleXhrError = function(error, callback) {\n      var _this = this;\n      if (error.status === Dropbox.ApiError.INVALID_TOKEN && this.authStep === DbxClient.DONE) {\n        this.authError = error;\n        this.authStep = DbxClient.ERROR;\n        this.onAuthStepChange.dispatch(this);\n        if (this._driver && this._driver.onAuthStepChange) {\n          this._driver.onAuthStepChange(this, function() {\n            _this.onError.dispatch(error);\n            return callback(error);\n          });\n          return null;\n        }\n      }\n      this.onError.dispatch(error);\n      callback(error);\n    };\n\n    Client.prototype._defaultServerRoot = function() {\n      return 'https://api$.dropbox.com';\n    };\n\n    Client.prototype._defaultAuthServer = function() {\n      return this._serverRoot.replace('api$', 'www');\n    };\n\n    Client.prototype._defaultFileServer = function() {\n      return this._serverRoot.replace('api$', 'api-content');\n    };\n\n    Client.prototype._defaultDownloadServer = function() {\n      return 'https://dl.dropboxusercontent.com';\n    };\n\n    Client.prototype._defaultNotifyServer = function() {\n      return this._serverRoot.replace('api$', 'api-notify');\n    };\n\n    Client.prototype._defaultMaxApiServer = function() {\n      return 30;\n    };\n\n    Client.prototype._computeCredentials = function() {\n      var value;\n      value = this._oauth.credentials();\n      if (this._uid) {\n        value.uid = this._uid;\n      }\n      if (this._serverRoot !== this._defaultServerRoot()) {\n        value.server = this._serverRoot;\n      }\n      if (this._maxApiServer !== this._defaultMaxApiServer()) {\n        value.maxApiServer = this._maxApiServer;\n      }\n      if (this._authServer !== this._defaultAuthServer()) {\n        value.authServer = this._authServer;\n      }\n      if (this._fileServer !== this._defaultFileServer()) {\n        value.fileServer = this._fileServer;\n      }\n      if (this._downloadServer !== this._defaultDownloadServer()) {\n        value.downloadServer = this._downloadServer;\n      }\n      if (this._notifyServer !== this._defaultNotifyServer()) {\n        value.notifyServer = this._notifyServer;\n      }\n      this._credentials = value;\n    };\n\n    return Client;\n\n  })();\n\n  DbxClient = Dropbox.Client;\n\n  Dropbox.File.ShareUrl = (function() {\n    ShareUrl.parse = function(urlData, isDirect) {\n      if (urlData && typeof urlData === 'object') {\n        return new Dropbox.File.ShareUrl(urlData, isDirect);\n      } else {\n        return urlData;\n      }\n    };\n\n    ShareUrl.prototype.url = null;\n\n    ShareUrl.prototype.expiresAt = null;\n\n    ShareUrl.prototype.isDirect = null;\n\n    ShareUrl.prototype.isPreview = null;\n\n    ShareUrl.prototype.json = function() {\n      return this._json || (this._json = {\n        url: this.url,\n        expires: this.expiresAt.toUTCString(),\n        direct: this.isDirect\n      });\n    };\n\n    function ShareUrl(urlData, isDirect) {\n      this.url = urlData.url;\n      this.expiresAt = Dropbox.Util.parseDate(urlData.expires);\n      if (isDirect === true) {\n        this.isDirect = true;\n      } else if (isDirect === false) {\n        this.isDirect = false;\n      } else {\n        if ('direct' in urlData) {\n          this.isDirect = urlData.direct;\n        } else {\n          this.isDirect = Date.now() - this.expiresAt <= 86400000;\n        }\n      }\n      this.isPreview = !this.isDirect;\n      this._json = null;\n    }\n\n    return ShareUrl;\n\n  })();\n\n  Dropbox.File.CopyReference = (function() {\n    CopyReference.parse = function(refData) {\n      if (refData && (typeof refData === 'object' || typeof refData === 'string')) {\n        return new Dropbox.File.CopyReference(refData);\n      } else {\n        return refData;\n      }\n    };\n\n    CopyReference.prototype.tag = null;\n\n    CopyReference.prototype.expiresAt = null;\n\n    CopyReference.prototype.json = function() {\n      return this._json || (this._json = {\n        copy_ref: this.tag,\n        expires: this.expiresAt.toUTCString()\n      });\n    };\n\n    function CopyReference(refData) {\n      if (typeof refData === 'object') {\n        this.tag = refData.copy_ref;\n        this.expiresAt = Dropbox.Util.parseDate(refData.expires);\n        this._json = refData;\n      } else {\n        this.tag = refData;\n        this.expiresAt = new Date(Math.ceil(Date.now() / 1000) * 1000);\n        this._json = null;\n      }\n    }\n\n    return CopyReference;\n\n  })();\n\n  Dropbox.File.Stat = (function() {\n    Stat.parse = function(metadata) {\n      if (metadata && typeof metadata === 'object') {\n        return new Dropbox.File.Stat(metadata);\n      } else {\n        return metadata;\n      }\n    };\n\n    Stat.prototype.path = null;\n\n    Stat.prototype.name = null;\n\n    Stat.prototype.inAppFolder = null;\n\n    Stat.prototype.isFolder = null;\n\n    Stat.prototype.isFile = null;\n\n    Stat.prototype.isRemoved = null;\n\n    Stat.prototype.typeIcon = null;\n\n    Stat.prototype.versionTag = null;\n\n    Stat.prototype.contentHash = null;\n\n    Stat.prototype.mimeType = null;\n\n    Stat.prototype.size = null;\n\n    Stat.prototype.humanSize = null;\n\n    Stat.prototype.hasThumbnail = null;\n\n    Stat.prototype.modifiedAt = null;\n\n    Stat.prototype.clientModifiedAt = null;\n\n    Stat.prototype.json = function() {\n      return this._json;\n    };\n\n    function Stat(metadata) {\n      var lastIndex, nameSlash, _ref, _ref1;\n      this._json = metadata;\n      this.path = metadata.path;\n      if (this.path.substring(0, 1) !== '/') {\n        this.path = '/' + this.path;\n      }\n      lastIndex = this.path.length - 1;\n      if (lastIndex >= 0 && this.path.substring(lastIndex) === '/') {\n        this.path = this.path.substring(0, lastIndex);\n      }\n      nameSlash = this.path.lastIndexOf('/');\n      this.name = this.path.substring(nameSlash + 1);\n      this.isFolder = metadata.is_dir || false;\n      this.isFile = !this.isFolder;\n      this.isRemoved = metadata.is_deleted || false;\n      this.typeIcon = metadata.icon;\n      if ((_ref = metadata.modified) != null ? _ref.length : void 0) {\n        this.modifiedAt = Dropbox.Util.parseDate(metadata.modified);\n      } else {\n        this.modifiedAt = null;\n      }\n      if ((_ref1 = metadata.client_mtime) != null ? _ref1.length : void 0) {\n        this.clientModifiedAt = Dropbox.Util.parseDate(metadata.client_mtime);\n      } else {\n        this.clientModifiedAt = null;\n      }\n      switch (metadata.root) {\n        case 'dropbox':\n          this.inAppFolder = false;\n          break;\n        case 'app_folder':\n          this.inAppFolder = true;\n          break;\n        default:\n          this.inAppFolder = null;\n      }\n      this.size = metadata.bytes || 0;\n      this.humanSize = metadata.size || '';\n      this.hasThumbnail = metadata.thumb_exists || false;\n      this.versionTag = metadata.rev;\n      this.contentHash = metadata.hash || null;\n      if (this.isFolder) {\n        this.mimeType = metadata.mime_type || 'inode/directory';\n      } else {\n        this.mimeType = metadata.mime_type || 'application/octet-stream';\n      }\n    }\n\n    return Stat;\n\n  })();\n\n  Dropbox.Http.AppInfo = (function() {\n    AppInfo.parse = function(appInfo, appKey) {\n      if (appInfo) {\n        return new Dropbox.Http.AppInfo(appInfo, appKey);\n      } else {\n        return appInfo;\n      }\n    };\n\n    AppInfo.prototype.name = void 0;\n\n    AppInfo.prototype.key = void 0;\n\n    AppInfo.prototype.canUseDatastores = void 0;\n\n    AppInfo.prototype.canUseFiles = void 0;\n\n    AppInfo.prototype.hasAppFolder = void 0;\n\n    AppInfo.prototype.canUseFullDropbox = void 0;\n\n    AppInfo.prototype.icon = function(width, height) {\n      height || (height = width);\n      return this._icons[\"\" + width + \"x\" + height] || null;\n    };\n\n    AppInfo.ICON_SMALL = 64;\n\n    AppInfo.ICON_LARGE = 256;\n\n    function AppInfo(appInfo, appKey) {\n      var permissions;\n      this.name = appInfo.name;\n      this._icons = appInfo.icons;\n      permissions = appInfo.permissions || {};\n      this.canUseDatastores = !!permissions.datastores;\n      this.canUseFiles = !!permissions.files;\n      this.canUseFullDropbox = permissions.files === 'full_dropbox';\n      this.hasAppFolder = permissions.files === 'app_folder';\n      if (appKey) {\n        this.key = appKey;\n      } else {\n        this.key = appInfo.key || null;\n      }\n    }\n\n    return AppInfo;\n\n  })();\n\n  Dropbox.Http.PulledChanges = (function() {\n    PulledChanges.parse = function(deltaInfo) {\n      if (deltaInfo && typeof deltaInfo === 'object') {\n        return new Dropbox.Http.PulledChanges(deltaInfo);\n      } else {\n        return deltaInfo;\n      }\n    };\n\n    PulledChanges.prototype.blankSlate = void 0;\n\n    PulledChanges.prototype.cursorTag = void 0;\n\n    PulledChanges.prototype.changes = void 0;\n\n    PulledChanges.prototype.shouldPullAgain = void 0;\n\n    PulledChanges.prototype.shouldBackOff = void 0;\n\n    PulledChanges.prototype.cursor = function() {\n      return this.cursorTag;\n    };\n\n    function PulledChanges(deltaInfo) {\n      var entry;\n      this.blankSlate = deltaInfo.reset || false;\n      this.cursorTag = deltaInfo.cursor;\n      this.shouldPullAgain = deltaInfo.has_more;\n      this.shouldBackOff = !this.shouldPullAgain;\n      if (deltaInfo.cursor && deltaInfo.cursor.length) {\n        this.changes = (function() {\n          var _i, _len, _ref, _results;\n          _ref = deltaInfo.entries;\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            entry = _ref[_i];\n            _results.push(Dropbox.Http.PulledChange.parse(entry));\n          }\n          return _results;\n        })();\n      } else {\n        this.changes = [];\n      }\n    }\n\n    return PulledChanges;\n\n  })();\n\n  Dropbox.Http.PulledChange = (function() {\n    PulledChange.parse = function(entry) {\n      if (entry && typeof entry === 'object') {\n        return new Dropbox.Http.PulledChange(entry);\n      } else {\n        return entry;\n      }\n    };\n\n    PulledChange.prototype.path = void 0;\n\n    PulledChange.prototype.wasRemoved = void 0;\n\n    PulledChange.prototype.stat = void 0;\n\n    function PulledChange(entry) {\n      this.path = entry[0];\n      this.stat = Dropbox.File.Stat.parse(entry[1]);\n      if (this.stat) {\n        this.wasRemoved = false;\n      } else {\n        this.stat = null;\n        this.wasRemoved = true;\n      }\n    }\n\n    return PulledChange;\n\n  })();\n\n  Dropbox.Http.PollResult = (function() {\n    PollResult.parse = function(response) {\n      if (response) {\n        return new Dropbox.Http.PollResult(response);\n      } else {\n        return response;\n      }\n    };\n\n    PollResult.prototype.hasChanges = void 0;\n\n    PollResult.prototype.retryAfter = void 0;\n\n    function PollResult(response) {\n      this.hasChanges = response.changes;\n      this.retryAfter = response.backoff || 0;\n    }\n\n    return PollResult;\n\n  })();\n\n  Dropbox.Http.RangeInfo = (function() {\n    RangeInfo.parse = function(headerValue) {\n      if (typeof headerValue === 'string') {\n        return new Dropbox.Http.RangeInfo(headerValue);\n      } else {\n        return headerValue;\n      }\n    };\n\n    RangeInfo.prototype.start = null;\n\n    RangeInfo.prototype.size = null;\n\n    RangeInfo.prototype.end = null;\n\n    function RangeInfo(headerValue) {\n      var match;\n      if (match = /^bytes (\\d*)-(\\d*)\\/(.*)$/.exec(headerValue)) {\n        this.start = parseInt(match[1]);\n        this.end = parseInt(match[2]);\n        if (match[3] === '*') {\n          this.size = null;\n        } else {\n          this.size = parseInt(match[3]);\n        }\n      } else {\n        this.start = 0;\n        this.end = 0;\n        this.size = null;\n      }\n    }\n\n    return RangeInfo;\n\n  })();\n\n  Dropbox.Http.UploadCursor = (function() {\n    UploadCursor.parse = function(cursorData) {\n      if (cursorData && (typeof cursorData === 'object' || typeof cursorData === 'string')) {\n        return new Dropbox.Http.UploadCursor(cursorData);\n      } else {\n        return cursorData;\n      }\n    };\n\n    UploadCursor.prototype.tag = null;\n\n    UploadCursor.prototype.offset = null;\n\n    UploadCursor.prototype.expiresAt = null;\n\n    UploadCursor.prototype.json = function() {\n      return this._json || (this._json = {\n        upload_id: this.tag,\n        offset: this.offset,\n        expires: this.expiresAt.toUTCString()\n      });\n    };\n\n    function UploadCursor(cursorData) {\n      this.replace(cursorData);\n    }\n\n    UploadCursor.prototype.replace = function(cursorData) {\n      if (typeof cursorData === 'object') {\n        this.tag = cursorData.upload_id || null;\n        this.offset = cursorData.offset || 0;\n        this.expiresAt = Dropbox.Util.parseDate(cursorData.expires) || Date.now();\n        this._json = cursorData;\n      } else {\n        this.tag = cursorData || null;\n        this.offset = 0;\n        this.expiresAt = new Date(Math.floor(Date.now() / 1000) * 1000);\n        this._json = null;\n      }\n      return this;\n    };\n\n    return UploadCursor;\n\n  })();\n\n  if (typeof Dropbox.Env.global.atob === 'function' && typeof Dropbox.Env.global.btoa === 'function') {\n    Dropbox.Util.atob = function(string) {\n      return Dropbox.Env.global.atob(string);\n    };\n    Dropbox.Util.btoa = function(base64) {\n      return Dropbox.Env.global.btoa(base64);\n    };\n  } else if (Dropbox.Env.global.require && Dropbox.Env.global.Buffer) {\n    Dropbox.Util.atob = function(arg) {\n      var buffer, i;\n      buffer = new Buffer(arg, 'base64');\n      return ((function() {\n        var _i, _ref, _results;\n        _results = [];\n        for (i = _i = 0, _ref = buffer.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n          _results.push(String.fromCharCode(buffer[i]));\n        }\n        return _results;\n      })()).join('');\n    };\n    Dropbox.Util.btoa = function(arg) {\n      var buffer, i;\n      buffer = new Buffer((function() {\n        var _i, _ref, _results;\n        _results = [];\n        for (i = _i = 0, _ref = arg.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n          _results.push(arg.charCodeAt(i));\n        }\n        return _results;\n      })());\n      return buffer.toString('base64');\n    };\n  } else {\n    (function() {\n      var atobNibble, base64Digits, btoaNibble;\n      base64Digits = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n      btoaNibble = function(accumulator, bytes, result) {\n        var i, limit;\n        limit = 3 - bytes;\n        accumulator <<= limit * 8;\n        i = 3;\n        while (i >= limit) {\n          result.push(base64Digits.charAt((accumulator >> (i * 6)) & 0x3F));\n          i -= 1;\n        }\n        i = bytes;\n        while (i < 3) {\n          result.push('=');\n          i += 1;\n        }\n        return null;\n      };\n      atobNibble = function(accumulator, digits, result) {\n        var i, limit;\n        limit = 4 - digits;\n        accumulator <<= limit * 6;\n        i = 2;\n        while (i >= limit) {\n          result.push(String.fromCharCode((accumulator >> (8 * i)) & 0xFF));\n          i -= 1;\n        }\n        return null;\n      };\n      Dropbox.Util.btoa = function(string) {\n        var accumulator, bytes, i, result, _i, _ref;\n        result = [];\n        accumulator = 0;\n        bytes = 0;\n        for (i = _i = 0, _ref = string.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n          accumulator = (accumulator << 8) | string.charCodeAt(i);\n          bytes += 1;\n          if (bytes === 3) {\n            btoaNibble(accumulator, bytes, result);\n            accumulator = bytes = 0;\n          }\n        }\n        if (bytes > 0) {\n          btoaNibble(accumulator, bytes, result);\n        }\n        return result.join('');\n      };\n      return Dropbox.Util.atob = function(base64) {\n        var accumulator, digit, digits, i, result, _i, _ref;\n        result = [];\n        accumulator = 0;\n        digits = 0;\n        for (i = _i = 0, _ref = base64.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n          digit = base64.charAt(i);\n          if (digit === '=') {\n            break;\n          }\n          accumulator = (accumulator << 6) | base64Digits.indexOf(digit);\n          digits += 1;\n          if (digits === 4) {\n            atobNibble(accumulator, digits, result);\n            accumulator = digits = 0;\n          }\n        }\n        if (digits > 0) {\n          atobNibble(accumulator, digits, result);\n        }\n        return result.join('');\n      };\n    })();\n  }\n\n  (function() {\n    var arrayToBase64, crypto, hmacSha1, requireError, sha1, sha256, sha256Init, sha256Key, stringToArray, xxx, _base64Digits;\n    Dropbox.Util.hmac = function(string, key) {\n      return arrayToBase64(hmacSha1(stringToArray(string), stringToArray(key), string.length, key.length));\n    };\n    Dropbox.Util.sha1 = function(string) {\n      return arrayToBase64(sha1(stringToArray(string), string.length));\n    };\n    Dropbox.Util.sha256 = function(string) {\n      return arrayToBase64(sha256(stringToArray(string), string.length));\n    };\n    if (Dropbox.Env.require) {\n      try {\n        crypto = Dropbox.Env.require('crypto');\n        if (crypto.createHmac && crypto.createHash) {\n          Dropbox.Util.hmac = function(string, key) {\n            var hmac;\n            hmac = crypto.createHmac('sha1', key);\n            hmac.update(string);\n            return hmac.digest('base64');\n          };\n          Dropbox.Util.sha1 = function(string) {\n            var hash;\n            hash = crypto.createHash('sha1');\n            hash.update(string);\n            return hash.digest('base64');\n          };\n          Dropbox.Util.sha256 = function(string) {\n            var hash;\n            hash = crypto.createHash('sha256');\n            hash.update(string);\n            return hash.digest('base64');\n          };\n        }\n      } catch (_error) {\n        requireError = _error;\n      }\n    }\n    hmacSha1 = function(string, key, length, keyLength) {\n      var hash1, i, ipad, opad;\n      if (key.length > 16) {\n        key = sha1(key, keyLength);\n      }\n      ipad = (function() {\n        var _i, _results;\n        _results = [];\n        for (i = _i = 0; _i < 16; i = ++_i) {\n          _results.push(key[i] ^ 0x36363636);\n        }\n        return _results;\n      })();\n      opad = (function() {\n        var _i, _results;\n        _results = [];\n        for (i = _i = 0; _i < 16; i = ++_i) {\n          _results.push(key[i] ^ 0x5C5C5C5C);\n        }\n        return _results;\n      })();\n      hash1 = sha1(ipad.concat(string), 64 + length);\n      return sha1(opad.concat(hash1), 64 + 20);\n    };\n    sha1 = function(string, length) {\n      var a, a0, b, b0, c, c0, d, d0, e, e0, i, j, limit, n, state, t, _i;\n      string[length >> 2] |= 1 << (31 - ((length & 0x03) << 3));\n      string[(((length + 8) >> 6) << 4) + 15] = length << 3;\n      state = Array(80);\n      a = 0x67452301;\n      b = 0xefcdab89;\n      c = 0x98badcfe;\n      d = 0x10325476;\n      e = 0xc3d2e1f0;\n      i = 0;\n      limit = string.length;\n      while (i < limit) {\n        a0 = a;\n        b0 = b;\n        c0 = c;\n        d0 = d;\n        e0 = e;\n        for (j = _i = 0; _i < 80; j = ++_i) {\n          if (j < 16) {\n            state[j] = string[(i + j) << 2 >> 2] | 0;\n          } else {\n            n = (state[(j - 3) << 2 >> 2] | 0) ^ (state[(j - 8) << 2 >> 2] | 0) ^ (state[(j - 14) << 2 >> 2] | 0) ^ (state[(j - 16) << 2 >> 2] | 0);\n            state[j] = (n << 1) | (n >>> 31);\n          }\n          t = (((((a << 5) | (a >>> 27)) + e) | 0) + state[j << 2 >> 2]) | 0;\n          if (j < 20) {\n            t = (t + ((((b & c) | (~b & d)) + 0x5a827999) | 0)) | 0;\n          } else if (j < 40) {\n            t = (t + (((b ^ c ^ d) + 0x6ed9eba1) | 0)) | 0;\n          } else if (j < 60) {\n            t = (t + (((b & c) | (b & d) | (c & d)) - 0x70e44324) | 0) | 0;\n          } else {\n            t = (t + (((b ^ c ^ d) - 0x359d3e2a) | 0)) | 0;\n          }\n          e = d;\n          d = c;\n          c = (b << 30) | (b >>> 2);\n          b = a;\n          a = t;\n        }\n        a = (a0 + a) | 0;\n        b = (b0 + b) | 0;\n        c = (c0 + c) | 0;\n        d = (d0 + d) | 0;\n        e = (e0 + e) | 0;\n        i = (i + 16) | 0;\n      }\n      return [a, b, c, d, e];\n    };\n    sha256 = function(string, length) {\n      var a, a0, b, b0, c, c0, ch, d, d0, e, e0, f, f0, g, g0, gamma0, gamma0x, gamma1, gamma1x, h, h0, i, j, limit, maj, sigma0, sigma1, sj, state, t1, t2, _i;\n      string[length >> 2] |= 1 << (31 - ((length & 0x03) << 3));\n      string[(((length + 8) >> 6) << 4) + 15] = length << 3;\n      state = Array(80);\n      a = sha256Init[0], b = sha256Init[1], c = sha256Init[2], d = sha256Init[3], e = sha256Init[4], f = sha256Init[5], g = sha256Init[6], h = sha256Init[7];\n      i = 0;\n      limit = string.length;\n      while (i < limit) {\n        a0 = a;\n        b0 = b;\n        c0 = c;\n        d0 = d;\n        e0 = e;\n        f0 = f;\n        g0 = g;\n        h0 = h;\n        for (j = _i = 0; _i < 64; j = ++_i) {\n          if (j < 16) {\n            sj = state[j] = string[(i + j) << 2 >> 2] | 0;\n          } else {\n            gamma0x = state[(j - 15) << 2 >> 2] | 0;\n            gamma0 = ((gamma0x << 25) | (gamma0x >>> 7)) ^ ((gamma0x << 14) | (gamma0x >>> 18)) ^ (gamma0x >>> 3);\n            gamma1x = state[(j - 2) << 2 >> 2] | 0;\n            gamma1 = ((gamma1x << 15) | (gamma1x >>> 17)) ^ ((gamma1x << 13) | (gamma1x >>> 19)) ^ (gamma1x >>> 10);\n            sj = state[j] = (((gamma0 + (state[(j - 7) << 2 >> 2] | 0)) | 0) + ((gamma1 + (state[(j - 16) << 2 >> 2] | 0)) | 0)) | 0;\n          }\n          ch = (e & f) ^ (~e & g);\n          maj = (a & b) ^ (a & c) ^ (b & c);\n          sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n          sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7) | (e >>> 25));\n          t1 = (((((h + sigma1) | 0) + ((ch + sj) | 0)) | 0) + (sha256Key[j << 2 >> 2] | 0)) | 0;\n          t2 = (sigma0 + maj) | 0;\n          h = g;\n          g = f;\n          f = e;\n          e = (d + t1) | 0;\n          d = c;\n          c = b;\n          b = a;\n          a = (t1 + t2) | 0;\n        }\n        a = (a0 + a) | 0;\n        b = (b0 + b) | 0;\n        c = (c0 + c) | 0;\n        d = (d0 + d) | 0;\n        e = (e0 + e) | 0;\n        f = (f0 + f) | 0;\n        g = (g0 + g) | 0;\n        h = (h0 + h) | 0;\n        i += 16;\n      }\n      return [a, b, c, d, e, f, g, h];\n    };\n    xxx = function(n) {\n      if (n < 0) {\n        n = (1 << 30) * 4 + n;\n      }\n      return n.toString(16);\n    };\n    sha256Init = [];\n    sha256Key = [];\n    (function() {\n      var factor, fractional, i, isPrime, prime, _i, _results;\n      fractional = function(x) {\n        return ((x - Math.floor(x)) * 0x100000000) | 0;\n      };\n      prime = 2;\n      _results = [];\n      for (i = _i = 0; _i < 64; i = ++_i) {\n        while (true) {\n          isPrime = true;\n          factor = 2;\n          while (factor * factor <= prime) {\n            if (prime % factor === 0) {\n              isPrime = false;\n              break;\n            }\n            factor += 1;\n          }\n          if (isPrime) {\n            break;\n          }\n          prime += 1;\n          continue;\n        }\n        if (i < 8) {\n          sha256Init[i] = fractional(Math.pow(prime, 1 / 2));\n        }\n        sha256Key[i] = fractional(Math.pow(prime, 1 / 3));\n        _results.push(prime += 1);\n      }\n      return _results;\n    })();\n    arrayToBase64 = function(array) {\n      var i, i2, limit, string, trit;\n      string = \"\";\n      i = 0;\n      limit = array.length * 4;\n      while (i < limit) {\n        i2 = i;\n        trit = ((array[i2 >> 2] >> ((3 - (i2 & 3)) << 3)) & 0xFF) << 16;\n        i2 += 1;\n        trit |= ((array[i2 >> 2] >> ((3 - (i2 & 3)) << 3)) & 0xFF) << 8;\n        i2 += 1;\n        trit |= (array[i2 >> 2] >> ((3 - (i2 & 3)) << 3)) & 0xFF;\n        string += _base64Digits[(trit >> 18) & 0x3F];\n        string += _base64Digits[(trit >> 12) & 0x3F];\n        i += 1;\n        if (i >= limit) {\n          string += '=';\n        } else {\n          string += _base64Digits[(trit >> 6) & 0x3F];\n        }\n        i += 1;\n        if (i >= limit) {\n          string += '=';\n        } else {\n          string += _base64Digits[trit & 0x3F];\n        }\n        i += 1;\n      }\n      return string;\n    };\n    _base64Digits = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    return stringToArray = function(string) {\n      var array, i, mask, _i, _ref;\n      array = [];\n      mask = 0xFF;\n      for (i = _i = 0, _ref = string.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        array[i >> 2] |= (string.charCodeAt(i) & mask) << ((3 - (i & 3)) << 3);\n      }\n      return array;\n    };\n  })();\n\n  Dropbox.Util.Oauth = (function() {\n    function Oauth(options) {\n      this._id = null;\n      this._secret = null;\n      this._stateParam = null;\n      this._authCode = null;\n      this._token = null;\n      this._tokenKey = null;\n      this._tokenKid = null;\n      this._error = null;\n      this._appHash = null;\n      this._loaded = null;\n      this.setCredentials(options);\n    }\n\n    Oauth.prototype.setCredentials = function(options) {\n      if (options.key) {\n        this._id = options.key;\n      } else {\n        if (!options.token) {\n          throw new Error('No API key supplied');\n        }\n        this._id = null;\n      }\n      this._secret = options.secret || null;\n      this._appHash = null;\n      this._error = null;\n      this._loaded = true;\n      this.reset();\n      if (options.token) {\n        this._token = options.token;\n        if (options.tokenKey) {\n          this._tokenKey = options.tokenKey;\n          this._tokenKid = options.tokenKid;\n        }\n      } else if (options.oauthCode) {\n        this._authCode = options.oauthCode;\n      } else if (options.oauthStateParam) {\n        this._stateParam = options.oauthStateParam;\n      }\n      return this;\n    };\n\n    Oauth.prototype.credentials = function() {\n      var returnValue;\n      returnValue = {};\n      if (this._id) {\n        returnValue.key = this._id;\n      }\n      if (this._secret) {\n        returnValue.secret = this._secret;\n      }\n      if (this._token !== null) {\n        returnValue.token = this._token;\n        if (this._tokenKey) {\n          returnValue.tokenKey = this._tokenKey;\n          returnValue.tokenKid = this._tokenKid;\n        }\n      } else if (this._authCode !== null) {\n        returnValue.oauthCode = this._authCode;\n      } else if (this._stateParam !== null) {\n        returnValue.oauthStateParam = this._stateParam;\n      }\n      return returnValue;\n    };\n\n    Oauth.prototype.step = function() {\n      if (this._token !== null) {\n        return Dropbox.Client.DONE;\n      } else if (this._authCode !== null) {\n        return Dropbox.Client.AUTHORIZED;\n      } else if (this._stateParam !== null) {\n        if (this._loaded) {\n          return Dropbox.Client.PARAM_LOADED;\n        } else {\n          return Dropbox.Client.PARAM_SET;\n        }\n      } else if (this._error !== null) {\n        return Dropbox.Client.ERROR;\n      } else {\n        return Dropbox.Client.RESET;\n      }\n    };\n\n    Oauth.prototype.setAuthStateParam = function(stateParam) {\n      if (this._id === null) {\n        throw new Error('No API key supplied, cannot do authorization');\n      }\n      this.reset();\n      this._loaded = false;\n      this._stateParam = stateParam;\n      return this;\n    };\n\n    Oauth.prototype.checkAuthStateParam = function(stateParam) {\n      return (this._stateParam === stateParam) && (this._stateParam !== null);\n    };\n\n    Oauth.prototype.authStateParam = function() {\n      return this._stateParam;\n    };\n\n    Oauth.prototype.error = function() {\n      return this._error;\n    };\n\n    Oauth.prototype.processRedirectParams = function(queryParams) {\n      var tokenType;\n      if (queryParams.error) {\n        if (this._id === null) {\n          throw new Error('No API key supplied, cannot process errors');\n        }\n        this.reset();\n        this._error = new Dropbox.AuthError(queryParams);\n        return true;\n      }\n      if (queryParams.code) {\n        if (this._id === null) {\n          throw new Error('No API key supplied, cannot do Authorization Codes');\n        }\n        this.reset();\n        this._loaded = false;\n        this._authCode = queryParams.code;\n        return true;\n      }\n      tokenType = queryParams.token_type;\n      if (tokenType) {\n        tokenType = tokenType.toLowerCase();\n        if (tokenType !== 'bearer' && tokenType !== 'mac') {\n          throw new Error(\"Unimplemented token type \" + tokenType);\n        }\n        this.reset();\n        this._loaded = false;\n        if (tokenType === 'mac') {\n          if (queryParams.mac_algorithm !== 'hmac-sha-1') {\n            throw new Error(\"Unimplemented MAC algorithms \" + queryParams.mac_algorithm);\n          }\n          this._tokenKey = queryParams.mac_key;\n          this._tokenKid = queryParams.kid;\n        }\n        this._token = queryParams.access_token;\n        return true;\n      }\n      return false;\n    };\n\n    Oauth.prototype.authHeader = function(method, url, params) {\n      var macParams, userPassword;\n      if (this._token === null) {\n        userPassword = this._secret === null ? Dropbox.Util.btoa(\"\" + this._id + \":\") : Dropbox.Util.btoa(\"\" + this._id + \":\" + this._secret);\n        return \"Basic \" + userPassword;\n      } else {\n        if (this._tokenKey === null) {\n          return \"Bearer \" + this._token;\n        } else {\n          macParams = this.macParams(method, url, params);\n          return (\"MAC kid=\" + macParams.kid + \" ts=\" + macParams.ts + \" \") + (\"access_token=\" + this._token + \" mac=\" + macParams.mac);\n        }\n      }\n    };\n\n    Oauth.prototype.addAuthParams = function(method, url, params) {\n      var macParams;\n      if (this._token === null) {\n        params.client_id = this._id;\n        if (this._secret !== null) {\n          params.client_secret = this._secret;\n        }\n      } else {\n        if (this._tokenKey !== null) {\n          macParams = this.macParams(method, url, params);\n          params.kid = macParams.kid;\n          params.ts = macParams.ts;\n          params.mac = macParams.mac;\n        }\n        params.access_token = this._token;\n      }\n      return params;\n    };\n\n    Oauth.prototype.authorizeUrlParams = function(responseType, redirectUrl) {\n      var params;\n      if (responseType !== 'token' && responseType !== 'code') {\n        throw new Error(\"Unimplemented /authorize response type \" + responseType);\n      }\n      params = {\n        client_id: this._id,\n        state: this._stateParam,\n        response_type: responseType\n      };\n      if (redirectUrl) {\n        params.redirect_uri = redirectUrl;\n      }\n      return params;\n    };\n\n    Oauth.prototype.accessTokenParams = function(redirectUrl) {\n      var params;\n      params = {\n        grant_type: 'authorization_code',\n        code: this._authCode\n      };\n      if (redirectUrl) {\n        params.redirect_uri = redirectUrl;\n      }\n      return params;\n    };\n\n    Oauth.queryParamsFromUrl = function(url) {\n      var fragment, fragmentOffset, kvp, match, offset, params, query, _i, _len, _ref;\n      match = /^[^?#]+(\\?([^\\#]*))?(\\#(.*))?$/.exec(url);\n      if (!match) {\n        return {};\n      }\n      query = match[2] || '';\n      if (query.substring(0, 1) === '/') {\n        query = query.substring(1);\n      }\n      fragment = match[4] || '';\n      fragmentOffset = fragment.indexOf('?');\n      if (fragmentOffset !== -1) {\n        fragment = fragment.substring(fragmentOffset + 1);\n      }\n      if (fragment.substring(0, 1) === '/') {\n        fragment = fragment.substring(1);\n      }\n      params = {};\n      _ref = query.split('&').concat(fragment.split('&'));\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        kvp = _ref[_i];\n        offset = kvp.indexOf('=');\n        if (offset === -1) {\n          continue;\n        }\n        params[decodeURIComponent(kvp.substring(0, offset))] = decodeURIComponent(kvp.substring(offset + 1));\n      }\n      return params;\n    };\n\n    Oauth.prototype.macParams = function(method, url, params) {\n      var macParams, string;\n      macParams = {\n        kid: this._tokenKid,\n        ts: Dropbox.Util.Oauth.timestamp()\n      };\n      string = method.toUpperCase() + '&' + Dropbox.Util.Xhr.urlEncodeValue(url) + '&' + Dropbox.Util.Xhr.urlEncodeValue(Dropbox.Util.Xhr.urlEncode(params));\n      macParams.mac = Dropbox.Util.hmac(string, this._tokenKey);\n      return macParams;\n    };\n\n    Oauth.prototype.appHash = function() {\n      if (this._appHash) {\n        return this._appHash;\n      }\n      return this._appHash = Dropbox.Util.sha1('oauth2-' + this._id).replace(/[\\/+=]/g, '');\n    };\n\n    Oauth.prototype.reset = function() {\n      this._stateParam = null;\n      this._authCode = null;\n      this._token = null;\n      this._tokenKey = null;\n      this._tokenKid = null;\n      this._error = null;\n      return this;\n    };\n\n    Oauth.timestamp = function() {\n      return Math.floor(Date.now() / 1000);\n    };\n\n    Oauth.randomAuthStateParam = function() {\n      return ['oas', Date.now().toString(36), Math.random().toString(36)].join('_');\n    };\n\n    return Oauth;\n\n  })();\n\n  if (Date.now == null) {\n    Dropbox.Util.Oauth.timestamp = function() {\n      return Math.floor((new Date()).getTime() / 1000);\n    };\n  }\n\n  if ((new Date('Fri, 31 Jan 2042 21:01:05 +0000')).valueOf() === 2274814865000) {\n    Dropbox.Util.parseDate = function(dateString) {\n      return new Date(dateString);\n    };\n  } else if (Date.parse('Fri, 31 Jan 2042 21:01:05 +0000') === 2274814865000) {\n    Dropbox.Util.parseDate = function(dateString) {\n      return new Date(Date.parse(dateString));\n    };\n  } else {\n    (function() {\n      var parseDateMonths, parseDateRe;\n      parseDateRe = /^\\w+\\, (\\d+) (\\w+) (\\d+) (\\d+)\\:(\\d+)\\:(\\d+) (\\+\\d+|UTC|GMT)$/;\n      parseDateMonths = {\n        Jan: 0,\n        Feb: 1,\n        Mar: 2,\n        Apr: 3,\n        May: 4,\n        Jun: 5,\n        Jul: 6,\n        Aug: 7,\n        Sep: 8,\n        Oct: 9,\n        Nov: 10,\n        Dec: 11\n      };\n      return Dropbox.Util.parseDate = function(dateString) {\n        var match;\n        if (!(match = parseDateRe.exec(dateString))) {\n          return NaN;\n        }\n        return new Date(Date.UTC(parseInt(match[3]), parseDateMonths[match[2]], parseInt(match[1]), parseInt(match[4]), parseInt(match[5]), parseInt(match[6]), 0));\n      };\n    })();\n  }\n\n  if (Dropbox.Env.global.XMLHttpRequest) {\n    if (Dropbox.Env.global.XDomainRequest && !('withCredentials' in new XMLHttpRequest())) {\n      DbxXhrRequest = XDomainRequest;\n      DbxXhrIeMode = true;\n      DbxXhrCanSendForms = false;\n    } else {\n      DbxXhrRequest = XMLHttpRequest;\n      DbxXhrIeMode = false;\n      DbxXhrCanSendForms = typeof FormData !== 'undefined' && navigator.userAgent.indexOf('Firefox') === -1;\n    }\n    DbxXhrDoesPreflight = true;\n  } else {\n    DbxXhrRequest = Dropbox.Env.require('xhr2');\n    DbxXhrIeMode = false;\n    DbxXhrCanSendForms = false;\n    DbxXhrDoesPreflight = false;\n  }\n\n  if (!Dropbox.Env.global.Uint8Array) {\n    DbxXhrArrayBufferView = null;\n    DbxXhrWrapBlob = false;\n    DbxXhrSendArrayBufferView = false;\n  } else {\n    if (Object.getPrototypeOf) {\n      DbxXhrArrayBufferView = Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array(0))).constructor;\n    } else if (Object.__proto__) {\n      DbxXhrArrayBufferView = (new Uint8Array(0)).__proto__.__proto__.constructor;\n    }\n    if (!Dropbox.Env.global.Blob) {\n      DbxXhrWrapBlob = false;\n      DbxXhrSendArrayBufferView = true;\n    } else {\n      try {\n        (function() {\n          if ((new Blob([new Uint8Array(2)])).size === 2) {\n            DbxXhrWrapBlob = true;\n            return DbxXhrSendArrayBufferView = true;\n          } else {\n            DbxXhrSendArrayBufferView = false;\n            return DbxXhrWrapBlob = (new Blob([new ArrayBuffer(2)])).size === 2;\n          }\n        })();\n      } catch (_error) {\n        DbxXhrSendArrayBufferView = false;\n        DbxXhrWrapBlob = false;\n        if (Dropbox.Env.global.WebKitBlobBuilder) {\n          if (navigator.userAgent.indexOf('Android') !== -1) {\n            DbxXhrCanSendForms = false;\n          }\n        }\n      }\n      if (DbxXhrArrayBufferView === Object) {\n        DbxXhrSendArrayBufferView = false;\n      }\n    }\n  }\n\n  Dropbox.Util.Xhr = (function() {\n    Xhr.Request = DbxXhrRequest;\n\n    Xhr.ieXdr = DbxXhrIeMode;\n\n    Xhr.canSendForms = DbxXhrCanSendForms;\n\n    Xhr.doesPreflight = DbxXhrDoesPreflight;\n\n    Xhr.ArrayBufferView = DbxXhrArrayBufferView;\n\n    Xhr.sendArrayBufferView = DbxXhrSendArrayBufferView;\n\n    Xhr.wrapBlob = DbxXhrWrapBlob;\n\n    function Xhr(method, baseUrl) {\n      this.method = method;\n      this.isGet = this.method === 'GET';\n      this.url = baseUrl;\n      this.wantHeaders = false;\n      this.headers = {};\n      this.params = null;\n      this.body = null;\n      this.preflight = !(this.isGet || (this.method === 'POST'));\n      this.signed = false;\n      this.completed = false;\n      this.responseType = null;\n      this.callback = null;\n      this.xhr = null;\n      this.onError = null;\n    }\n\n    Xhr.prototype.xhr = null;\n\n    Xhr.prototype.onError = null;\n\n    Xhr.prototype.setParams = function(params) {\n      if (this.signed) {\n        throw new Error('setParams called after addOauthParams or addOauthHeader');\n      }\n      if (this.params) {\n        throw new Error('setParams cannot be called twice');\n      }\n      this.params = params;\n      return this;\n    };\n\n    Xhr.prototype.setCallback = function(callback) {\n      this.callback = callback;\n      return this;\n    };\n\n    Xhr.prototype.signWithOauth = function(oauth, cacheFriendly) {\n      if (Dropbox.Util.Xhr.ieXdr) {\n        return this.addOauthParams(oauth);\n      } else if (this.preflight || !Dropbox.Util.Xhr.doesPreflight) {\n        return this.addOauthHeader(oauth);\n      } else {\n        if (this.isGet && cacheFriendly) {\n          return this.addOauthHeader(oauth);\n        } else {\n          return this.addOauthParams(oauth);\n        }\n      }\n    };\n\n    Xhr.prototype.addOauthParams = function(oauth) {\n      if (this.signed) {\n        throw new Error('Request already has an OAuth signature');\n      }\n      this.params || (this.params = {});\n      oauth.addAuthParams(this.method, this.url, this.params);\n      this.signed = true;\n      return this;\n    };\n\n    Xhr.prototype.addOauthHeader = function(oauth) {\n      if (this.signed) {\n        throw new Error('Request already has an OAuth signature');\n      }\n      this.params || (this.params = {});\n      this.signed = true;\n      return this.setHeader('Authorization', oauth.authHeader(this.method, this.url, this.params));\n    };\n\n    Xhr.prototype.setBody = function(body) {\n      if (this.isGet) {\n        throw new Error('setBody cannot be called on GET requests');\n      }\n      if (this.body !== null) {\n        throw new Error('Request already has a body');\n      }\n      if (typeof body === 'string') {\n\n      } else if ((typeof FormData !== 'undefined') && (body instanceof FormData)) {\n\n      } else {\n        this.headers['Content-Type'] = 'application/octet-stream';\n        this.preflight = true;\n      }\n      this.body = body;\n      return this;\n    };\n\n    Xhr.prototype.setResponseType = function(responseType) {\n      this.responseType = responseType;\n      return this;\n    };\n\n    Xhr.prototype.setHeader = function(headerName, value) {\n      var oldValue;\n      if (this.headers[headerName]) {\n        oldValue = this.headers[headerName];\n        throw new Error(\"HTTP header \" + headerName + \" already set to \" + oldValue);\n      }\n      if (headerName === 'Content-Type') {\n        throw new Error('Content-Type is automatically computed based on setBody');\n      }\n      this.preflight = true;\n      this.headers[headerName] = value;\n      return this;\n    };\n\n    Xhr.prototype.reportResponseHeaders = function() {\n      return this.wantHeaders = true;\n    };\n\n    Xhr.prototype.setFileField = function(fieldName, fileName, fileData, contentType) {\n      var blob, blobError, boundary, builder, useFormData;\n      if (this.body !== null) {\n        throw new Error('Request already has a body');\n      }\n      if (this.isGet) {\n        throw new Error('setFileField cannot be called on GET requests');\n      }\n      if (typeof fileData === 'object') {\n        if (typeof ArrayBuffer !== 'undefined') {\n          if (fileData instanceof ArrayBuffer) {\n            if (Dropbox.Util.Xhr.sendArrayBufferView) {\n              fileData = new Uint8Array(fileData);\n            }\n          } else {\n            if (!Dropbox.Util.Xhr.sendArrayBufferView && fileData.byteOffset === 0 && fileData.buffer instanceof ArrayBuffer) {\n              fileData = fileData.buffer;\n            }\n          }\n        }\n        contentType || (contentType = 'application/octet-stream');\n        try {\n          fileData = new Blob([fileData], {\n            type: contentType\n          });\n        } catch (_error) {\n          blobError = _error;\n          if (window.WebKitBlobBuilder) {\n            builder = new WebKitBlobBuilder;\n            builder.append(fileData);\n            if (blob = builder.getBlob(contentType)) {\n              fileData = blob;\n            }\n          }\n        }\n        if (typeof File !== 'undefined' && fileData instanceof File) {\n          fileData = new Blob([fileData], {\n            type: fileData.type\n          });\n        }\n        useFormData = fileData instanceof Blob;\n      } else {\n        useFormData = false;\n      }\n      if (useFormData) {\n        this.body = new FormData();\n        return this.body.append(fieldName, fileData, fileName);\n      } else {\n        contentType || (contentType = 'application/octet-stream');\n        boundary = this.multipartBoundary();\n        this.headers['Content-Type'] = \"multipart/form-data; boundary=\" + boundary;\n        return this.body = ['--', boundary, \"\\r\\n\", 'Content-Disposition: form-data; name=\"', fieldName, '\"; filename=\"', fileName, \"\\\"\\r\\n\", 'Content-Type: ', contentType, \"\\r\\n\", \"Content-Transfer-Encoding: binary\\r\\n\\r\\n\", fileData, \"\\r\\n\", '--', boundary, '--', \"\\r\\n\"].join('');\n      }\n    };\n\n    Xhr.prototype.multipartBoundary = function() {\n      return [Date.now().toString(36), Math.random().toString(36)].join('----');\n    };\n\n    Xhr.prototype.paramsToUrl = function() {\n      var queryString;\n      if (this.params) {\n        queryString = Dropbox.Util.Xhr.urlEncode(this.params);\n        if (queryString.length !== 0) {\n          this.url = [this.url, '?', queryString].join('');\n        }\n        this.params = null;\n      }\n      return this;\n    };\n\n    Xhr.prototype.paramsToBody = function() {\n      if (this.params) {\n        if (this.body !== null) {\n          throw new Error('Request already has a body');\n        }\n        if (this.isGet) {\n          throw new Error('paramsToBody cannot be called on GET requests');\n        }\n        this.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n        this.body = Dropbox.Util.Xhr.urlEncode(this.params);\n        this.params = null;\n      }\n      return this;\n    };\n\n    Xhr.prototype.prepare = function() {\n      var header, ieXdr, value, _ref,\n        _this = this;\n      ieXdr = Dropbox.Util.Xhr.ieXdr;\n      if (this.isGet || this.body !== null || ieXdr) {\n        this.paramsToUrl();\n        if (this.body !== null && typeof this.body === 'string') {\n          this.headers['Content-Type'] = 'text/plain; charset=utf8';\n        }\n      } else {\n        this.paramsToBody();\n      }\n      this.xhr = new Dropbox.Util.Xhr.Request();\n      if (ieXdr) {\n        this.xhr.onload = function() {\n          return _this.onXdrLoad();\n        };\n        this.xhr.onerror = function() {\n          return _this.onXdrError();\n        };\n        this.xhr.ontimeout = function() {\n          return _this.onXdrError();\n        };\n        this.xhr.onprogress = function() {};\n      } else {\n        this.xhr.onreadystatechange = function() {\n          return _this.onReadyStateChange();\n        };\n      }\n      this.xhr.open(this.method, this.url, true);\n      if (!ieXdr) {\n        _ref = this.headers;\n        for (header in _ref) {\n          if (!__hasProp.call(_ref, header)) continue;\n          value = _ref[header];\n          this.xhr.setRequestHeader(header, value);\n        }\n      }\n      if (this.responseType) {\n        if (this.responseType === 'b') {\n          if (this.xhr.overrideMimeType) {\n            this.xhr.overrideMimeType('text/plain; charset=x-user-defined');\n          }\n        } else {\n          this.xhr.responseType = this.responseType;\n        }\n      }\n      return this;\n    };\n\n    Xhr.prototype.send = function(callback) {\n      var body, xhrError;\n      this.callback = callback || this.callback;\n      if (this.body !== null) {\n        body = this.body;\n        if (Dropbox.Util.Xhr.sendArrayBufferView) {\n          if (body instanceof ArrayBuffer) {\n            body = new Uint8Array(body);\n          }\n        } else {\n          if (body.byteOffset === 0 && body.buffer instanceof ArrayBuffer) {\n            body = body.buffer;\n          }\n        }\n        try {\n          this.xhr.send(body);\n        } catch (_error) {\n          xhrError = _error;\n          if (!Dropbox.Util.Xhr.sendArrayBufferView && Dropbox.Util.Xhr.wrapBlob) {\n            body = new Blob([body], {\n              type: 'application/octet-stream'\n            });\n            this.xhr.send(body);\n          } else {\n            throw xhrError;\n          }\n        }\n      } else {\n        this.xhr.send();\n      }\n      return this;\n    };\n\n    Xhr.urlEncode = function(object) {\n      var chunks, key, value;\n      chunks = [];\n      for (key in object) {\n        value = object[key];\n        chunks.push(this.urlEncodeValue(key) + '=' + this.urlEncodeValue(value));\n      }\n      return chunks.sort().join('&');\n    };\n\n    Xhr.urlEncodeValue = function(object) {\n      return encodeURIComponent(object.toString()).replace(/\\!/g, '%21').replace(/'/g, '%27').replace(/\\(/g, '%28').replace(/\\)/g, '%29').replace(/\\*/g, '%2A');\n    };\n\n    Xhr.urlDecode = function(string) {\n      var kvp, result, token, _i, _len, _ref;\n      result = {};\n      _ref = string.split('&');\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        token = _ref[_i];\n        kvp = token.split('=');\n        result[decodeURIComponent(kvp[0])] = decodeURIComponent(kvp[1]);\n      }\n      return result;\n    };\n\n    Xhr.prototype.onReadyStateChange = function() {\n      var allHeaders, apiError, bytes, contentType, dirtyText, duplicateIndex, headers, i, jsonError, metadata, metadataJson, offset, text, _i, _ref;\n      if (this.xhr.readyState !== 4) {\n        return true;\n      }\n      if (this.completed) {\n        return true;\n      }\n      this.completed = true;\n      if (this.xhr.status < 200 || this.xhr.status >= 300) {\n        apiError = new Dropbox.ApiError(this.xhr, this.method, this.url);\n        if (this.onError) {\n          this.onError(apiError, this.callback);\n        } else {\n          this.callback(apiError);\n        }\n        return true;\n      }\n      if (this.wantHeaders) {\n        allHeaders = this.xhr.getAllResponseHeaders();\n        if (allHeaders) {\n          headers = Dropbox.Util.Xhr.parseResponseHeaders(allHeaders);\n        } else {\n          headers = this.guessResponseHeaders();\n        }\n        metadataJson = headers['x-dropbox-metadata'];\n      } else {\n        headers = void 0;\n        metadataJson = this.xhr.getResponseHeader('x-dropbox-metadata');\n      }\n      if (metadataJson != null ? metadataJson.length : void 0) {\n        try {\n          metadata = JSON.parse(metadataJson);\n        } catch (_error) {\n          jsonError = _error;\n          duplicateIndex = metadataJson.search(/\\}\\,\\s*\\{/);\n          if (duplicateIndex !== -1) {\n            try {\n              metadataJson = metadataJson.substring(0, duplicateIndex + 1);\n              metadata = JSON.parse(metadataJson);\n            } catch (_error) {\n              jsonError = _error;\n              metadata = void 0;\n            }\n          } else {\n            metadata = void 0;\n          }\n        }\n      } else {\n        metadata = void 0;\n      }\n      if (this.responseType) {\n        if (this.responseType === 'b') {\n          dirtyText = this.xhr.responseText != null ? this.xhr.responseText : this.xhr.response;\n          bytes = [];\n          for (i = _i = 0, _ref = dirtyText.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n            bytes.push(String.fromCharCode(dirtyText.charCodeAt(i) & 0xFF));\n          }\n          text = bytes.join('');\n          this.callback(null, text, metadata, headers);\n        } else {\n          this.callback(null, this.xhr.response, metadata, headers);\n        }\n        return true;\n      }\n      text = this.xhr.responseText != null ? this.xhr.responseText : this.xhr.response;\n      contentType = this.xhr.getResponseHeader('Content-Type');\n      if (contentType) {\n        offset = contentType.indexOf(';');\n        if (offset !== -1) {\n          contentType = contentType.substring(0, offset);\n        }\n      }\n      switch (contentType) {\n        case 'application/x-www-form-urlencoded':\n          this.callback(null, Dropbox.Util.Xhr.urlDecode(text), metadata, headers);\n          break;\n        case 'application/json':\n        case 'text/javascript':\n          this.callback(null, JSON.parse(text), metadata, headers);\n          break;\n        default:\n          this.callback(null, text, metadata, headers);\n      }\n      return true;\n    };\n\n    Xhr.parseResponseHeaders = function(allHeaders) {\n      var colonIndex, headerLines, headers, line, name, value, _i, _len;\n      headers = {};\n      headerLines = allHeaders.split(\"\\n\");\n      for (_i = 0, _len = headerLines.length; _i < _len; _i++) {\n        line = headerLines[_i];\n        colonIndex = line.indexOf(':');\n        name = line.substring(0, colonIndex).trim().toLowerCase();\n        value = line.substring(colonIndex + 1).trim();\n        headers[name] = value;\n      }\n      return headers;\n    };\n\n    Xhr.prototype.guessResponseHeaders = function() {\n      var headers, name, value, _i, _len, _ref;\n      headers = {};\n      _ref = ['cache-control', 'content-language', 'content-range', 'content-type', 'expires', 'last-modified', 'pragma', 'x-dropbox-metadata'];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        name = _ref[_i];\n        value = this.xhr.getResponseHeader(name);\n        if (value) {\n          headers[name] = value;\n        }\n      }\n      return headers;\n    };\n\n    Xhr.prototype.onXdrLoad = function() {\n      var headers, metadata, text;\n      if (this.completed) {\n        return true;\n      }\n      this.completed = true;\n      text = this.xhr.responseText;\n      if (this.wantHeaders) {\n        headers = {\n          'content-type': this.xhr.contentType\n        };\n      } else {\n        headers = void 0;\n      }\n      metadata = void 0;\n      if (this.responseType) {\n        this.callback(null, text, metadata, headers);\n        return true;\n      }\n      switch (this.xhr.contentType) {\n        case 'application/x-www-form-urlencoded':\n          this.callback(null, Dropbox.Util.Xhr.urlDecode(text), metadata, headers);\n          break;\n        case 'application/json':\n        case 'text/javascript':\n          this.callback(null, JSON.parse(text), metadata, headers);\n          break;\n        default:\n          this.callback(null, text, metadata, headers);\n      }\n      return true;\n    };\n\n    Xhr.prototype.onXdrError = function() {\n      var apiError;\n      if (this.completed) {\n        return true;\n      }\n      this.completed = true;\n      apiError = new Dropbox.ApiError(this.xhr, this.method, this.url);\n      if (this.onError) {\n        this.onError(apiError, this.callback);\n      } else {\n        this.callback(apiError);\n      }\n      return true;\n    };\n\n    return Xhr;\n\n  })();\n\n}).call(this);\n"]}