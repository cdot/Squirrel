/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
var AES={};AES.encrypt=function(ab,password,nBits){"use strict";for(var blockSize=16,plaintext=new Uint8Array(ab),nBytes=nBits/8,pwBytes=new Array(nBytes),i=0;nBytes>i;i++)pwBytes[i]=i<password.length?255&password.charCodeAt(i):0;var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Uint8Array(8),size=8,nonce=Date.now(),nonceMs=nonce%1e3,nonceSec=nonce/1e3>>0,nonceRnd=65535*Math.random()>>0;for(i=0;2>i;i++)counterBlock[i]=nonceMs>>>8*i&255;for(i=0;2>i;i++)counterBlock[i+2]=nonceRnd>>>8*i&255;for(i=0;4>i;i++)counterBlock[i+4]=nonceSec>>>8*i&255;for(var keySchedule=Aes.keyExpansion(key),blockCount=Math.ceil(plaintext.length/blockSize),ciphertxt=new Array(blockCount),b=0;blockCount>b;b++){for(var c=0;4>c;c++)counterBlock[15-c]=b>>>8*c&255;for(c=0;4>c;c++)counterBlock[15-c-4]=b/4294967296>>>8*c;var cipherCntr=Aes.cipher(counterBlock,keySchedule),blockLength=blockCount-1>b?blockSize:(plaintext.length-1)%blockSize+1,cipherChar=new Uint8Array(blockLength);for(size+=blockLength,i=0;blockLength>i;i++)cipherCntr[i]>255,cipherChar[i]=cipherCntr[i]^plaintext[b*blockSize+i];ciphertxt[b]=cipherChar}var ct=new Uint8Array(size);ct.set(counterBlock);var offset=counterBlock.length;for(b=0;blockCount>b;b++)ct.set(ciphertxt[b],offset),offset+=ciphertxt[b].length;return ct},AES.decrypt=function(ab,password,nBits){"use strict";for(var blockSize=16,ciphertext=new Uint8Array(ab),nBytes=nBits/8,pwBytes=new Uint8Array(nBytes),i=0;nBytes>i;i++)pwBytes[i]=i<password.length?255&password.charCodeAt(i):0;var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Uint8Array(8);for(i=0;8>i;i++)counterBlock[i]=ciphertext[i];for(var keySchedule=Aes.keyExpansion(key),nBlocks=Math.ceil((ciphertext.length-8)/blockSize),ct=new Array(nBlocks),offset=8,b=0;nBlocks>b;b++)ct[b]=ciphertext.subarray(offset,offset+blockSize),offset+=blockSize;var plaintxt=new Array(nBlocks),size=0;for(b=0;nBlocks>b;b++){for(var c=0;4>c;c++)counterBlock[15-c]=b>>>8*c&255;for(c=0;4>c;c++)counterBlock[15-c-4]=(b+1)/4294967296-1>>>8*c&255;var cipherCntr=Aes.cipher(counterBlock,keySchedule),blen=ct[b].length,plaintxtByte=new Uint8Array(blen);for(i=0;blen>i;i++)plaintxtByte[i]=cipherCntr[i]^ct[b][i];plaintxt[b]=plaintxtByte,size+=blen}var pt=new Uint8Array(size);for(offset=0,b=0;nBlocks>b;b++)pt.set(plaintxt[b],offset),offset+=plaintxt[b].length;return pt};
//# sourceMappingURL=AES.map