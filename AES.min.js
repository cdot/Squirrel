"use strict";var Aes={};Aes.cipher=function(n,j){var o=4;var k=j.length/o-1;var l=[[],[],[],[]];for(var m=0;m<4*o;m++){l[m%4][Math.floor(m/4)]=n[m]}l=Aes.addRoundKey(l,j,0,o);for(var p=1;p<k;p++){l=Aes.subBytes(l,o);l=Aes.shiftRows(l,o);l=Aes.mixColumns(l,o);l=Aes.addRoundKey(l,j,p,o)}l=Aes.subBytes(l,o);l=Aes.shiftRows(l,o);l=Aes.addRoundKey(l,j,k,o);var i=new Array(4*o);for(var m=0;m<4*o;m++){i[m]=l[m%4][Math.floor(m/4)]}return i};Aes.keyExpansion=function(m){var o=4;var q=m.length/4;var l=q+6;var n=new Array(o*(l+1));var k=new Array(4);for(var p=0;p<q;p++){var r=[m[4*p],m[4*p+1],m[4*p+2],m[4*p+3]];n[p]=r}for(var p=q;p<(o*(l+1));p++){n[p]=new Array(4);for(var i=0;i<4;i++){k[i]=n[p-1][i]}if(p%q==0){k=Aes.subWord(Aes.rotWord(k));for(var i=0;i<4;i++){k[i]^=Aes.rCon[p/q][i]}}else{if(q>6&&p%q==4){k=Aes.subWord(k)}}for(var i=0;i<4;i++){n[p][i]=n[p-q][i]^k[i]}}return n};Aes.subBytes=function(c,f){for(var h=0;h<4;h++){for(var g=0;g<f;g++){c[h][g]=Aes.sBox[c[h][g]]}}return c};Aes.shiftRows=function(j,g){var c=new Array(4);for(var i=1;i<4;i++){for(var h=0;h<4;h++){c[h]=j[i][(h+i)%g]}for(var h=0;h<4;h++){j[i][h]=c[h]}}return j};Aes.mixColumns=function(b,i){for(var a=0;a<4;a++){var k=new Array(4);var l=new Array(4);for(var c=0;c<4;c++){k[c]=b[c][a];l[c]=b[c][a]&128?b[c][a]<<1^283:b[c][a]<<1}b[0][a]=l[0]^k[1]^l[1]^k[2]^k[3];b[1][a]=k[0]^l[1]^k[2]^l[2]^k[3];b[2][a]=k[0]^k[1]^l[2]^k[3]^l[3];b[3][a]=k[0]^l[0]^k[1]^k[2]^l[3]}return b};Aes.addRoundKey=function(j,h,l,c){for(var k=0;k<4;k++){for(var i=0;i<c;i++){j[k][i]^=h[l*4+i][k]}}return j};Aes.subWord=function(d){for(var c=0;c<4;c++){d[c]=Aes.sBox[d[c]]}return d};Aes.rotWord=function(e){var f=e[0];for(var d=0;d<3;d++){e[d]=e[d+1]}e[3]=f;return e};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];if(typeof module!="undefined"&&module.exports){module.exports=Aes}if(typeof define=="function"&&define.amd){define([],function(){return Aes})}"use strict";if(typeof module!="undefined"&&module.exports){var Aes=require("./aes")}Aes.Ctr={};Aes.Ctr.encrypt=function(N,T,C){var M=16;if(!(C==128||C==192||C==256)){return""}N=String(N).utf8Encode();T=String(T).utf8Encode();var L=C/8;var Q=new Array(L);for(var E=0;E<L;E++){Q[E]=isNaN(T.charCodeAt(E))?0:T.charCodeAt(E)}var b=Aes.cipher(Q,Aes.keyExpansion(Q));b=b.concat(b.slice(0,L-16));var R=new Array(M);var D=(new Date()).getTime();var P=D%1000;var S=Math.floor(D/1000);var H=Math.floor(Math.random()*65535);for(var E=0;E<2;E++){R[E]=(P>>>E*8)&255}for(var E=0;E<2;E++){R[E+2]=(H>>>E*8)&255}for(var E=0;E<4;E++){R[E+4]=(S>>>E*8)&255}var J="";for(var E=0;E<8;E++){J+=String.fromCharCode(R[E])}var A=Aes.keyExpansion(b);var F=Math.ceil(N.length/M);var K=new Array(F);for(var i=0;i<F;i++){for(var B=0;B<4;B++){R[15-B]=(i>>>B*8)&255}for(var B=0;B<4;B++){R[15-B-4]=(i/4294967296>>>B*8)}var O=Aes.cipher(R,A);var G=i<F-1?M:(N.length-1)%M+1;var I=new Array(G);for(var E=0;E<G;E++){I[E]=O[E]^N.charCodeAt(i*M+E);I[E]=String.fromCharCode(I[E])}K[i]=I.join("")}var c=J+K.join("");c=c.base64Encode();return c};Aes.Ctr.decrypt=function(c,J,y){var C=16;if(!(y==128||y==192||y==256)){return""}c=String(c).base64Decode();J=String(J).utf8Encode();var B=y/8;var F=new Array(B);for(var z=0;z<B;z++){F[z]=isNaN(J.charCodeAt(z))?0:J.charCodeAt(z)}var b=Aes.cipher(F,Aes.keyExpansion(F));b=b.concat(b.slice(0,B-16));var I=new Array(8);var A=c.slice(0,8);for(var z=0;z<8;z++){I[z]=A.charCodeAt(z)}var w=Aes.keyExpansion(b);var H=Math.ceil((c.length-8)/C);var G=new Array(H);for(var i=0;i<H;i++){G[i]=c.slice(8+i*C,8+i*C+C)}c=G;var K=new Array(c.length);for(var i=0;i<H;i++){for(var x=0;x<4;x++){I[15-x]=((i)>>>x*8)&255}for(var x=0;x<4;x++){I[15-x-4]=(((i+1)/4294967296-1)>>>x*8)&255}var D=Aes.cipher(I,w);var L=new Array(c[i].length);for(var z=0;z<c[i].length;z++){L[z]=D[z]^c[i].charCodeAt(z);L[z]=String.fromCharCode(L[z])}K[i]=L.join("")}var E=K.join("");E=E.utf8Decode();return E};if(typeof String.prototype.utf8Encode=="undefined"){String.prototype.utf8Encode=function(){return unescape(encodeURIComponent(this))}}if(typeof String.prototype.utf8Decode=="undefined"){String.prototype.utf8Decode=function(){try{return decodeURIComponent(escape(this))}catch(b){return this}}}if(typeof String.prototype.base64Encode=="undefined"){String.prototype.base64Encode=function(){if(typeof btoa!="undefined"){return btoa(this)}if(typeof Buffer!="undefined"){return new Buffer(this,"utf8").toString("base64")}throw new Error("No Base64 Encode")}}if(typeof String.prototype.base64Decode=="undefined"){String.prototype.base64Decode=function(){if(typeof atob!="undefined"){return atob(this)}if(typeof Buffer!="undefined"){return new Buffer(this,"base64").toString("utf8")}throw new Error("No Base64 Decode")}}if(typeof module!="undefined"&&module.exports){module.exports=Aes.Ctr}if(typeof define=="function"&&define.amd){define(["Aes"],function(){return Aes.Ctr})}function encryptFile(c){var d=new FileReader();d.readAsArrayBuffer(c);d.onload=function(b){$("body").css({cursor:"wait"});var a=new Uint8Array(d.result);var n="";for(var q=0;q<a.length;q++){n+=String.fromCharCode(a[q])}var i=$("#password-file").val();var o=new Date();var r=Aes.Ctr.encrypt(n,i,256);var p=new Date();var s=new Blob([r],{type:"text/plain"});var t=c.name+".encrypted";saveAs(s,t);$("#encrypt-file-time").html(((p-o)/1000)+"s");$("body").css({cursor:"default"})}}function decryptFile(c){var d=new FileReader();d.readAsText(c);d.onload=function(b){$("body").css({cursor:"wait"});var n=d.result;var i=$("#password-file").val();var o=new Date();var r=Aes.Ctr.decrypt(n,i,256);var p=new Date();var a=new Uint8Array(r.length);for(var q=0;q<r.length;q++){a[q]=r.charCodeAt(q)}var s=new Blob([a],{type:"application/octet-stream"});var t=c.name.replace(/\.encrypted$/,"")+".decrypted";saveAs(s,t);$("#decrypt-file-time").html(((p-o)/1000)+"s");$("body").css({cursor:"default"})}};