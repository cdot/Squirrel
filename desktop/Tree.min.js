/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
const MSPERDAY=864e5;!function($,S){"use strict";var map_treenode_icon={closed:"ui-icon-squirrel-folder-closed",open:"ui-icon-squirrel-folder-open",alarm:"ui-icon-squirrel-alarm"};$.widget("squirrel.treenode",$.squirrel.treenode,{edit:function(what){var $node=$(this.element),$span=$node.find("."+what).first(),w=$("#sites-node").width();$span.parents().each(function(){w-=$(this).position().left}),$span.edit_in_place({width:w,changed:function(s){var e=S.client.hoard.record_action({type:"key"===what?"R":"E",path:$node.treenode("get_path"),data:s},function(ea){S.Tree.action(ea,function(){Utils.sometime("update_save")},!0)});null!==e&&S.Dialog.squeak(e.message)}})},icon_button:function(action,selector,icon,on_click){var $node=$(this.element),$control="string"==typeof selector?$node.find(selector):selector;switch(action){case"create":var $button=$control.button({icons:{primary:map_treenode_icon[icon]},text:!1});on_click&&$button.on("click",on_click);break;case"change":$control.length>0&&$control.button("option","icons",{primary:map_treenode_icon[icon]});break;case"destroy":$control.remove()}return $node},attach_handlers:function(){var $node=$(this.element),$info=$node.children(".treenode-info");$info.hover(function(){if(0===$(this).find(".in_place_editor").length){var $status=$("<div></div>");$status.addClass("lastmod"),$(this).addClass("hover").append($status);var mod=new Date($node.data("last-time")).toLocaleString();return $status.append("<span>"+mod+" </span"),"undefined"!=typeof $node.data("alarm")&&($status.append('<div class="inline-icon ui-icon-squirrel-alarm"></div>'),$status.append('<div class="treenode-info">'+S.Dialog.until_alarms(new Date($node.data("last-time")+$node.data("alarm")*MSPERDAY))+"</div>")),!1}},function(){$(this).removeClass("hover").find(".lastmod").remove()}),$info.children(".key").on("dblclick",function(){$node.treenode("edit","key")}),$info.children(".value").on("dblclick",function(){$node.treenode("edit","value")})}})}(jQuery,Squirrel);
//# sourceMappingURL=Tree.map