/*@preserve Copyright (C) 2015 Crawford Currie http://c-dot.co.uk license MIT*/
var AES={};AES.encrypt=function(ab,password,nBits){"use strict";for(var plaintext=new Uint8Array(ab),nBytes=nBits/8,pwBytes=new Array(nBytes),i=0;i<nBytes;i++)i<password.length?pwBytes[i]=255&password.charCodeAt(i):pwBytes[i]=0;var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Uint8Array(8),size=8,nonce=Date.now(),nonceMs=nonce%1e3,nonceSec=nonce/1e3>>0,nonceRnd=65535*Math.random()>>0;for(i=0;i<2;i++)counterBlock[i]=nonceMs>>>8*i&255;for(i=0;i<2;i++)counterBlock[i+2]=nonceRnd>>>8*i&255;for(i=0;i<4;i++)counterBlock[i+4]=nonceSec>>>8*i&255;for(var keySchedule=Aes.keyExpansion(key),blockCount=Math.ceil(plaintext.length/16),ciphertxt=new Array(blockCount),b=0;b<blockCount;b++){for(var c=0;c<4;c++)counterBlock[15-c]=b>>>8*c&255;for(c=0;c<4;c++)counterBlock[15-c-4]=b/4294967296>>>8*c;var cipherCntr=Aes.cipher(counterBlock,keySchedule),blockLength=b<blockCount-1?16:(plaintext.length-1)%16+1,cipherChar=new Uint8Array(blockLength);for(size+=blockLength,i=0;i<blockLength;i++)cipherCntr[i],cipherChar[i]=cipherCntr[i]^plaintext[16*b+i];ciphertxt[b]=cipherChar}var ct=new Uint8Array(size);ct.set(counterBlock);var offset=counterBlock.length;for(b=0;b<blockCount;b++)ct.set(ciphertxt[b],offset),offset+=ciphertxt[b].length;return ct},AES.decrypt=function(ab,password,nBits){"use strict";for(var ciphertext=new Uint8Array(ab),nBytes=nBits/8,pwBytes=new Uint8Array(nBytes),i=0;i<nBytes;i++)i<password.length?pwBytes[i]=255&password.charCodeAt(i):pwBytes[i]=0;var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Uint8Array(8);for(i=0;i<8;i++)counterBlock[i]=ciphertext[i];for(var keySchedule=Aes.keyExpansion(key),nBlocks=Math.ceil((ciphertext.length-8)/16),ct=new Array(nBlocks),offset=8,b=0;b<nBlocks;b++)ct[b]=ciphertext.subarray(offset,offset+16),offset+=16;var plaintxt=new Array(nBlocks),size=0;for(b=0;b<nBlocks;b++){for(var c=0;c<4;c++)counterBlock[15-c]=b>>>8*c&255;for(c=0;c<4;c++)counterBlock[15-c-4]=(b+1)/4294967296-1>>>8*c&255;var cipherCntr=Aes.cipher(counterBlock,keySchedule),blen=ct[b].length,plaintxtByte=new Uint8Array(blen);for(i=0;i<blen;i++)plaintxtByte[i]=cipherCntr[i]^ct[b][i];plaintxt[b]=plaintxtByte,size+=blen}var pt=new Uint8Array(size);for(offset=0,b=0;b<nBlocks;b++)pt.set(plaintxt[b],offset),offset+=plaintxt[b].length;return pt};
//# sourceMappingURL=AES.map